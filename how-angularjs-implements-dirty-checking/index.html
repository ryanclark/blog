<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,600,700"/><link href="https://fonts.googleapis.com/css?family=Oswald" rel="stylesheet"/><style id="typography.js">html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}body{margin:0}article,aside,details,figcaption,figure,footer,header,main,menu,nav,section,summary{display:block}audio,canvas,progress,video{display:inline-block}audio:not([controls]){display:none;height:0}progress{vertical-align:baseline}[hidden],template{display:none}a{background-color:transparent;-webkit-text-decoration-skip:objects}a:active,a:hover{outline-width:0}abbr[title]{border-bottom:none;text-decoration:underline;text-decoration:underline dotted}b,strong{font-weight:inherit;font-weight:bolder}dfn{font-style:italic}h1{font-size:2em;margin:.67em 0}mark{background-color:#ff0;color:#000}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}img{border-style:none}svg:not(:root){overflow:hidden}code,kbd,pre,samp{font-family:monospace,monospace;font-size:1em}figure{margin:1em 40px}hr{box-sizing:content-box;height:0;overflow:visible}button,input,optgroup,select,textarea{font:inherit;margin:0}optgroup{font-weight:700}button,input{overflow:visible}button,select{text-transform:none}[type=reset],[type=submit],button,html [type=button]{-webkit-appearance:button}[type=button]::-moz-focus-inner,[type=reset]::-moz-focus-inner,[type=submit]::-moz-focus-inner,button::-moz-focus-inner{border-style:none;padding:0}[type=button]:-moz-focusring,[type=reset]:-moz-focusring,[type=submit]:-moz-focusring,button:-moz-focusring{outline:1px dotted ButtonText}fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}legend{box-sizing:border-box;color:inherit;display:table;max-width:100%;padding:0;white-space:normal}textarea{overflow:auto}[type=checkbox],[type=radio]{box-sizing:border-box;padding:0}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}[type=search]::-webkit-search-cancel-button,[type=search]::-webkit-search-decoration{-webkit-appearance:none}::-webkit-input-placeholder{color:inherit;opacity:.54}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}html{font:100%/26px 'Open Sans',sans-serif;box-sizing:border-box;overflow-y:scroll;}*{box-sizing:inherit;}*:before{box-sizing:inherit;}*:after{box-sizing:inherit;}body{color:hsla(0,0%,0%,0.8);font-family:'Open Sans',sans-serif;font-weight:normal;word-wrap:break-word;font-kerning:normal;-moz-font-feature-settings:"kern", "liga", "clig", "calt";-ms-font-feature-settings:"kern", "liga", "clig", "calt";-webkit-font-feature-settings:"kern", "liga", "clig", "calt";font-feature-settings:"kern", "liga", "clig", "calt";}img{max-width:100%;margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.625rem;}h1{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.625rem;color:inherit;font-family:-apple-system,'BlinkMacSystemFont','Segoe UI','Roboto','Oxygen','Ubuntu','Cantarell','Fira Sans','Droid Sans','Helvetica Neue',sans-serif;font-weight:bold;text-rendering:optimizeLegibility;font-size:2rem;line-height:1.1;}h2{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.625rem;color:inherit;font-family:-apple-system,'BlinkMacSystemFont','Segoe UI','Roboto','Oxygen','Ubuntu','Cantarell','Fira Sans','Droid Sans','Helvetica Neue',sans-serif;font-weight:bold;text-rendering:optimizeLegibility;font-size:1.51572rem;line-height:1.1;}h3{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.625rem;color:inherit;font-family:-apple-system,'BlinkMacSystemFont','Segoe UI','Roboto','Oxygen','Ubuntu','Cantarell','Fira Sans','Droid Sans','Helvetica Neue',sans-serif;font-weight:bold;text-rendering:optimizeLegibility;font-size:1.31951rem;line-height:1.1;}h4{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.625rem;color:inherit;font-family:-apple-system,'BlinkMacSystemFont','Segoe UI','Roboto','Oxygen','Ubuntu','Cantarell','Fira Sans','Droid Sans','Helvetica Neue',sans-serif;font-weight:bold;text-rendering:optimizeLegibility;font-size:1rem;line-height:1.1;}h5{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.625rem;color:inherit;font-family:-apple-system,'BlinkMacSystemFont','Segoe UI','Roboto','Oxygen','Ubuntu','Cantarell','Fira Sans','Droid Sans','Helvetica Neue',sans-serif;font-weight:bold;text-rendering:optimizeLegibility;font-size:0.87055rem;line-height:1.1;}h6{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.625rem;color:inherit;font-family:-apple-system,'BlinkMacSystemFont','Segoe UI','Roboto','Oxygen','Ubuntu','Cantarell','Fira Sans','Droid Sans','Helvetica Neue',sans-serif;font-weight:bold;text-rendering:optimizeLegibility;font-size:0.81225rem;line-height:1.1;}hgroup{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.625rem;}ul{margin-left:1.625rem;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.625rem;list-style-position:outside;list-style-image:none;}ol{margin-left:1.625rem;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.625rem;list-style-position:outside;list-style-image:none;}dl{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.625rem;}dd{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.625rem;}p{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.625rem;}figure{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.625rem;}pre{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.625rem;font-size:0.85rem;line-height:1.625rem;}table{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.625rem;font-size:1rem;line-height:1.625rem;border-collapse:collapse;width:100%;}fieldset{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.625rem;}blockquote{margin-left:1.625rem;margin-right:1.625rem;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.625rem;}form{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.625rem;}noscript{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.625rem;}iframe{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.625rem;}hr{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:calc(1.625rem - 1px);background:hsla(0,0%,0%,0.2);border:none;height:1px;}address{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.625rem;}b{font-weight:bold;}strong{font-weight:bold;}dt{font-weight:bold;}th{font-weight:bold;}li{margin-bottom:calc(1.625rem / 2);}ol li{padding-left:0;}ul li{padding-left:0;}li > ol{margin-left:1.625rem;margin-bottom:calc(1.625rem / 2);margin-top:calc(1.625rem / 2);}li > ul{margin-left:1.625rem;margin-bottom:calc(1.625rem / 2);margin-top:calc(1.625rem / 2);}blockquote *:last-child{margin-bottom:0;}li *:last-child{margin-bottom:0;}p *:last-child{margin-bottom:0;}li > p{margin-bottom:calc(1.625rem / 2);}code{font-size:0.85rem;line-height:1.625rem;}kbd{font-size:0.85rem;line-height:1.625rem;}samp{font-size:0.85rem;line-height:1.625rem;}abbr{border-bottom:1px dotted hsla(0,0%,0%,0.5);cursor:help;}acronym{border-bottom:1px dotted hsla(0,0%,0%,0.5);cursor:help;}abbr[title]{border-bottom:1px dotted hsla(0,0%,0%,0.5);cursor:help;text-decoration:none;}thead{text-align:left;}td,th{text-align:left;border-bottom:1px solid hsla(0,0%,0%,0.12);font-feature-settings:"tnum";-moz-font-feature-settings:"tnum";-ms-font-feature-settings:"tnum";-webkit-font-feature-settings:"tnum";padding-left:1.08333rem;padding-right:1.08333rem;padding-top:0.8125rem;padding-bottom:calc(0.8125rem - 1px);}th:first-child,td:first-child{padding-left:0;}th:last-child,td:last-child{padding-right:0;}a{color:#007acc;text-decoration:none;}</style><link rel="apple-touch-icon" sizes="192x192" href="/icons/icon-192x192.png?v=8b8d709ee1c3500b70b3f9527cc92c77f9778614"/><style data-href="/styles.41553e5c7c3f6fa1f41c.css">.scroll{width:100%;overflow-x:auto}code[class*=language-],pre[class*=language-]{color:#f8f8f2;background:none;font-family:Menlo,Andale Mono,Ubuntu Mono,monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-ms-hyphens:none;hyphens:none}pre[class*=language-]{padding:1em;margin:.5em 0 1.625rem;overflow:auto;border-radius:.3em;background:#282a36}:not(pre)>code[class*=language-]{padding:.1em;border-radius:.3em;white-space:normal}.token.cdata,.token.comment,.token.doctype,.token.prolog{color:#6272a4}.token.punctuation{color:#89ddff}.namespace{opacity:.7}.token.number{color:#f78c6c}.token.builtin,.token.char,.token.inserted,.token.selector{color:#50fa7b}.token.string{color:#c3e88d}.token.attr-name{color:#ffcb6b}.token.tag .token.class-name,.token.tag .token.tag{color:#f07178}.language-css .token.string,.style .token.string,.token.entity,.token.url,.token.variable{color:#f8f8f2}.token.operator{color:#89ddff}.token.atrule,.token.class-name,.token.function{color:#82aaff}.token.attr-value,.token.attr-value .token.punctuation{color:#c3e88d}.token.boolean,.token.keyword{color:#c792ea}.token.important,.token.regex{color:#ffb86c}.token.bold,.token.important{font-weight:700}.token.italic{font-style:italic}.token.entity{cursor:help}code.language-text{background:rgba(0,0,0,.05);font-family:Menlo,monospace;color:rgba(0,0,0,.8);padding:0 3px;border:1px solid rgba(0,0,0,.1);border-radius:3px}</style><link rel="sitemap" type="application/xml" href="/sitemap.xml"/><link rel="shortcut icon" href="/icons/icon-48x48.png?v=8b8d709ee1c3500b70b3f9527cc92c77f9778614"/><link rel="manifest" href="/manifest.webmanifest"/><meta name="theme-color" content="#2D3C3F"/><link rel="apple-touch-icon" sizes="48x48" href="/icons/icon-48x48.png?v=8b8d709ee1c3500b70b3f9527cc92c77f9778614"/><link rel="apple-touch-icon" sizes="72x72" href="/icons/icon-72x72.png?v=8b8d709ee1c3500b70b3f9527cc92c77f9778614"/><link rel="apple-touch-icon" sizes="96x96" href="/icons/icon-96x96.png?v=8b8d709ee1c3500b70b3f9527cc92c77f9778614"/><link rel="apple-touch-icon" sizes="144x144" href="/icons/icon-144x144.png?v=8b8d709ee1c3500b70b3f9527cc92c77f9778614"/><meta name="generator" content="Gatsby 2.2.3"/><link rel="apple-touch-icon" sizes="256x256" href="/icons/icon-256x256.png?v=8b8d709ee1c3500b70b3f9527cc92c77f9778614"/><link rel="apple-touch-icon" sizes="384x384" href="/icons/icon-384x384.png?v=8b8d709ee1c3500b70b3f9527cc92c77f9778614"/><link rel="apple-touch-icon" sizes="512x512" href="/icons/icon-512x512.png?v=8b8d709ee1c3500b70b3f9527cc92c77f9778614"/><title data-react-helmet="true">How AngularJS implements dirty checking | ryanclark.me</title><meta data-react-helmet="true" name="description" content="AngularJS implements dirty checking for two way data binding on $scope variables. Unlike dynamically setting up setters and getters , which is how Ember.js does…"/><meta data-react-helmet="true" property="og:title" content="How AngularJS implements dirty checking"/><meta data-react-helmet="true" property="og:description" content="AngularJS implements dirty checking for two way data binding on $scope variables. Unlike dynamically setting up setters and getters , which is how Ember.js does…"/><meta data-react-helmet="true" property="og:type" content="website"/><meta data-react-helmet="true" name="twitter:card" content="summary"/><meta data-react-helmet="true" name="twitter:creator" content="Ryan Clark"/><meta data-react-helmet="true" name="twitter:title" content="How AngularJS implements dirty checking"/><meta data-react-helmet="true" name="twitter:description" content="AngularJS implements dirty checking for two way data binding on $scope variables. Unlike dynamically setting up setters and getters , which is how Ember.js does…"/><link as="script" rel="preload" href="/component---src-templates-blog-post-tsx-55170dfe89bf8d80733f.js"/><link as="script" rel="preload" href="/9-0c2af406927ebc328aa0.js"/><link as="script" rel="preload" href="/0-598e12153a4b2f19d440.js"/><link as="script" rel="preload" href="/app-6cffb0c4ad93a48e7404.js"/><link as="script" rel="preload" href="/styles-99a47daf12289a4bd376.js"/><link as="script" rel="preload" href="/webpack-runtime-7e1272d25a8326098b48.js"/><link as="fetch" rel="preload" href="/static/d/463/path---how-angularjs-implements-dirty-checking-2-b-2-66b-tgRaXPx9PKN4h82tAv77JSaeI.json" crossorigin="use-credentials"/></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" role="group"><style data-emotion-css="i2srys">.css-i2srys{max-width:1200px;padding-top:50px;margin:0 auto;}</style><div class="css-i2srys e1i1zd320"><style data-emotion-css="cnyx0w">.css-cnyx0w{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;}@media (max-width:800px){.css-cnyx0w{padding:0 15px;}}</style><header class="css-cnyx0w e1i1zd323"><style data-emotion-css="zjk0ag">.css-zjk0ag{-webkit-text-decoration:none;text-decoration:none;box-shadow:none;}.css-zjk0ag:hover{-webkit-text-decoration:none;text-decoration:none;}</style><a class="css-zjk0ag e1i1zd321" href="/"><style data-emotion-css="1thzyjp">.css-1thzyjp{display:-webkit-inline-box;display:-webkit-inline-flex;display:-ms-inline-flexbox;display:inline-flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;font-family:menlo,monospace;font-weight:600;color:#F36964;font-size:28px;position:relative;}</style><div class="css-1thzyjp ehjmckk2"><style data-emotion-css="1tx8c9d">.css-1tx8c9d{color:#56E386;margin-right:14px;}</style><div class="css-1tx8c9d ehjmckk0">➜</div><style data-emotion-css="7slaet">.css-7slaet{color:#93a1a1;margin-right:10px;position:relative;top:-1px;}</style><div class="css-7slaet ehjmckk1">~</div>ryan.clark</div></a><style data-emotion-css="hz653u">.css-hz653u{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;}.css-hz653u svg{width:32px;height:32px;}</style><header class="css-hz653u e1i1zd324"><style data-emotion-css="11dpuo7">.css-11dpuo7{margin-left:15px;}.css-11dpuo7 svg{fill:#262626;}</style><a href="https://github.com/ryanclark" target="_blank" class="css-11dpuo7 e1i1zd322"><svg xmlns="http://www.w3.org/2000/svg" x="0px" y="0px" width="24" height="24" viewBox="0 0 24 24"><g id="surface1"><path d="M 4.0625 4 C 4.0625 4 3.53125 4.925781 3.53125 6.5 C 3.53125 7.546875 3.765625 8.125 3.9375 8.40625 C 2.734375 9.660156 2 11.347656 2 13.53125 C 2 19.125 5.527344 21 12 21 C 18.472656 21 22 19.125 22 13.53125 C 22 11.269531 21.304688 9.574219 20.15625 8.34375 C 20.441406 7.488281 20.769531 5.871094 19.96875 4 C 17.582031 4 15.570313 5.839844 15.5 5.90625 C 14.386719 5.660156 13.210938 5.53125 12 5.53125 C 10.761719 5.53125 9.542969 5.6875 8.40625 5.96875 C 6.808594 4.378906 4.886719 4 4.0625 4 Z M 15.21875 12 C 15.820313 11.992188 16.386719 12.054688 16.875 12.21875 C 18.179688 12.660156 19 13.945313 19 15.375 C 18.996094 19.339844 16.996094 20 11.875 20 C 8.066406 20 4.96875 19.285156 4.96875 15.5 C 4.96875 14.054688 5.71875 13.226563 6.25 12.71875 C 7.417969 11.601563 9.257813 12.15625 11.875 12.15625 C 13.0625 12.15625 14.214844 12.011719 15.21875 12 Z M 8 14 C 7.449219 14 7 14.671875 7 15.5 C 7 16.328125 7.449219 17 8 17 C 8.550781 17 9 16.328125 9 15.5 C 9 14.671875 8.550781 14 8 14 Z M 16 14 C 15.449219 14 15 14.671875 15 15.5 C 15 16.328125 15.449219 17 16 17 C 16.550781 17 17 16.328125 17 15.5 C 17 14.671875 16.550781 14 16 14 Z "></path></g></svg></a><a href="https://twitter.com/rynclark" target="_blank" class="css-11dpuo7 e1i1zd322"><svg viewBox="0 0 48 48" width="1em" height="1em"><g id="surface1"><path fill="#03A9F4;" d="M 42 12.429688 C 40.675781 13.015625 39.253906 13.40625 37.753906 13.589844 C 39.277344 12.683594 40.453125 11.238281 41.003906 9.53125 C 39.574219 10.371094 37.992188 10.984375 36.3125 11.308594 C 34.96875 9.882813 33.050781 9 30.925781 9 C 26.847656 9 23.539063 12.277344 23.539063 16.320313 C 23.539063 16.890625 23.605469 17.449219 23.730469 17.988281 C 17.59375 17.683594 12.148438 14.765625 8.507813 10.335938 C 7.867188 11.417969 7.507813 12.683594 7.507813 14.023438 C 7.507813 16.5625 8.808594 18.800781 10.792969 20.117188 C 9.582031 20.082031 8.441406 19.742188 7.445313 19.203125 C 7.445313 19.226563 7.445313 19.257813 7.445313 19.289063 C 7.445313 22.839844 9.992188 25.796875 13.367188 26.472656 C 12.75 26.640625 12.097656 26.734375 11.425781 26.734375 C 10.949219 26.734375 10.484375 26.679688 10.035156 26.597656 C 10.972656 29.5 13.699219 31.621094 16.933594 31.683594 C 14.402344 33.644531 11.21875 34.820313 7.757813 34.820313 C 7.160156 34.820313 6.574219 34.785156 5.996094 34.714844 C 9.269531 36.785156 13.152344 38 17.320313 38 C 30.90625 38 38.339844 26.84375 38.339844 17.164063 C 38.339844 16.847656 38.328125 16.53125 38.3125 16.222656 C 39.761719 15.195313 41.011719 13.90625 42 12.429688 "></path></g></svg></a></header></header><style data-emotion-css="fltxi7">.css-fltxi7{max-width:800px;margin:100px auto 0;}@media (max-width:800px){.css-fltxi7{margin:20px auto 0;padding:10px 15px;}}</style><main class="css-fltxi7 e1i1zd325"><style data-emotion-css="1myjwgk">.css-1myjwgk{font-family:Oswald,sans-serif;text-transform:uppercase;font-size:100px;max-width:660px;line-height:110px;color:#282A36;margin-bottom:35px;}@media (max-width:800px){.css-1myjwgk{font-size:42px;line-height:48px;}}</style><h1 class="css-1myjwgk e1xte7000">How AngularJS implements dirty checking</h1><p style="font-size:0.87055rem;line-height:1.625rem;display:block;margin-bottom:1.625rem;margin-top:-1.625rem">July 14, 2014</p><style data-emotion-css="hhsj82">.css-hhsj82{background:#FEEFB3;border:1px solid rgba(0,0,0,.05);color:rgba(0,0,0,.8);border-radius:3px;margin:10px 0 20px;padding:10px 20px;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}.css-hhsj82 svg{width:20px;height:20px;margin-right:10px;fill:rgba(0,0,0,0.8);}</style><div class="css-hhsj82 e1d98fs50">Angular constantly update the digest function so this won&#x27;t match the source, but the general idea is still the same</div><div><p>AngularJS implements dirty checking for two way data binding on $scope variables. Unlike dynamically setting up setters and getters<!--more-->, which is how Ember.js does two way data binding, dirty checking allows Angular to watch for variables that may or may not exist.</p>
<h3>$scope.$watch</h3>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js">$scope<span class="token punctuation">.</span><span class="token function">$watch</span><span class="token punctuation">(</span> watchExp<span class="token punctuation">,</span> listener<span class="token punctuation">,</span> objectEquality <span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<p>To watch when a variable changes, you will use the <code class="language-text">$scope.$watch</code> function. With this you give three arguments, what to watch (<code class="language-text">watchExp</code>), what to do when it’s updated (<code class="language-text">listener</code>), and whether or not you’re checking on a variable or on an object. As we are checking a variable, we can ommit this when we call the function. For example -</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js">$scope<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">'Ryan'</span><span class="token punctuation">;</span>

$scope<span class="token punctuation">.</span><span class="token function">$watch</span><span class="token punctuation">(</span> <span class="token keyword">function</span><span class="token punctuation">(</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">return</span> $scope<span class="token punctuation">.</span>name<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span> <span class="token parameter">newValue<span class="token punctuation">,</span> oldValue</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>
	console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'$scope.name was updated!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<p>Angular will register your watcher function in the $scope. You can see that these are registered by logging the <code class="language-text">$scope</code> to the console. <a href="http://jsfiddle.net/ryanclark/SraRB/2/" target="_blank">I’ve created a test directive on jsFiddle to demonstrate this.</a></p>
<p>You’ll notice that the console logs the fact that <code class="language-text">$scope.name</code> is updated - this is because <code class="language-text">$scope.name</code> was previously undefined and we’ve updated it to equal <code class="language-text">Ryan</code>!</p>
<p>You can also use a string instead of a function in $watch. This will do exactly the same as providing a function. In the Angular source code, if you provide a string, the following code is ran - </p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> watchExp <span class="token operator">==</span> <span class="token string">'string'</span> <span class="token operator">&amp;&amp;</span> <span class="token keyword">get</span><span class="token punctuation">.</span>constant<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> originalFn <span class="token operator">=</span> watcher<span class="token punctuation">.</span>fn<span class="token punctuation">;</span>
  watcher<span class="token punctuation">.</span><span class="token function-variable function">fn</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">newVal<span class="token punctuation">,</span> oldVal<span class="token punctuation">,</span> scope</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">originalFn</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> newVal<span class="token punctuation">,</span> oldVal<span class="token punctuation">,</span> scope<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">arrayRemove</span><span class="token punctuation">(</span>array<span class="token punctuation">,</span> watcher<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre></div>
<p>This will set our watchExp to a function, in which it will call our listener with the variable that you’ve given the name of.</p>
<h3>$$watchers</h3>
<p>The <code class="language-text">$$watchers</code> variable in <code class="language-text">$scope</code> holds all of the watchers that you define. If you look into <code class="language-text">$$watchers</code> in the jsFiddle, you’ll see that is an array of objects.</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js">$$watchers <span class="token operator">=</span> <span class="token punctuation">[</span>
	<span class="token punctuation">{</span>
		eq<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token comment">// whether or not we are checking for objectEquality</span>
		<span class="token function-variable function">fn</span><span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span> <span class="token parameter">newValue<span class="token punctuation">,</span> oldValue</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token comment">// this is the listener function we've provided</span>
		last<span class="token punctuation">:</span> <span class="token string">'Ryan'</span><span class="token punctuation">,</span> <span class="token comment">// the last known value for the variable</span>
		<span class="token function-variable function">exp</span><span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token comment">// this is the watchExp function we provided</span>
		<span class="token function-variable function">get</span><span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token comment">// Angular's compiled watchExp function</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">]</span><span class="token punctuation">;</span></code></pre></div>
<p>The <code class="language-text">$watch</code> function returns the <code class="language-text">deregisterWatch</code> function. This means that if we were to assign the initial <code class="language-text">$scope.$watch</code> to a variable, we could just call it to stop watching. <a href="http://jsfiddle.net/ryanclark/SraRB/4/" target="_blank">View this in jsFiddle.</a> Make sure you open and look at the first <code class="language-text">$scope</code> that is logged before clicking on remove watcher!</p>
<p>However, <a href="http://jsfiddle.net/ryanclark/SraRB/5/" target="_blank">take a look at this.</a> If we were to remove the watcher before the controller function is evaluated, there is no log that we updated the <code class="language-text">$scope.name</code> variable, even though we have - why is this?</p>
<h3>$scope.$apply</h3>
<p>Whenever a controller/directive/etc is ran in Angular, internally Angular runs a function called <code class="language-text">$scope.$apply</code>. The <code class="language-text">$apply</code> function will run a function given to it, before finally running the <code class="language-text">$digest</code> function in the rootScope. More on digests later.</p>
<p>The Angular $apply function looks like this -</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token function-variable function">$apply</span><span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">expr</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">try</span> <span class="token punctuation">{</span>
	  <span class="token function">beginPhase</span><span class="token punctuation">(</span><span class="token string">'$apply'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	  <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$eval</span><span class="token punctuation">(</span>expr<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
	  <span class="token function">$exceptionHandler</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span> <span class="token keyword">finally</span> <span class="token punctuation">{</span>
	  <span class="token function">clearPhase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	  <span class="token keyword">try</span> <span class="token punctuation">{</span>
	    $rootScope<span class="token punctuation">.</span><span class="token function">$digest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	  <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
	    <span class="token function">$exceptionHandler</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
	    <span class="token keyword">throw</span> e<span class="token punctuation">;</span>
	  <span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre></div>
<h4>expr</h4>
<p>The <code class="language-text">expr</code> argument is just a function that you or Angular would pass through when calling <code class="language-text">$scope.$apply</code> - most of the time you won’t even need to use <code class="language-text">$apply</code>, let alone give it a function!</p>
<p>Let’s look into how <code class="language-text">ng-keydown</code> uses <code class="language-text">$scope.$apply</code>. To register the directive, Angular uses the following code -</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token keyword">var</span> ngEventDirectives <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token function">forEach</span><span class="token punctuation">(</span>
  <span class="token string">'click dblclick mousedown mouseup mouseover mouseout mousemove mouseenter mouseleave keydown keyup keypress submit focus blur copy cut paste'</span><span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">' '</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">name</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> directiveName <span class="token operator">=</span> <span class="token function">directiveNormalize</span><span class="token punctuation">(</span><span class="token string">'ng-'</span> <span class="token operator">+</span> name<span class="token punctuation">)</span><span class="token punctuation">;</span>
    ngEventDirectives<span class="token punctuation">[</span>directiveName<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'$parse'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">$parse</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token punctuation">{</span>
        <span class="token function-variable function">compile</span><span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">$element<span class="token punctuation">,</span> attr</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token keyword">var</span> fn <span class="token operator">=</span> <span class="token function">$parse</span><span class="token punctuation">(</span>attr<span class="token punctuation">[</span>directiveName<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token keyword">return</span> <span class="token keyword">function</span> <span class="token function">ngEventHandler</span><span class="token punctuation">(</span><span class="token parameter">scope<span class="token punctuation">,</span> element</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            element<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token function">lowercase</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
              scope<span class="token punctuation">.</span><span class="token function">$apply</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token function">fn</span><span class="token punctuation">(</span>scope<span class="token punctuation">,</span> <span class="token punctuation">{</span>$event<span class="token punctuation">:</span>event<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
              <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<p>What this does is loop through the different types of events that can be fired and create a new directive called ng(EventNameHere). In the compile function of the directive, it registers an event handler on the element, with the event being the directives name respectively. When that event is fired, Angular runs <code class="language-text">scope.$apply</code>, giving it a function to run as well. </p>
<h3>This is only one way data binding?</h3>
<p>This will update the $scope value with the elements value - this is only one way data binding. This is because we’ve called <code class="language-text">ng-keydown</code>, only alerting us when the keydown event is fired, and giving us the new value!</p>
<h3>But we want two way data binding!</h3>
<p>Let’s take a look at <code class="language-text">ng-model</code>. When you use <code class="language-text">ng-model</code>, this allows you to do two way data binding - exactly what we want. <code class="language-text">ng-model</code> uses both <code class="language-text">$scope.$watch</code> (view to model) and <code class="language-text">$scope.$apply</code> (model to view) to offer this.</p>
<p><code class="language-text">ng-model</code> will attach the event handler directive (such as <code class="language-text">keydown</code>) to the input you’ve applied it to - this is where <code class="language-text">$scope.$apply</code> is called! <code class="language-text">$scope.$watch</code> is called in the directive’s controller. You can see this here -</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js">$scope<span class="token punctuation">.</span><span class="token function">$watch</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token function">ngModelWatch</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">var</span> value <span class="token operator">=</span> <span class="token function">ngModelGet</span><span class="token punctuation">(</span>$scope<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment">// if scope model value and ngModel value are out of sync</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>ctrl<span class="token punctuation">.</span>$modelValue <span class="token operator">!==</span> value<span class="token punctuation">)</span> <span class="token punctuation">{</span>

		<span class="token keyword">var</span> formatters <span class="token operator">=</span> ctrl<span class="token punctuation">.</span>$formatters<span class="token punctuation">,</span>
			idx <span class="token operator">=</span> formatters<span class="token punctuation">.</span>length<span class="token punctuation">;</span>

		ctrl<span class="token punctuation">.</span>$modelValue <span class="token operator">=</span> value<span class="token punctuation">;</span>
		<span class="token keyword">while</span><span class="token punctuation">(</span>idx<span class="token operator">--</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			value <span class="token operator">=</span> formatters<span class="token punctuation">[</span>idx<span class="token punctuation">]</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>

		<span class="token keyword">if</span> <span class="token punctuation">(</span>ctrl<span class="token punctuation">.</span>$viewValue <span class="token operator">!==</span> value<span class="token punctuation">)</span> <span class="token punctuation">{</span>
			ctrl<span class="token punctuation">.</span>$viewValue <span class="token operator">=</span> value<span class="token punctuation">;</span>
    		ctrl<span class="token punctuation">.</span><span class="token function">$render</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    	<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">return</span> value<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<p>When you call <code class="language-text">$scope.$watch</code> with only one argument, the function you provide it will be called regardless of what updates - perfect! The function that is given in <code class="language-text">ng-model</code> checks if the model and view are out of sync, and if it is, it will update the model with its new value. The function returns the new value, so when it is ran in the <code class="language-text">$digest</code> function, we will know what the new value is!</p>
<h3>So why does our listener not fire?</h3>
<p>If we look back at the jsFiddle where we deregister the <code class="language-text">$scope.$watch</code> function in the same function as we define it, we can now understand why we don’t get notified about us updating <code class="language-text">$scope.name</code> even though we did.</p>
<p>As mentioned earlier, Angular runs <code class="language-text">$scope.$apply</code> on every directive’s controller function. If we look into the <code class="language-text">$scope.$apply</code> function, it only runs the <code class="language-text">$digest</code> after the directive’s controller function has been evaluated - meaning that the <code class="language-text">$scope.$watch</code> function never actually gets a chance to be called, as we’ve deregisted it before it could’ve been ran! But how is it ran? </p>
<h3>$digest</h3>
<p>The <code class="language-text">$digest</code> function is called on the <code class="language-text">$rootScope</code> by <code class="language-text">$scope.$apply</code>. This will run the digest cycle on the $rootScope and will then traverse down the scopes and run the digest cycle on that. In simple terms, the digest cycle will fire all of our <code class="language-text">watchExp</code> functions in the <code class="language-text">$$watchers</code> variable, compare them against the last known value, and if they’re different, fire the listener!</p>
<p>When the digest cycle runs, it loops through the watchers and then loops again, whilst the cycle is considered “dirty”. The cycle is considered dirty when the <code class="language-text">watchExp</code> and last known value aren’t equal to each other. Ideally this will run once, but if it runs more than 10 times you will get an error.</p>
<p>So when <code class="language-text">$scope.$apply</code> is ran, <code class="language-text">$digest</code> is ran, it will then loop through the <code class="language-text">$$watchers</code> and fire any listener event if the <code class="language-text">watchExp</code> does not equal the last known value. <code class="language-text">$scope.$apply</code> is ran by Angular on anything that could possibly contain a model value changing. This is why when you update the <code class="language-text">$scope</code> outside of Angular, for instance in a <code class="language-text">setTimeout</code> function, you need to run <code class="language-text">$scope.$apply();</code> in order to have Angular notice that the scope has been updated!</p>
<h3>Let’s create our own</h3>
<p>We’ll create a small, basic version of dirty checking that we can use. Angular’s dirty checking is a bit more advanced, offering async queues and some other neat things.</p>
<h4>Setup our scope</h4>
<p>Scope will just be a function, containing any data that we wish to store in it. We’ll extend the prototype object on the function to replicate <code class="language-text">$digest</code> and <code class="language-text">$watch</code>. We don’t need <code class="language-text">$apply</code> as we’ll be won’t need to evaluate any functions in the context of the Scope - we’ll just simply use <code class="language-text">$digest</code>. Our Scope will look like this - </p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token keyword">var</span> <span class="token function-variable function">Scope</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">this</span><span class="token punctuation">.</span>$$watchers <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>	
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token class-name">Scope</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">$watch</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>
	
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token class-name">Scope</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">$digest</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>
	
<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre></div>
<p>Our <code class="language-text">$watch</code> function needs to accept two parameters, <code class="language-text">watchExp</code> and <code class="language-text">listener</code>. When <code class="language-text">$watch</code> is called, we’ll push these into the <code class="language-text">$$watcher</code> value we’ve set in <code class="language-text">Scope</code>.</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token keyword">var</span> <span class="token function-variable function">Scope</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">this</span><span class="token punctuation">.</span>$$watchers <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>	
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token class-name">Scope</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">$watch</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span> <span class="token parameter">watchExp<span class="token punctuation">,</span> listener</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">this</span><span class="token punctuation">.</span>$$watchers<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span> <span class="token punctuation">{</span>
		watchExp<span class="token punctuation">:</span> watchExp<span class="token punctuation">,</span>
		listener<span class="token punctuation">:</span> listener <span class="token operator">||</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
	<span class="token punctuation">}</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token class-name">Scope</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">$digest</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>
	
<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre></div>
<p>You’ll notice that I’ve set <code class="language-text">listener</code> to an empty function if there is no <code class="language-text">listener</code> provided - this way we can register a <code class="language-text">$watch</code> for all variables!</p>
<p>Next we will work on the <code class="language-text">$digest</code>. We need to check if the old value is equal to the new value, and fire the listener if it isn’t. We will then loop until they are equal to each other. This is where the <code class="language-text">dirty</code> variable comes in - whether or not the values are equal to each other!</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token keyword">var</span> <span class="token function-variable function">Scope</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">this</span><span class="token punctuation">.</span>$$watchers <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>	
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token class-name">Scope</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">$watch</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span> <span class="token parameter">watchExp<span class="token punctuation">,</span> listener</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">this</span><span class="token punctuation">.</span>$$watchers<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span> <span class="token punctuation">{</span>
		watchExp<span class="token punctuation">:</span> watchExp<span class="token punctuation">,</span>
		listener<span class="token punctuation">:</span> listener <span class="token operator">||</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
	<span class="token punctuation">}</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token class-name">Scope</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">$digest</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">var</span> dirty<span class="token punctuation">;</span>

	<span class="token keyword">do</span> <span class="token punctuation">{</span>
			dirty <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>

			<span class="token keyword">for</span><span class="token punctuation">(</span> <span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$$watchers<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>
				<span class="token keyword">var</span> newValue <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$$watchers<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">watchExp</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
					oldValue <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$$watchers<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>last<span class="token punctuation">;</span>

				<span class="token keyword">if</span><span class="token punctuation">(</span> oldValue <span class="token operator">!==</span> newValue <span class="token punctuation">)</span> <span class="token punctuation">{</span>
					<span class="token keyword">this</span><span class="token punctuation">.</span>$$watchers<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">listener</span><span class="token punctuation">(</span>newValue<span class="token punctuation">,</span> oldValue<span class="token punctuation">)</span><span class="token punctuation">;</span>

					dirty <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>

					<span class="token keyword">this</span><span class="token punctuation">.</span>$$watchers<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>last <span class="token operator">=</span> newValue<span class="token punctuation">;</span>
				<span class="token punctuation">}</span>
			<span class="token punctuation">}</span>
	<span class="token punctuation">}</span> <span class="token keyword">while</span><span class="token punctuation">(</span>dirty<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre></div>
<p>Next, we need to create a new instance of our scope. We’ll assign this to <code class="language-text">$scope</code>. We can then register a watch function, and <code class="language-text">$digest</code> it after we update it!</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token keyword">var</span> <span class="token function-variable function">Scope</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">this</span><span class="token punctuation">.</span>$$watchers <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>	
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token class-name">Scope</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">$watch</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span> <span class="token parameter">watchExp<span class="token punctuation">,</span> listener</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">this</span><span class="token punctuation">.</span>$$watchers<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span> <span class="token punctuation">{</span>
		watchExp<span class="token punctuation">:</span> watchExp<span class="token punctuation">,</span>
		listener<span class="token punctuation">:</span> listener <span class="token operator">||</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
	<span class="token punctuation">}</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token class-name">Scope</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">$digest</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">var</span> dirty<span class="token punctuation">;</span>

	<span class="token keyword">do</span> <span class="token punctuation">{</span>
			dirty <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>

			<span class="token keyword">for</span><span class="token punctuation">(</span> <span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$$watchers<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>
				<span class="token keyword">var</span> newValue <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$$watchers<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">watchExp</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
					oldValue <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$$watchers<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>last<span class="token punctuation">;</span>

				<span class="token keyword">if</span><span class="token punctuation">(</span> oldValue <span class="token operator">!==</span> newValue <span class="token punctuation">)</span> <span class="token punctuation">{</span>
					<span class="token keyword">this</span><span class="token punctuation">.</span>$$watchers<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">listener</span><span class="token punctuation">(</span>newValue<span class="token punctuation">,</span> oldValue<span class="token punctuation">)</span><span class="token punctuation">;</span>

					dirty <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>

					<span class="token keyword">this</span><span class="token punctuation">.</span>$$watchers<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>last <span class="token operator">=</span> newValue<span class="token punctuation">;</span>
				<span class="token punctuation">}</span>
			<span class="token punctuation">}</span>
	<span class="token punctuation">}</span> <span class="token keyword">while</span><span class="token punctuation">(</span>dirty<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>


<span class="token keyword">var</span> $scope <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Scope</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

$scope<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">'Ryan'</span><span class="token punctuation">;</span>

$scope<span class="token punctuation">.</span><span class="token function">$watch</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">return</span> $scope<span class="token punctuation">.</span>name<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span> <span class="token parameter">newValue<span class="token punctuation">,</span> oldValue</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>newValue<span class="token punctuation">,</span> oldValue<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>

$scope<span class="token punctuation">.</span><span class="token function">$digest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<p>Success - we have dirty checking (in it’s most basic form) implemented! <a href="http://jsfiddle.net/ryanclark/PVQts/" target="_blank">Check out the jsFiddle</a> to mess around with what we’ve made. If you look at the console, you’ll notice it logs</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js">Ryan <span class="token keyword">undefined</span></code></pre></div>
<p>Which is the exact behaviour we want - <code class="language-text">$scope.name</code> was previously undefined and we’ve set it to Ryan - result!</p>
<p>Let’s attach our <code class="language-text">$digest</code> function to a <code class="language-text">keyup</code> event on an input. That way we don’t have to call it ourselves. This means we can have two way data binding too!</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token keyword">var</span> <span class="token function-variable function">Scope</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">this</span><span class="token punctuation">.</span>$$watchers <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>	
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token class-name">Scope</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">$watch</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span> <span class="token parameter">watchExp<span class="token punctuation">,</span> listener</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">this</span><span class="token punctuation">.</span>$$watchers<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span> <span class="token punctuation">{</span>
		watchExp<span class="token punctuation">:</span> watchExp<span class="token punctuation">,</span>
		listener<span class="token punctuation">:</span> listener <span class="token operator">||</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
	<span class="token punctuation">}</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token class-name">Scope</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">$digest</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">var</span> dirty<span class="token punctuation">;</span>

	<span class="token keyword">do</span> <span class="token punctuation">{</span>
			dirty <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>

			<span class="token keyword">for</span><span class="token punctuation">(</span> <span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$$watchers<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>
				<span class="token keyword">var</span> newValue <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$$watchers<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">watchExp</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
					oldValue <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$$watchers<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>last<span class="token punctuation">;</span>

				<span class="token keyword">if</span><span class="token punctuation">(</span> oldValue <span class="token operator">!==</span> newValue <span class="token punctuation">)</span> <span class="token punctuation">{</span>
					<span class="token keyword">this</span><span class="token punctuation">.</span>$$watchers<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">listener</span><span class="token punctuation">(</span>newValue<span class="token punctuation">,</span> oldValue<span class="token punctuation">)</span><span class="token punctuation">;</span>

					dirty <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>

					<span class="token keyword">this</span><span class="token punctuation">.</span>$$watchers<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>last <span class="token operator">=</span> newValue<span class="token punctuation">;</span>
				<span class="token punctuation">}</span>
			<span class="token punctuation">}</span>
	<span class="token punctuation">}</span> <span class="token keyword">while</span><span class="token punctuation">(</span>dirty<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>


<span class="token keyword">var</span> $scope <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Scope</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

$scope<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">'Ryan'</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> element <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelectorAll</span><span class="token punctuation">(</span><span class="token string">'input'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

element<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function-variable function">onkeyup</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	$scope<span class="token punctuation">.</span>name <span class="token operator">=</span> element<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>value<span class="token punctuation">;</span>

	$scope<span class="token punctuation">.</span><span class="token function">$digest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

$scope<span class="token punctuation">.</span><span class="token function">$watch</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">return</span> $scope<span class="token punctuation">.</span>name<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span> <span class="token parameter">newValue<span class="token punctuation">,</span> oldValue</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Input value updated - it is now '</span> <span class="token operator">+</span> newValue<span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    element<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>value <span class="token operator">=</span> $scope<span class="token punctuation">.</span>name<span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> <span class="token function-variable function">updateScopeValue</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token function">updateScopeValue</span><span class="token punctuation">(</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>
    $scope<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">'Bob'</span><span class="token punctuation">;</span>
    $scope<span class="token punctuation">.</span><span class="token function">$digest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre></div>
<p>Perfect - using this approach we can now update the input’s value and it will be reflected in <code class="language-text">$scope.name</code>, as well as call <code class="language-text">updateScopeValue</code> and have the input’s value reflect that! <a href="http://jsfiddle.net/ryanclark/S3unb/1/" target="_blank">You can play around with this here.</a></p></div><hr style="margin-bottom:1.625rem"/><div style="display:flex;align-items:center;margin-bottom:4.0625rem"><div class=" gatsby-image-wrapper" style="position:relative;overflow:hidden;display:inline-block;width:50px;height:50px;margin-right:0.8125rem;margin-bottom:0;min-width:50px;border-radius:100%"><img src="data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAUABQDASIAAhEBAxEB/8QAGAABAAMBAAAAAAAAAAAAAAAAAAMEBQL/xAAVAQEBAAAAAAAAAAAAAAAAAAAAAf/aAAwDAQACEAMQAAABuwWITXBl8FmuJf/EABsQAAICAwEAAAAAAAAAAAAAAAECAwQAETIQ/9oACAEBAAEFArp0sUTeXRtISqpl/gc5/8QAFhEBAQEAAAAAAAAAAAAAAAAAARAx/9oACAEDAQE/ASGz/8QAFhEAAwAAAAAAAAAAAAAAAAAAARAx/9oACAECAQE/ATEYv//EABoQAAIDAQEAAAAAAAAAAAAAAAACARARYXH/2gAIAQEABj8CU1spdk7S+kV//8QAGxABAAICAwAAAAAAAAAAAAAAAQAREDEhUWH/2gAIAQEAAT8hBT2xgVPDAcALg1As1jZkGkx//9oADAMBAAIAAwAAABDTwDz/xAAXEQADAQAAAAAAAAAAAAAAAAABEBEx/9oACAEDAQE/EJpq0X//xAAWEQEBAQAAAAAAAAAAAAAAAAAQMRH/2gAIAQIBAT8Q1BA//8QAHRAAAgIDAAMAAAAAAAAAAAAAAREhMQAQYUFRkf/aAAgBAQABPxDgJD3GKGGCCONModqyVCCnFgwuXPnk6gFYYfMbgJp9nX//2Q==" alt="Ryan Clark" style="position:absolute;top:0;left:0;width:100%;height:100%;object-fit:cover;object-position:center;opacity:1;transition:opacity 0.5s;transition-delay:0.25s;border-radius:50%"/><noscript><picture><img width="50" height="50" srcset="/static/89447586dcc046565cd42084cb1753e2/7e494/profile-pic.jpg 1x,
/static/89447586dcc046565cd42084cb1753e2/36cc2/profile-pic.jpg 1.5x,
/static/89447586dcc046565cd42084cb1753e2/0a3a6/profile-pic.jpg 2x,
/static/89447586dcc046565cd42084cb1753e2/75d16/profile-pic.jpg 3x" src="/static/89447586dcc046565cd42084cb1753e2/7e494/profile-pic.jpg" alt="Ryan Clark" style="position:absolute;top:0;left:0;transition:opacity 0.5s;transition-delay:0.5s;opacity:1;width:100%;height:100%;object-fit:cover;object-position:center"/></picture></noscript></div><div>A blog by me, <strong>Ryan Clark</strong>. <a target="_blank" href="https://twitter.com/rynclark">Follow me on Twitter!</a></div></div><div id="disqus_thread"></div></main></div></div></div><script>
  
  
  if(true) {
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  }
  if (typeof ga === "function") {
    ga('create', 'UA-49723822-1', 'auto', {});
      
      
      
      }
      </script><script id="gatsby-script-loader">/*<![CDATA[*/window.page={"componentChunkName":"component---src-templates-blog-post-tsx","jsonName":"how-angularjs-implements-dirty-checking-2b2","path":"/how-angularjs-implements-dirty-checking/"};window.dataPath="463/path---how-angularjs-implements-dirty-checking-2-b-2-66b-tgRaXPx9PKN4h82tAv77JSaeI";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"app":["/app-6cffb0c4ad93a48e7404.js"],"component---node-modules-gatsby-plugin-offline-app-shell-js":["/component---node-modules-gatsby-plugin-offline-app-shell-js-4ce7f49cec02d9b9d831.js"],"component---src-templates-blog-post-tsx":["/component---src-templates-blog-post-tsx-55170dfe89bf8d80733f.js"],"component---src-pages-404-tsx":["/component---src-pages-404-tsx-69e227989c0bb89889a2.js"],"component---src-pages-index-tsx":["/component---src-pages-index-tsx-cf377fd6b737b1ec4eee.js"],"pages-manifest":["/pages-manifest-ec61e97f400f9f641196.js"]};/*]]>*/</script><script src="/webpack-runtime-7e1272d25a8326098b48.js" async=""></script><script src="/styles-99a47daf12289a4bd376.js" async=""></script><script src="/app-6cffb0c4ad93a48e7404.js" async=""></script><script src="/0-598e12153a4b2f19d440.js" async=""></script><script src="/9-0c2af406927ebc328aa0.js" async=""></script><script src="/component---src-templates-blog-post-tsx-55170dfe89bf8d80733f.js" async=""></script></body></html>