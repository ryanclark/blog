<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="description" content="">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />

  <title>Going native with React, an introduction</title>

  <link rel="stylesheet" href="http://fonts.googleapis.com/css?family=Open+Sans:400,600,700">

  <link rel="alternate" type="application/rss+xml" title="RSS" href="/feed.xml" />
<link href="/css/main.2ab3f8961b31d8f18dcf1491ae95766a.css" rel="stylesheet"></head>
<body>

<aside class="sidebar">
  <div class="sidebar__fixed">
    <div class="sidebar__info">
      
      <a href="/" class="logo">
        <canvas width="72px" height="72px"></canvas>
      </a>
      

      <div class="sidebar__overlay ">
        <span class="sidebar__title">ryanclark.me</span>

        <ul class="social">
          <li class="social__item">
            <a target="_blank" href="https://twitter.com/rynclark">
              <i class="fa fa-fw fa-twitter"></i>
            </a>
          </li>
          <li class="social__item">
            <a target="_blank" href="/feed.xml">
              <i class="fa fa-fw fa-rss"></i>
            </a>
          </li>
          <li class="social__item">
            <a target="_blank" href="http://github.com/rynclark">
              <i class="fa fa-fw fa-github"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>

    <nav class="navigation">
      <ul class="navigation__list">
        <li class="navigation__item">
          <h3 class="navigation__header">Deep Dive Series</h3>
        </li>
        <li class="navigation__item">
          <a href="/" class="navigation__link">
            Webpack
          </a>
        </li>
      </ul>
      <ul class="navigation__list">
        <li class="navigation__item">
          <h3 class="navigation__header">React</h3>
        </li>
        <li class="navigation__item">
          <a href="/going-native-with-react/" class="navigation__link">
            Go native with React
          </a>
        </li>
        <li class="navigation__item">
          <a href="/getting-started-with-flux/" class="navigation__link">
            Introduction to Flux
          </a>
        </li>
        <li class="navigation__item">
          <a href="/getting-started-with-react/" class="navigation__link">
            Getting started with React
          </a>
        </li>
      </ul>
      <ul class="navigation__list">
        <li class="navigation__item">
          <h3 class="navigation__header">Angular</h3>
        </li>
        <li class="navigation__item">
          <h4 class="navigation__sub-header">1.x</h4>
        </li>
        <li class="navigation__item">
          <a href="/how-angularjs-implements-dirty-checking/" class="navigation__link">
            How Angular dirty checks
          </a>
        </li>
      </ul>
      <ul class="navigation__list">
        <li class="navigation__item">
          <h3 class="navigation__header">Misc</h3>
        </li>
        <li class="navigation__item">
          <a href="/rgb-to-hex-via-binary-shifting/" class="navigation__link">
            RGB to hex via binary shifting
          </a>
        </li>
      </ul>
    </nav>

    <div class="sidebar__progress">
      <div class="sidebar__progress__bar"></div>
    </div>
  </div>
</aside>


<section class="content">
  <div class="container">
    <article class="article">
	<header>
		<h2>Going native with React, an introduction</h2>
		<span class="time">11 May 2015</span>
	</header>

  <div class="post contents">

    <div class="warning">
      <i class="fa fa-exclamation-circle"></i>

      React Native has moved on a lot since this article - some methods may not work
    </div>


    <div class="product-versions">

<div class="highlight"><pre><code class="language-json" data-lang="json"><span class="p">{</span>
  <span class="err">//</span> <span class="err">Versions</span>
  <span class="nt">&quot;react-native&quot;</span><span class="p">:</span> <span class="s2">&quot;0.4.0&quot;</span>
<span class="p">}</span></code></pre></div>

    </div>


	  <p>As a JavaScript developer, I would’ve never thought that I could make <strong>native</strong> mobile applications easily in JavaScript. Sure, we have tools such as PhoneGap, but wrapping our browser based application in native application leaves a lot to be desired<!--more-->.</p>

<p>It’s all changed now - the React team over at Facebook have released React Native. This not only allows us to use the React framework to create applications that utilise native mobile components, but it does that all in real time - meaning that we don’t have to recompile our applications as we develop on them - this makes it incredibly easy to create mobile apps! Luckily I got to preview React Native in its beta and even since then it’s progressed massively.</p>

<p>Please note that currently iOS is supported. You will therefore need to be running OS X with XCode in order to follow this tutorial.</p>

<p>If you haven’t had a chance to learn React, <a target="_blank" href="/getting-started-with-react">take a look at my tutorial</a> to get started with it.</p>

<p>It’s important to note that this doesn’t mean we can write code once and use it everywhere. Trying to do that can be disastrous as the level of abstraction would be insane. Instead, React Native allows us to learn once, write everywhere.</p>

<h3 id="going-back-to-2004">Going back to 2004</h3>

<p>If you have watched The Social Network you will remember FaceMash, the application that kicked off Facebook. For those who haven’t watched, 11 years ago (wow) Mark Zuckerberg created FaceMash, an application where you could view two people and rate which one is hotter. Each person would have a score (although the original algorithm is unknown, the movie shows the <a href="http://en.wikipedia.org/wiki/Elo_rating_system" target="_blank">Elo rating algorithm</a> being used) that reflected how “hot” they are.</p>

<p>Here it is in all it’s glory -</p>

<div style="text-align: center; margin: 20px 0;">
    <a href="/img/going-native-with-react/facemash.jpg" target="_blank"><img src="/img/going-native-with-react/facemash.jpg" /></a>
</div>

<p>Let’s go full circle - we’re going to be recreating FaceMash in React Native. If you think it’s immoral to rate girls on their looks, feel free to change the pictures to something else that you find attractive (dogs, snippets of code, etc, I’m not judging you).</p>

<h2 id="creating-our-app">Creating our app</h2>

<p><a href="https://github.com/rynclark/facemash" target="_blank">You can clone the start repo here</a> if you wish. This isn’t necessary, however there different branches of the code at different stages just in case you get lost!</p>

<h3 id="houston-we-have-lift-off">Houston, we have lift off</h3>

<p>If you haven’t cloned the repo, we need to setup our base project. React Native allows us to quickly start up a project with the <code>react-native-cli</code> npm package CLI. If you don’t have it installed, quickly run</p>

<div class="code-block code-block--no-linenos">

<div class="highlight"><pre><code class="language-bash" data-lang="bash">npm install -g react-native-cli</code></pre></div>

</div>

<p>And then we can get started.</p>

<p>Navigate to a folder in the terminal and run</p>

<div class="code-block code-block--no-linenos">

<div class="highlight"><pre><code class="language-bash" data-lang="bash">react-native init FaceMash</code></pre></div>

</div>

<p>This will create our base application ready for us to dig in and add to.</p>

<h2 id="open-it-up">Open it up</h2>

<p>Launch XCode and navigate to the directory you created the application in. From here, we will need to open up <code>facemash.xcodeproj</code>.</p>

<p>React Native supports us working in both the iOS Simulator and our actual iOS devices.</p>

<p>I will be developing in the iOS Simulator as it allows more rapid application development - we can press <code>Command + R</code> to refresh the application when we make changes to our JavaScript, or we can be super lazy and enable live reloading via the developer menu (accessible via <code>Command + Control + Z</code>). We can even debug our code in the Chrome developer tools.</p>

<p>If you wish to develop the application using your iOS device, you will need to be on the same network as your computer. By default, React Native will look at <code>localhost</code> for the JavaScript so you will need to point it to your computer.</p>

<p>We can do this by editing the <code>AppDelegate.m</code> file and changing <code>localhost</code> to our local IP. You can find this on OS X by <code>Alt + Click</code>-ing the wireless menu.</p>

<p><a href="/img/going-native-with-react/change-to-local.png" target="_blank"><img src="/img/going-native-with-react/change-to-local.png" /></a></p>

<p>We can now run our application. The application will open in whatever target you’ve picked in XCode. When we click run, a terminal process will also spawn running <code>npm start</code> in the directory of our application. If you don’t wish to run the app through XCode, make sure you run <code>npm start</code>. This will create a local web server on port <code>8081</code> which points to our compiled JavaScript code and also watch and recompile our code on save.</p>

<div style="text-align: center">
    <a href="/img/going-native-with-react/first-run.png" target="_blank"><img src="/img/going-native-with-react/first-run.png" /></a>
</div>

<p>I’m running the application in a simulated iPhone 6, running at a 50% scale.</p>

<p>There we go, we’ve got a blank canvas with so much room for activities!</p>

<h2 id="taking-a-peek">Taking a peek</h2>

<p>Let’s take a look at the code it takes to render what we can see in the screenshot above. Open up <code>index.ios.js</code>.</p>

<div class="file-name">
  <span class="file-name__file">
    <i class="fa fa-file-code-o"></i>
    index.ios.js
  </span>
</div>
<div class="code-block">

<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><code class="language-js" data-lang="js"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53</code></pre></div></td><td class="code"><div class="highlight"><pre><span class="cm">/**</span>
<span class="cm"> * Sample React Native App</span>
<span class="cm"> * https://github.com/facebook/react-native</span>
<span class="cm"> */</span>
<span class="s1">&#39;use strict&#39;</span><span class="p">;</span>

<span class="kd">var</span> <span class="nx">React</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;react-native&#39;</span><span class="p">);</span>
<span class="kd">var</span> <span class="p">{</span>
  <span class="nx">AppRegistry</span><span class="p">,</span>
  <span class="nx">StyleSheet</span><span class="p">,</span>
  <span class="nx">Text</span><span class="p">,</span>
  <span class="nx">View</span><span class="p">,</span>
<span class="p">}</span> <span class="o">=</span> <span class="nx">React</span><span class="p">;</span>

<span class="kd">var</span> <span class="nx">facemash</span> <span class="o">=</span> <span class="nx">React</span><span class="p">.</span><span class="nx">createClass</span><span class="p">({</span>
  <span class="nx">render</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="p">(</span>
      <span class="o">&lt;</span><span class="nx">View</span> <span class="nx">style</span><span class="o">=</span><span class="p">{</span><span class="nx">styles</span><span class="p">.</span><span class="nx">container</span><span class="p">}</span><span class="o">&gt;</span>
        <span class="o">&lt;</span><span class="nx">Text</span> <span class="nx">style</span><span class="o">=</span><span class="p">{</span><span class="nx">styles</span><span class="p">.</span><span class="nx">welcome</span><span class="p">}</span><span class="o">&gt;</span>
          <span class="nx">Welcome</span> <span class="nx">to</span> <span class="nx">React</span> <span class="nx">Native</span><span class="o">!</span>
        <span class="o">&lt;</span><span class="err">/Text&gt;</span>
        <span class="o">&lt;</span><span class="nx">Text</span> <span class="nx">style</span><span class="o">=</span><span class="p">{</span><span class="nx">styles</span><span class="p">.</span><span class="nx">instructions</span><span class="p">}</span><span class="o">&gt;</span>
          <span class="nx">To</span> <span class="nx">get</span> <span class="nx">started</span><span class="p">,</span> <span class="nx">edit</span> <span class="nx">index</span><span class="p">.</span><span class="nx">ios</span><span class="p">.</span><span class="nx">js</span>
        <span class="o">&lt;</span><span class="err">/Text&gt;</span>
        <span class="o">&lt;</span><span class="nx">Text</span> <span class="nx">style</span><span class="o">=</span><span class="p">{</span><span class="nx">styles</span><span class="p">.</span><span class="nx">instructions</span><span class="p">}</span><span class="o">&gt;</span>
          <span class="nx">Press</span> <span class="nx">Cmd</span><span class="o">+</span><span class="nx">R</span> <span class="nx">to</span> <span class="nx">reload</span><span class="p">,{</span><span class="s1">&#39;\n&#39;</span><span class="p">}</span>
          <span class="nx">Cmd</span><span class="o">+</span><span class="nx">Control</span><span class="o">+</span><span class="nx">Z</span> <span class="k">for</span> <span class="nx">dev</span> <span class="nx">menu</span>
        <span class="o">&lt;</span><span class="err">/Text&gt;</span>
      <span class="o">&lt;</span><span class="err">/View&gt;</span>
    <span class="p">);</span>
  <span class="p">}</span>
<span class="p">});</span>

<span class="kd">var</span> <span class="nx">styles</span> <span class="o">=</span> <span class="nx">StyleSheet</span><span class="p">.</span><span class="nx">create</span><span class="p">({</span>
  <span class="nx">container</span><span class="o">:</span> <span class="p">{</span>
    <span class="nx">flex</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="nx">justifyContent</span><span class="o">:</span> <span class="s1">&#39;center&#39;</span><span class="p">,</span>
    <span class="nx">alignItems</span><span class="o">:</span> <span class="s1">&#39;center&#39;</span><span class="p">,</span>
    <span class="nx">backgroundColor</span><span class="o">:</span> <span class="s1">&#39;#F5FCFF&#39;</span><span class="p">,</span>
  <span class="p">},</span>
  <span class="nx">welcome</span><span class="o">:</span> <span class="p">{</span>
    <span class="nx">fontSize</span><span class="o">:</span> <span class="mi">20</span><span class="p">,</span>
    <span class="nx">textAlign</span><span class="o">:</span> <span class="s1">&#39;center&#39;</span><span class="p">,</span>
    <span class="nx">margin</span><span class="o">:</span> <span class="mi">10</span><span class="p">,</span>
  <span class="p">},</span>
  <span class="nx">instructions</span><span class="o">:</span> <span class="p">{</span>
    <span class="nx">textAlign</span><span class="o">:</span> <span class="s1">&#39;center&#39;</span><span class="p">,</span>
    <span class="nx">color</span><span class="o">:</span> <span class="s1">&#39;#333333&#39;</span><span class="p">,</span>
    <span class="nx">marginBottom</span><span class="o">:</span> <span class="mi">5</span><span class="p">,</span>
  <span class="p">},</span>
<span class="p">});</span>

<span class="nx">AppRegistry</span><span class="p">.</span><span class="nx">registerComponent</span><span class="p">(</span><span class="s1">&#39;facemash&#39;</span><span class="p">,</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="nx">facemash</span><span class="p">);</span>
</pre></div>
</td></tr></table>

</div>

<p>You can close your mouth now - yes, that is all it takes to render our application. Looks familiar, doesn’t it?</p>

<h2 id="react-native-vs-the-browser">React Native vs the browser</h2>

<p>Not all of React Native matches what you would’ve been using with React in the browser. However, the differences between the two are so minuscule there’s no need to worry about them.</p>

<ul>
  <li>Instead of using block elements such as <code>div</code> or <code>section</code>, we use the <code>View</code> component in React Native. This maps over to the native iOS component <code>UIView</code>.</li>
  <li>All text must be wrapped inside the <code>Text</code> component</li>
  <li>No stylesheets - all your styling is written as JavaScript objects</li>
  <li>We don’t need to worry about what is browser compatibility - ES6 harmony is supported out of the box as well as flexbox</li>
</ul>

<h2 id="get-to-work">Get to work</h2>

<p>We’re going to start by clearing out the stylesheet and <code>render</code> function of our React component. Ideally, to get a basic feeling of React Native, we’re going to try and use as many different components as we can.</p>

<p>Let’s start off with the <code>TabBarIOS</code> component. You might recognise the TabBar component, used in some of the core iOS apps such as Clock and Photos.</p>

<div class="file-name">
  <span class="file-name__file">
    <i class="fa fa-file-code-o"></i>
    index.ios.js
  </span>
</div>
<div class="code-block">

<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><code class="language-js" data-lang="js"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55</code></pre></div></td><td class="code"><div class="highlight"><pre><span class="kd">var</span> <span class="nx">React</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;react-native&#39;</span><span class="p">);</span>
<span class="kd">var</span> <span class="p">{</span>
  <span class="nx">AppRegistry</span><span class="p">,</span>
  <span class="nx">StyleSheet</span><span class="p">,</span>
  <span class="nx">Text</span><span class="p">,</span>
  <span class="nx">View</span><span class="p">,</span>
  <span class="nx">TabBarIOS</span>
<span class="p">}</span> <span class="o">=</span> <span class="nx">React</span><span class="p">;</span>

<span class="kd">var</span> <span class="nx">facemash</span> <span class="o">=</span> <span class="nx">React</span><span class="p">.</span><span class="nx">createClass</span><span class="p">({</span>
  <span class="nx">getInitialState</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="p">{</span>
      <span class="nx">selectedTab</span><span class="o">:</span> <span class="s1">&#39;faceMash&#39;</span>
    <span class="p">}</span>
  <span class="p">},</span>
  <span class="nx">render</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="p">(</span>
      <span class="o">&lt;</span><span class="nx">TabBarIOS</span><span class="o">&gt;</span>
        <span class="o">&lt;</span><span class="nx">TabBarIOS</span><span class="p">.</span><span class="nx">Item</span>
          <span class="nx">title</span><span class="o">=</span><span class="s2">&quot;FaceMash&quot;</span>
          <span class="nx">icon</span><span class="o">=</span><span class="p">{</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;image!facemash&#39;</span><span class="p">)</span> <span class="p">}</span>
          <span class="nx">selected</span><span class="o">=</span><span class="p">{</span> <span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">selectedTab</span> <span class="o">===</span> <span class="s1">&#39;faceMash&#39;</span> <span class="p">}</span><span class="o">&gt;</span>
          <span class="o">&lt;</span><span class="nx">View</span> <span class="nx">style</span><span class="o">=</span><span class="p">{</span> <span class="nx">styles</span><span class="p">.</span><span class="nx">pageView</span> <span class="p">}</span><span class="o">&gt;</span>
            <span class="o">&lt;</span><span class="nx">Text</span><span class="o">&gt;</span><span class="nx">Face</span> <span class="nx">Mash</span><span class="o">&lt;</span><span class="err">/Text&gt;</span>
          <span class="o">&lt;</span><span class="err">/View&gt;</span>
        <span class="o">&lt;</span><span class="err">/TabBarIOS.Item&gt;</span>
        <span class="o">&lt;</span><span class="nx">TabBarIOS</span><span class="p">.</span><span class="nx">Item</span>
          <span class="nx">title</span><span class="o">=</span><span class="s2">&quot;Messages&quot;</span>
          <span class="nx">icon</span><span class="o">=</span><span class="p">{</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;image!messages&#39;</span><span class="p">)</span> <span class="p">}</span>
          <span class="nx">selected</span><span class="o">=</span><span class="p">{</span> <span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">selectedTab</span> <span class="o">===</span> <span class="s1">&#39;messages&#39;</span> <span class="p">}</span><span class="o">&gt;</span>
          <span class="o">&lt;</span><span class="nx">View</span> <span class="nx">style</span><span class="o">=</span><span class="p">{</span> <span class="nx">styles</span><span class="p">.</span><span class="nx">pageView</span> <span class="p">}</span><span class="o">&gt;</span>
            <span class="o">&lt;</span><span class="nx">Text</span><span class="o">&gt;</span><span class="nx">Messages</span><span class="o">&lt;</span><span class="err">/Text&gt;</span>
          <span class="o">&lt;</span><span class="err">/View&gt;</span>
        <span class="o">&lt;</span><span class="err">/TabBarIOS.Item&gt;</span>
        <span class="o">&lt;</span><span class="nx">TabBarIOS</span><span class="p">.</span><span class="nx">Item</span>
          <span class="nx">title</span><span class="o">=</span><span class="s2">&quot;Settings&quot;</span>
          <span class="nx">icon</span><span class="o">=</span><span class="p">{</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;image!settings&#39;</span><span class="p">)</span> <span class="p">}</span>
          <span class="nx">selected</span><span class="o">=</span><span class="p">{</span> <span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">selectedTab</span> <span class="o">===</span> <span class="s1">&#39;settings&#39;</span> <span class="p">}</span><span class="o">&gt;</span>
          <span class="o">&lt;</span><span class="nx">View</span> <span class="nx">style</span><span class="o">=</span><span class="p">{</span> <span class="nx">styles</span><span class="p">.</span><span class="nx">pageView</span> <span class="p">}</span><span class="o">&gt;</span>
            <span class="o">&lt;</span><span class="nx">Text</span><span class="o">&gt;</span><span class="nx">Settings</span><span class="o">&lt;</span><span class="err">/Text&gt;</span>
          <span class="o">&lt;</span><span class="err">/View&gt;</span>
        <span class="o">&lt;</span><span class="err">/TabBarIOS.Item&gt;</span>
      <span class="o">&lt;</span><span class="err">/TabBarIOS&gt;</span>
    <span class="p">);</span>
  <span class="p">}</span>
<span class="p">});</span>

<span class="kd">var</span> <span class="nx">styles</span> <span class="o">=</span> <span class="nx">StyleSheet</span><span class="p">.</span><span class="nx">create</span><span class="p">({</span>
  <span class="nx">pageView</span><span class="o">:</span> <span class="p">{</span>
    <span class="nx">backgroundColor</span><span class="o">:</span> <span class="s1">&#39;#fff&#39;</span><span class="p">,</span>
    <span class="nx">flex</span><span class="o">:</span> <span class="mi">1</span>
  <span class="p">}</span>
<span class="p">});</span>

<span class="c1">// omitted code</span>
</pre></div>
</td></tr></table>

</div>

<div style="text-align: center">
    <a href="/img/going-native-with-react/tabs.png" target="_blank"><img src="/img/going-native-with-react/tabs.png" /></a>
</div>

<p>Look at that! You’ll notice that the text is currently over the status bar, but don’t worry, we’ll fix that later on.</p>

<p>The <code>TabBarIOS</code> component uses <code>TabBarIOS.Item</code> for each of its children. We’re going to have three pages - the page where you rate people, a messages list and a settings page.</p>

<p>The <code>TabBarIOS.Item</code> must have one child. This will be the contents of the page that has been selected (you can see us setting selected to true/false depending on the state of the component).</p>

<p>Obviously, a tab bar wouldn’t look good without icons. There are a few system icons you can use, however if you use them the text of the tab also changes to match the icon. Instead, we can use our own icons. To import a local image asset in React Native, you can use <code>require</code> and prepend the asset name with <code>image!</code>.</p>

<p>I’m using icons that are available free, under the CC 3.0 licence, from <a href="http://www.flaticon.com/" target="_blank">flaticon</a>.</p>

<h5 id="using-static-images">Using Static Images</h5>

<p>To add a static image for React Native, open up XCode. In the Project Navigator (the first icon on the left hand pane), open up <code>Images.xcassets</code>. All your images will sit here.</p>

<p>This allows us to keep all our assets under one name, whilst providing different images for both each resolution, and even device specific images.</p>

<p>Images must follow a strict naming convention. Use the asset name (such as <code>messages</code> or <code>settings</code>) and append it with the resolution it should be displayed at. For instance, I’m building my application for an iPhone 6 so I would use the <code>@2x</code> resolution.</p>

<p>Once you’ve named your image file correctly, drag and drop it into the left hand page in <code>Images.xcassets</code>.</p>

<p><a href="/img/going-native-with-react/adding-images.png" target="_blank"><img src="/img/going-native-with-react/adding-images.png" /></a></p>

<p>You can then use <code>require('image!assetname')</code> in React Native!</p>

<h4 id="back-to-the-code">Back to the code</h4>

<p>The next logical step is to set up our main component to allow switching between tabs. We can do this by just setting the state when the user clicks on it. <code>TabBarIOS.Item</code> allows us to give it an <code>onPress</code> property, which we can use to detect when a user taps on the tab.</p>

<div class="file-name">
  <span class="file-name__file">
    <i class="fa fa-file-code-o"></i>
    index.ios.js
  </span>
</div>
<div class="code-block">

<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><code class="language-js" data-lang="js"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49</code></pre></div></td><td class="code"><div class="highlight"><pre><span class="c1">// omitted code</span>

<span class="kd">var</span> <span class="nx">facemash</span> <span class="o">=</span> <span class="nx">React</span><span class="p">.</span><span class="nx">createClass</span><span class="p">({</span>
  <span class="nx">getInitialState</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="p">{</span>
      <span class="nx">selectedTab</span><span class="o">:</span> <span class="s1">&#39;faceMash&#39;</span>
    <span class="p">}</span>
  <span class="p">},</span>
  <span class="nx">changeTab</span><span class="p">(</span><span class="nx">tabName</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">setState</span><span class="p">({</span>
      <span class="nx">selectedTab</span><span class="o">:</span> <span class="nx">tabName</span>
    <span class="p">});</span>
  <span class="p">},</span>
  <span class="nx">render</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="p">(</span>
      <span class="o">&lt;</span><span class="nx">TabBarIOS</span><span class="o">&gt;</span>
        <span class="o">&lt;</span><span class="nx">TabBarIOS</span><span class="p">.</span><span class="nx">Item</span>
          <span class="nx">title</span><span class="o">=</span><span class="s2">&quot;FaceMash&quot;</span>
          <span class="nx">icon</span><span class="o">=</span><span class="p">{</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;image!facemash&#39;</span><span class="p">)</span> <span class="p">}</span>
          <span class="nx">onPress</span><span class="o">=</span><span class="p">{</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="k">this</span><span class="p">.</span><span class="nx">changeTab</span><span class="p">(</span><span class="s1">&#39;faceMash&#39;</span><span class="p">)</span> <span class="p">}</span>
          <span class="nx">selected</span><span class="o">=</span><span class="p">{</span> <span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">selectedTab</span> <span class="o">===</span> <span class="s1">&#39;faceMash&#39;</span> <span class="p">}</span><span class="o">&gt;</span>
          <span class="o">&lt;</span><span class="nx">View</span> <span class="nx">style</span><span class="o">=</span><span class="p">{</span> <span class="nx">styles</span><span class="p">.</span><span class="nx">pageView</span> <span class="p">}</span><span class="o">&gt;</span>
            <span class="o">&lt;</span><span class="nx">Text</span><span class="o">&gt;</span><span class="nx">Face</span> <span class="nx">Mash</span><span class="o">&lt;</span><span class="err">/Text&gt;</span>
          <span class="o">&lt;</span><span class="err">/View&gt;</span>
        <span class="o">&lt;</span><span class="err">/TabBarIOS.Item&gt;</span>
        <span class="o">&lt;</span><span class="nx">TabBarIOS</span><span class="p">.</span><span class="nx">Item</span>
          <span class="nx">title</span><span class="o">=</span><span class="s2">&quot;Messages&quot;</span>
          <span class="nx">icon</span><span class="o">=</span><span class="p">{</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;image!messages&#39;</span><span class="p">)</span> <span class="p">}</span>
          <span class="nx">onPress</span><span class="o">=</span><span class="p">{</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="k">this</span><span class="p">.</span><span class="nx">changeTab</span><span class="p">(</span><span class="s1">&#39;messages&#39;</span><span class="p">)</span> <span class="p">}</span>
          <span class="nx">selected</span><span class="o">=</span><span class="p">{</span> <span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">selectedTab</span> <span class="o">===</span> <span class="s1">&#39;messages&#39;</span> <span class="p">}</span><span class="o">&gt;</span>
          <span class="o">&lt;</span><span class="nx">View</span> <span class="nx">style</span><span class="o">=</span><span class="p">{</span> <span class="nx">styles</span><span class="p">.</span><span class="nx">pageView</span> <span class="p">}</span><span class="o">&gt;</span>
            <span class="o">&lt;</span><span class="nx">Text</span><span class="o">&gt;</span><span class="nx">Messages</span><span class="o">&lt;</span><span class="err">/Text&gt;</span>
          <span class="o">&lt;</span><span class="err">/View&gt;</span>
        <span class="o">&lt;</span><span class="err">/TabBarIOS.Item&gt;</span>
        <span class="o">&lt;</span><span class="nx">TabBarIOS</span><span class="p">.</span><span class="nx">Item</span>
          <span class="nx">title</span><span class="o">=</span><span class="s2">&quot;Settings&quot;</span>
          <span class="nx">icon</span><span class="o">=</span><span class="p">{</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;image!settings&#39;</span><span class="p">)</span> <span class="p">}</span>
          <span class="nx">onPress</span><span class="o">=</span><span class="p">{</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="k">this</span><span class="p">.</span><span class="nx">changeTab</span><span class="p">(</span><span class="s1">&#39;settings&#39;</span><span class="p">)</span> <span class="p">}</span>
          <span class="nx">selected</span><span class="o">=</span><span class="p">{</span> <span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">selectedTab</span> <span class="o">===</span> <span class="s1">&#39;settings&#39;</span> <span class="p">}</span><span class="o">&gt;</span>
          <span class="o">&lt;</span><span class="nx">View</span> <span class="nx">style</span><span class="o">=</span><span class="p">{</span> <span class="nx">styles</span><span class="p">.</span><span class="nx">pageView</span> <span class="p">}</span><span class="o">&gt;</span>
            <span class="o">&lt;</span><span class="nx">Text</span><span class="o">&gt;</span><span class="nx">Settings</span><span class="o">&lt;</span><span class="err">/Text&gt;</span>
          <span class="o">&lt;</span><span class="err">/View&gt;</span>
        <span class="o">&lt;</span><span class="err">/TabBarIOS.Item&gt;</span>
      <span class="o">&lt;</span><span class="err">/TabBarIOS&gt;</span>
    <span class="p">);</span>
  <span class="p">}</span>
<span class="p">});</span>

<span class="c1">// omitted code</span>
</pre></div>
</td></tr></table>

</div>

<div style="text-align: center">
    <a href="/img/going-native-with-react/tabs-changed.png" target="_blank"><img src="/img/going-native-with-react/tabs-changed.png" /></a>
</div>

<p>Done! It’s that simple. Refresh your app by pressing <code>Command + R</code> in the iOS simulator (or recompile it via XCode if you’re developing on your device) and you’ll notice we can now tap between tabs, and the screen changes!</p>

<p>Although we haven’t written much code, you can check out the <code>step-one</code> branch, which also contains all the icons we’ve used for the tabs.</p>

<h2 id="lets-mash">Let’s Mash</h2>

<p>Let’s work on the FaceMash tab. We’re going to hit an endpoint to load our data using <code>fetch</code>. In the <code>step-one</code> branch, I’ve included a <code>config.yaml</code> file in the <code>rest/</code> folder that we’re going to use to mock our endpoints using <a href="http://stub.by/" target="_blank">stubby</a>. All the users in the endpoint/pictures were randomly generated at <a href="https://randomuser.me/" target="_blank">randomuser.me</a>.</p>

<p>Open up your terminal and run</p>

<div class="code-block code-block--no-linenos">

<div class="highlight"><pre><code class="language-bash" data-lang="bash">stubby -d rest/config.yaml</code></pre></div>

</div>

<p>And let’s get started!</p>

<p>Create a new file in the folder named <code>tabs/</code> called <code>FaceMash.js</code> and stick a basic React component in there -</p>

<div class="file-name">
  <span class="file-name__folder">
    <i class="fa fa-folder-o"></i>
    tabs
  </span>
  <span class="file-name__file">
    <i class="fa fa-file-code-o"></i>
    FaceMash.js
  </span>
</div>
<div class="code-block">

<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><code class="language-js" data-lang="js"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29</code></pre></div></td><td class="code"><div class="highlight"><pre><span class="s1">&#39;use strict&#39;</span><span class="p">;</span>

<span class="kd">var</span> <span class="nx">React</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;react-native&#39;</span><span class="p">);</span>
<span class="kd">var</span> <span class="p">{</span>
  <span class="nx">StyleSheet</span><span class="p">,</span>
  <span class="nx">Text</span><span class="p">,</span>
  <span class="nx">View</span>
  <span class="p">}</span> <span class="o">=</span> <span class="nx">React</span><span class="p">;</span>

<span class="kd">var</span> <span class="nx">facemashTab</span> <span class="o">=</span> <span class="nx">React</span><span class="p">.</span><span class="nx">createClass</span><span class="p">({</span>
  <span class="nx">render</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="p">(</span>
      <span class="o">&lt;</span><span class="nx">View</span> <span class="nx">style</span><span class="o">=</span><span class="p">{</span> <span class="nx">styles</span><span class="p">.</span><span class="nx">container</span> <span class="p">}</span><span class="o">&gt;</span>
        <span class="o">&lt;</span><span class="nx">Text</span><span class="o">&gt;</span>
          <span class="nx">FaceMash</span> <span class="nx">tab</span><span class="o">!</span>
        <span class="o">&lt;</span><span class="err">/Text&gt;</span>
      <span class="o">&lt;</span><span class="err">/View&gt;</span>
    <span class="p">);</span>
  <span class="p">}</span>
<span class="p">});</span>

<span class="kd">var</span> <span class="nx">styles</span> <span class="o">=</span> <span class="nx">StyleSheet</span><span class="p">.</span><span class="nx">create</span><span class="p">({</span>
  <span class="nx">container</span><span class="o">:</span> <span class="p">{</span>
    <span class="nx">flex</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="nx">backgroundColor</span><span class="o">:</span> <span class="s1">&#39;#fff&#39;</span>
  <span class="p">}</span>
<span class="p">});</span>

<span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="nx">facemashTab</span><span class="p">;</span>
</pre></div>
</td></tr></table>

</div>

<p>All we’ve got on this tab so far is a basic <code>View</code> component with some text inside of it. We’ve also got some basic styling for the <code>View</code>, to make sure that it takes up all available height/width. We’re going to add a header, purely for display purposes.</p>

<div class="file-name">
  <span class="file-name__folder">
    <i class="fa fa-folder-o"></i>
    tabs
  </span>
  <span class="file-name__file">
    <i class="fa fa-file-code-o"></i>
    FaceMash.js
  </span>
</div>
<div class="code-block">

<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><code class="language-js" data-lang="js"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30</code></pre></div></td><td class="code"><div class="highlight"><pre><span class="c1">// omitted code</span>

<span class="kd">var</span> <span class="nx">facemashTab</span> <span class="o">=</span> <span class="nx">React</span><span class="p">.</span><span class="nx">createClass</span><span class="p">({</span>
  <span class="nx">render</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="p">(</span>
      <span class="o">&lt;</span><span class="nx">View</span> <span class="nx">style</span><span class="o">=</span><span class="p">{</span> <span class="nx">styles</span><span class="p">.</span><span class="nx">container</span> <span class="p">}</span><span class="o">&gt;</span>
        <span class="o">&lt;</span><span class="nx">View</span> <span class="nx">style</span><span class="o">=</span><span class="p">{</span> <span class="nx">styles</span><span class="p">.</span><span class="nx">header</span> <span class="p">}</span><span class="o">&gt;</span>
        <span class="o">&lt;</span><span class="err">/View&gt;</span>
        <span class="o">&lt;</span><span class="nx">View</span> <span class="nx">style</span><span class="o">=</span><span class="p">{</span> <span class="nx">styles</span><span class="p">.</span><span class="nx">content</span> <span class="p">}</span><span class="o">&gt;</span>
          <span class="o">&lt;</span><span class="nx">Text</span><span class="o">&gt;</span>
            <span class="nx">FaceMash</span> <span class="nx">tab</span><span class="o">!</span>
          <span class="o">&lt;</span><span class="err">/Text&gt;</span>
        <span class="o">&lt;</span><span class="err">/View&gt;</span>
      <span class="o">&lt;</span><span class="err">/View&gt;</span>
    <span class="p">);</span>
  <span class="p">}</span>
<span class="p">});</span>

<span class="kd">var</span> <span class="nx">styles</span> <span class="o">=</span> <span class="nx">StyleSheet</span><span class="p">.</span><span class="nx">create</span><span class="p">({</span>
  <span class="nx">container</span><span class="o">:</span> <span class="p">{</span>
    <span class="nx">flex</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="nx">backgroundColor</span><span class="o">:</span> <span class="s1">&#39;#fff&#39;</span>
  <span class="p">},</span>
  <span class="nx">header</span><span class="o">:</span> <span class="p">{</span>
    <span class="nx">height</span><span class="o">:</span> <span class="mi">40</span><span class="p">,</span>
    <span class="nx">background</span><span class="o">:</span> <span class="s1">&#39;#ff0000&#39;</span>
  <span class="p">}</span>
<span class="p">});</span>

<span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="nx">facemashTab</span><span class="p">;</span>
</pre></div>
</td></tr></table>

</div>

<div style="text-align: center">
    <a href="/img/going-native-with-react/facemash-header.png" target="_blank"><img src="/img/going-native-with-react/facemash-header.png" /></a>
</div>

<p>Now we’re talking. However, this looks terrible as the status bar is black. Not to worry, we can change that using the <code>StatusBarIOS</code> API. When the <code>changeTab</code> function is called, we can check if the tab is the FaceMash tab. If it is, we’ll set the status bar style to <code>1</code> (white), if not we’ll set it to <code>0</code> (black).</p>

<div class="file-name">
  <span class="file-name__file">
    <i class="fa fa-file-code-o"></i>
    index.ios.js
  </span>
</div>
<div class="code-block">

<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><code class="language-js" data-lang="js"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23</code></pre></div></td><td class="code"><div class="highlight"><pre><span class="c1">// omitted code</span>

<span class="kd">var</span> <span class="p">{</span>
  <span class="nx">AppRegistry</span><span class="p">,</span>
  <span class="nx">StyleSheet</span><span class="p">,</span>
  <span class="nx">Text</span><span class="p">,</span>
  <span class="nx">View</span><span class="p">,</span>
  <span class="nx">TabBarIOS</span><span class="p">,</span>
  <span class="nx">StatusBarIOS</span>
<span class="p">}</span> <span class="o">=</span> <span class="nx">React</span><span class="p">;</span>

<span class="kd">var</span> <span class="nx">facemash</span> <span class="o">=</span> <span class="nx">React</span><span class="p">.</span><span class="nx">createClass</span><span class="p">({</span>
  <span class="p">...,</span>
  <span class="nx">changeTab</span><span class="p">(</span><span class="nx">tabName</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">StatusBarIOS</span><span class="p">.</span><span class="nx">setStyle</span><span class="p">(</span><span class="nx">tabName</span> <span class="o">===</span> <span class="s1">&#39;faceMash&#39;</span> <span class="o">?</span> <span class="mi">1</span> <span class="o">:</span> <span class="mi">0</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">setState</span><span class="p">({</span>
      <span class="nx">selectedTab</span><span class="o">:</span> <span class="nx">tabName</span>
    <span class="p">});</span>
  <span class="p">},</span>
  <span class="p">...</span>
<span class="p">});</span>

<span class="c1">// omitted code</span>
</pre></div>
</td></tr></table>

</div>

<p>Refresh and you’ll see a white status bar - sorted!</p>

<p>We can now get to hitting the endpoint and displaying our users. We’ll be using <a href="https://github.com/github/fetch" target="_blank">fetch</a>, which is included for us in React Native by default.</p>

<div class="file-name">
  <span class="file-name__folder">
    <i class="fa fa-folder-o"></i>
    tabs
  </span>
  <span class="file-name__file">
    <i class="fa fa-file-code-o"></i>
    FaceMash.js
  </span>
</div>
<div class="code-block">

<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><code class="language-js" data-lang="js"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22</code></pre></div></td><td class="code"><div class="highlight"><pre><span class="c1">// omitted code</span>

<span class="kd">var</span> <span class="nx">facemashTab</span> <span class="o">=</span> <span class="nx">React</span><span class="p">.</span><span class="nx">createClass</span><span class="p">({</span>
  <span class="nx">getInitialState</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="p">{</span>
      <span class="nx">list</span><span class="o">:</span> <span class="p">[],</span>
      <span class="nx">currentIndex</span><span class="o">:</span> <span class="mi">0</span>
    <span class="p">};</span>
  <span class="p">},</span>
  <span class="nx">componentWillMount</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">fetch</span><span class="p">(</span><span class="s1">&#39;http://localhost:8882/rest/mash&#39;</span><span class="p">)</span>
      <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="nx">res</span> <span class="o">=&gt;</span> <span class="nx">res</span><span class="p">.</span><span class="nx">json</span><span class="p">())</span>
      <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="nx">res</span> <span class="o">=&gt;</span> <span class="k">this</span><span class="p">.</span><span class="nx">setState</span><span class="p">({</span> <span class="nx">list</span><span class="o">:</span> <span class="nx">res</span> <span class="p">}));</span>
  <span class="p">},</span>
  <span class="nx">render</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="p">(</span>
      <span class="p">...</span>
    <span class="p">);</span>
  <span class="p">}</span>
<span class="p">});</span>

<span class="c1">// omitted code</span>
</pre></div>
</td></tr></table>

</div>

<p>The request will populate our state with the returned data. As the initial state is an empty array, we can check that in our <code>render</code> function and show the user a loading page whilst they wait.</p>

<div class="file-name">
  <span class="file-name__folder">
    <i class="fa fa-folder-o"></i>
    tabs
  </span>
  <span class="file-name__file">
    <i class="fa fa-file-code-o"></i>
    FaceMash.js
  </span>
</div>
<div class="code-block">

<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><code class="language-js" data-lang="js"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64</code></pre></div></td><td class="code"><div class="highlight"><pre><span class="kd">var</span> <span class="p">{</span>
  <span class="nx">StyleSheet</span><span class="p">,</span>
  <span class="nx">Text</span><span class="p">,</span>
  <span class="nx">View</span><span class="p">,</span>
  <span class="nx">ActivityIndicatorIOS</span>
  <span class="p">}</span> <span class="o">=</span> <span class="nx">React</span><span class="p">;</span>

<span class="kd">var</span> <span class="nx">facemashTab</span> <span class="o">=</span> <span class="nx">React</span><span class="p">.</span><span class="nx">createClass</span><span class="p">({</span>
  <span class="p">...,</span>
  <span class="nx">render</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">contents</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">list</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">contents</span> <span class="o">=</span> <span class="p">(</span>
        <span class="o">&lt;</span><span class="nx">View</span> <span class="nx">style</span><span class="o">=</span><span class="p">{</span> <span class="nx">styles</span><span class="p">.</span><span class="nx">loading</span> <span class="p">}</span><span class="o">&gt;</span>
          <span class="o">&lt;</span><span class="nx">Text</span> <span class="nx">style</span><span class="o">=</span><span class="p">{</span> <span class="nx">styles</span><span class="p">.</span><span class="nx">loadingText</span> <span class="p">}</span><span class="o">&gt;</span><span class="nx">Loading</span><span class="o">&lt;</span><span class="err">/Text&gt;</span>
          <span class="o">&lt;</span><span class="nx">ActivityIndicatorIOS</span> <span class="o">/&gt;</span>
        <span class="o">&lt;</span><span class="err">/View&gt;</span>
      <span class="p">)</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
      <span class="nx">contents</span> <span class="o">=</span> <span class="p">(</span>
        <span class="o">&lt;</span><span class="nx">View</span> <span class="nx">style</span><span class="o">=</span><span class="p">{</span> <span class="nx">styles</span><span class="p">.</span><span class="nx">content</span> <span class="p">}</span><span class="o">&gt;</span>
          <span class="o">&lt;</span><span class="nx">Text</span><span class="o">&gt;</span><span class="nx">Loaded</span><span class="o">&lt;</span><span class="err">/Text&gt;</span>
        <span class="o">&lt;</span><span class="err">/View&gt;</span>
      <span class="p">)</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="p">(</span>
      <span class="o">&lt;</span><span class="nx">View</span> <span class="nx">style</span><span class="o">=</span><span class="p">{</span> <span class="nx">styles</span><span class="p">.</span><span class="nx">container</span> <span class="p">}</span><span class="o">&gt;</span>
        <span class="o">&lt;</span><span class="nx">View</span> <span class="nx">style</span><span class="o">=</span><span class="p">{</span> <span class="nx">styles</span><span class="p">.</span><span class="nx">header</span> <span class="p">}</span><span class="o">&gt;</span>
          <span class="o">&lt;</span><span class="nx">Text</span> <span class="nx">style</span><span class="o">=</span><span class="p">{</span> <span class="nx">styles</span><span class="p">.</span><span class="nx">headerText</span> <span class="p">}</span><span class="o">&gt;</span><span class="nx">FaceMash</span><span class="o">&lt;</span><span class="err">/Text&gt;</span>
        <span class="o">&lt;</span><span class="err">/View&gt;</span>
        <span class="p">{</span> <span class="nx">contents</span> <span class="p">}</span>
      <span class="o">&lt;</span><span class="err">/View&gt;</span>
    <span class="p">);</span>
  <span class="p">}</span>
<span class="p">});</span>

<span class="kd">var</span> <span class="nx">styles</span> <span class="o">=</span> <span class="nx">StyleSheet</span><span class="p">.</span><span class="nx">create</span><span class="p">({</span>
  <span class="nx">container</span><span class="o">:</span> <span class="p">{</span>
    <span class="nx">flex</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="nx">backgroundColor</span><span class="o">:</span> <span class="s1">&#39;#fff&#39;</span>
  <span class="p">},</span>
  <span class="nx">loading</span><span class="o">:</span> <span class="p">{</span>
    <span class="nx">flex</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="nx">backgroundColor</span><span class="o">:</span> <span class="s1">&#39;#fff&#39;</span><span class="p">,</span>
    <span class="nx">justifyContent</span><span class="o">:</span> <span class="s1">&#39;center&#39;</span><span class="p">,</span>
    <span class="nx">alignItems</span><span class="o">:</span> <span class="s1">&#39;center&#39;</span>
  <span class="p">},</span>
  <span class="nx">loadingText</span><span class="o">:</span> <span class="p">{</span>
    <span class="nx">fontSize</span><span class="o">:</span> <span class="mi">14</span><span class="p">,</span>
    <span class="nx">marginBottom</span><span class="o">:</span> <span class="mi">20</span>
  <span class="p">},</span>
  <span class="nx">header</span><span class="o">:</span> <span class="p">{</span>
    <span class="nx">height</span><span class="o">:</span> <span class="mi">50</span><span class="p">,</span>
    <span class="nx">backgroundColor</span><span class="o">:</span> <span class="s1">&#39;#760004&#39;</span><span class="p">,</span>
    <span class="nx">paddingTop</span><span class="o">:</span> <span class="mi">20</span><span class="p">,</span>
    <span class="nx">alignItems</span><span class="o">:</span> <span class="s1">&#39;center&#39;</span>
  <span class="p">},</span>
  <span class="nx">headerText</span><span class="o">:</span> <span class="p">{</span>
    <span class="nx">color</span><span class="o">:</span> <span class="s1">&#39;#fff&#39;</span><span class="p">,</span>
    <span class="nx">fontSize</span><span class="o">:</span> <span class="mi">20</span><span class="p">,</span>
    <span class="nx">fontWeight</span><span class="o">:</span> <span class="s1">&#39;bold&#39;</span>
  <span class="p">}</span>
<span class="p">});</span>
</pre></div>
</td></tr></table>

</div>

<div style="text-align: center">
    <a href="/img/going-native-with-react/facemash-loading.png" target="_blank"><img src="/img/going-native-with-react/facemash-loading.png" /></a>
    <a href="/img/going-native-with-react/facemash-loaded.png" target="_blank"><img src="/img/going-native-with-react/facemash-loaded.png" /></a>
</div>

<p>We will now have access to our data in <code>this.state.list</code>. We’ve also got what current index of that array we’re at in the state as the endpoint returns an array of objects - each object being two people that the user can rate.</p>

<p>As there are two people to pick from, both of which have the same data associated with them, we’re going to make a React component that will display their data.</p>

<div class="file-name">
  <span class="file-name__folder">
    <i class="fa fa-folder-o"></i>
    tabs
  </span>
  <span class="file-name__file">
    <i class="fa fa-file-code-o"></i>
    FaceMash.js
  </span>
</div>
<div class="code-block">

<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><code class="language-js" data-lang="js"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69</code></pre></div></td><td class="code"><div class="highlight"><pre><span class="c1">// omitted code</span>

<span class="kd">var</span> <span class="nx">Person</span> <span class="o">=</span> <span class="nx">React</span><span class="p">.</span><span class="nx">createClass</span><span class="p">({</span>
  <span class="nx">render</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">person</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">person</span><span class="p">;</span>

    <span class="k">return</span> <span class="p">(</span>
      <span class="o">&lt;</span><span class="nx">View</span> <span class="nx">style</span><span class="o">=</span><span class="p">{</span> <span class="nx">styles</span><span class="p">.</span><span class="nx">person</span> <span class="p">}</span><span class="o">&gt;</span>
        <span class="o">&lt;</span><span class="nx">Text</span><span class="o">&gt;</span><span class="nx">Person</span><span class="o">!&lt;</span><span class="err">/Text&gt;</span>
      <span class="o">&lt;</span><span class="err">/View&gt;</span>
    <span class="p">)</span>
  <span class="p">}</span>
<span class="p">});</span>

<span class="kd">var</span> <span class="nx">facemashTab</span> <span class="o">=</span> <span class="nx">React</span><span class="p">.</span><span class="nx">createClass</span><span class="p">({</span>
  <span class="nx">getInitialState</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="p">{</span>
      <span class="nx">list</span><span class="o">:</span> <span class="p">[],</span>
      <span class="nx">currentIndex</span><span class="o">:</span> <span class="mi">0</span>
    <span class="p">};</span>
  <span class="p">},</span>
  <span class="nx">componentWillMount</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">fetch</span><span class="p">(</span><span class="s1">&#39;http://localhost:8882/rest/mash&#39;</span><span class="p">)</span>
      <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="nx">res</span> <span class="o">=&gt;</span> <span class="nx">res</span><span class="p">.</span><span class="nx">json</span><span class="p">())</span>
      <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="nx">res</span> <span class="o">=&gt;</span> <span class="k">this</span><span class="p">.</span><span class="nx">setState</span><span class="p">({</span> <span class="nx">list</span><span class="o">:</span> <span class="nx">res</span> <span class="p">}));</span>
  <span class="p">},</span>
  <span class="nx">render</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">contents</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">list</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">contents</span> <span class="o">=</span> <span class="p">(</span>
        <span class="o">&lt;</span><span class="nx">View</span> <span class="nx">style</span><span class="o">=</span><span class="p">{</span> <span class="nx">styles</span><span class="p">.</span><span class="nx">loading</span> <span class="p">}</span><span class="o">&gt;</span>
          <span class="o">&lt;</span><span class="nx">Text</span> <span class="nx">style</span><span class="o">=</span><span class="p">{</span> <span class="nx">styles</span><span class="p">.</span><span class="nx">loadingText</span> <span class="p">}</span><span class="o">&gt;</span><span class="nx">Loading</span><span class="o">&lt;</span><span class="err">/Text&gt;</span>
          <span class="o">&lt;</span><span class="nx">ActivityIndicatorIOS</span> <span class="o">/&gt;</span>
        <span class="o">&lt;</span><span class="err">/View&gt;</span>
      <span class="p">)</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
      <span class="kd">var</span> <span class="p">{</span> <span class="nx">list</span><span class="p">,</span> <span class="nx">currentIndex</span> <span class="p">}</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">;</span>

      <span class="kd">var</span> <span class="nx">record</span> <span class="o">=</span> <span class="nx">list</span><span class="p">[</span><span class="nx">currentIndex</span><span class="p">];</span>

      <span class="kd">var</span> <span class="nx">people</span> <span class="o">=</span> <span class="nx">record</span><span class="p">.</span><span class="nx">users</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nx">person</span> <span class="o">=&gt;</span> <span class="o">&lt;</span><span class="nx">Person</span> <span class="nx">person</span><span class="o">=</span><span class="p">{</span> <span class="nx">person</span> <span class="p">}</span> <span class="o">/&gt;</span><span class="p">);</span>

      <span class="nx">contents</span> <span class="o">=</span> <span class="p">(</span>
        <span class="o">&lt;</span><span class="nx">View</span> <span class="nx">style</span><span class="o">=</span><span class="p">{</span> <span class="nx">styles</span><span class="p">.</span><span class="nx">content</span> <span class="p">}</span><span class="o">&gt;</span>
          <span class="p">{</span> <span class="nx">people</span> <span class="p">}</span>
        <span class="o">&lt;</span><span class="err">/View&gt;</span>
      <span class="p">)</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="p">(</span>
      <span class="o">&lt;</span><span class="nx">View</span> <span class="nx">style</span><span class="o">=</span><span class="p">{</span> <span class="nx">styles</span><span class="p">.</span><span class="nx">container</span> <span class="p">}</span><span class="o">&gt;</span>
        <span class="o">&lt;</span><span class="nx">View</span> <span class="nx">style</span><span class="o">=</span><span class="p">{</span> <span class="nx">styles</span><span class="p">.</span><span class="nx">header</span> <span class="p">}</span><span class="o">&gt;</span>
          <span class="o">&lt;</span><span class="nx">Text</span> <span class="nx">style</span><span class="o">=</span><span class="p">{</span> <span class="nx">styles</span><span class="p">.</span><span class="nx">headerText</span> <span class="p">}</span><span class="o">&gt;</span><span class="nx">FaceMash</span><span class="o">&lt;</span><span class="err">/Text&gt;</span>
        <span class="o">&lt;</span><span class="err">/View&gt;</span>
        <span class="p">{</span> <span class="nx">contents</span> <span class="p">}</span>
      <span class="o">&lt;</span><span class="err">/View&gt;</span>
    <span class="p">);</span>
  <span class="p">}</span>
<span class="p">});</span>

<span class="kd">var</span> <span class="nx">styles</span> <span class="o">=</span> <span class="nx">StyleSheet</span><span class="p">.</span><span class="nx">create</span><span class="p">({</span>
  <span class="p">...,</span>
  <span class="nx">person</span><span class="o">:</span> <span class="p">{</span>
    <span class="nx">flex</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="nx">margin</span><span class="o">:</span> <span class="mi">10</span><span class="p">,</span>
    <span class="nx">borderRadius</span><span class="o">:</span> <span class="mi">3</span><span class="p">,</span>
    <span class="nx">overflow</span><span class="o">:</span> <span class="s1">&#39;hidden&#39;</span>
  <span class="p">}</span>
<span class="p">});</span>
</pre></div>
</td></tr></table>

</div>

<p>We’ve now got a component that mounts twice (once for each person), and the appropriate configuration passed through to it. We can now display the profile picture and the relevant user info.</p>

<h4 id="displaying-external-images">Displaying external images</h4>

<p>Unlike our tab icons, the images we are displaying for each user come from an external source. This isn’t a problem, in fact it’s even easier to display them than displaying static assets.</p>

<p>Instead of passing a <code>require</code>‘d image through to the Image component, we just pass through an object instead. This object will have one property - <code>uri</code>, which points to the image we want to load.</p>

<p>As we’ve passed through the user information as a property named <code>person</code>, we can access the image URL via <code>this.props.person.picture</code>.</p>

<div class="file-name">
  <span class="file-name__folder">
    <i class="fa fa-folder-o"></i>
    tabs
  </span>
  <span class="file-name__file">
    <i class="fa fa-file-code-o"></i>
    FaceMash.js
  </span>
</div>
<div class="code-block">

<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><code class="language-js" data-lang="js"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32</code></pre></div></td><td class="code"><div class="highlight"><pre><span class="c1">// omitted code</span>

<span class="kd">var</span> <span class="nx">Person</span> <span class="o">=</span> <span class="nx">React</span><span class="p">.</span><span class="nx">createClass</span><span class="p">({</span>
  <span class="nx">render</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">person</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">person</span><span class="p">;</span>

    <span class="k">return</span> <span class="p">(</span>
      <span class="o">&lt;</span><span class="nx">View</span> <span class="nx">style</span><span class="o">=</span><span class="p">{</span> <span class="nx">styles</span><span class="p">.</span><span class="nx">person</span> <span class="p">}</span><span class="o">&gt;</span>
        <span class="o">&lt;</span><span class="nx">Image</span> <span class="nx">style</span><span class="o">=</span><span class="p">{</span> <span class="nx">styles</span><span class="p">.</span><span class="nx">personImage</span> <span class="p">}</span> <span class="nx">source</span><span class="o">=</span><span class="p">{</span> <span class="p">{</span> <span class="nx">uri</span><span class="o">:</span> <span class="nx">person</span><span class="p">.</span><span class="nx">picture</span> <span class="p">}</span> <span class="p">}</span> <span class="o">/&gt;</span>
      <span class="o">&lt;</span><span class="err">/View&gt;</span>
    <span class="p">)</span>
  <span class="p">}</span>
<span class="p">});</span>

<span class="c1">// omitted code</span>

<span class="kd">var</span> <span class="nx">styles</span> <span class="o">=</span> <span class="nx">StyleSheet</span><span class="p">.</span><span class="nx">create</span><span class="p">({</span>
  <span class="p">...</span>
  <span class="nx">person</span><span class="o">:</span> <span class="p">{</span>
    <span class="nx">flex</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="nx">margin</span><span class="o">:</span> <span class="mi">10</span><span class="p">,</span>
    <span class="nx">borderRadius</span><span class="o">:</span> <span class="mi">3</span><span class="p">,</span>
    <span class="nx">overflow</span><span class="o">:</span> <span class="s1">&#39;hidden&#39;</span>
  <span class="p">},</span>
  <span class="nx">personImage</span><span class="o">:</span> <span class="p">{</span>
    <span class="nx">flex</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="nx">height</span><span class="o">:</span> <span class="mi">200</span>
  <span class="p">},</span>
  <span class="p">...</span>
<span class="p">});</span>

<span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="nx">facemashTab</span><span class="p">;</span>
</pre></div>
</td></tr></table>

</div>

<p>There is also some styling needed - resizing images is incredibly easy. Similar CSS properties such as <code>background-size</code> can be applied to images in React Native, but we’re just going to put a height on it, and the image will be resized accordingly.</p>

<p>We can now add the rest of the user information.</p>

<div class="file-name">
  <span class="file-name__folder">
    <i class="fa fa-folder-o"></i>
    tabs
  </span>
  <span class="file-name__file">
    <i class="fa fa-file-code-o"></i>
    FaceMash.js
  </span>
</div>
<div class="code-block">

<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><code class="language-js" data-lang="js"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95</code></pre></div></td><td class="code"><div class="highlight"><pre><span class="c1">// omitted code</span>

<span class="kd">var</span> <span class="nx">Person</span> <span class="o">=</span> <span class="nx">React</span><span class="p">.</span><span class="nx">createClass</span><span class="p">({</span>
  <span class="nx">render</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">person</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">person</span><span class="p">;</span>

    <span class="k">return</span> <span class="p">(</span>
      <span class="o">&lt;</span><span class="nx">View</span> <span class="nx">style</span><span class="o">=</span><span class="p">{</span> <span class="nx">styles</span><span class="p">.</span><span class="nx">person</span> <span class="p">}</span><span class="o">&gt;</span>
        <span class="o">&lt;</span><span class="nx">Image</span> <span class="nx">style</span><span class="o">=</span><span class="p">{</span> <span class="nx">styles</span><span class="p">.</span><span class="nx">personImage</span> <span class="p">}</span> <span class="nx">source</span><span class="o">=</span><span class="p">{</span> <span class="p">{</span> <span class="nx">uri</span><span class="o">:</span> <span class="nx">person</span><span class="p">.</span><span class="nx">picture</span> <span class="p">}</span> <span class="p">}</span> <span class="o">/&gt;</span>
        <span class="o">&lt;</span><span class="nx">View</span> <span class="nx">style</span><span class="o">=</span><span class="p">{</span> <span class="nx">styles</span><span class="p">.</span><span class="nx">personInfo</span> <span class="p">}</span><span class="o">&gt;</span>
          <span class="o">&lt;</span><span class="nx">Text</span> <span class="nx">style</span><span class="o">=</span><span class="p">{</span> <span class="nx">styles</span><span class="p">.</span><span class="nx">personName</span> <span class="p">}</span><span class="o">&gt;</span>
            <span class="p">{</span> <span class="nx">person</span><span class="p">.</span><span class="nx">firstName</span> <span class="p">}</span> <span class="p">{</span> <span class="nx">person</span><span class="p">.</span><span class="nx">lastName</span> <span class="p">}</span>
          <span class="o">&lt;</span><span class="err">/Text&gt;</span>
          <span class="o">&lt;</span><span class="nx">View</span> <span class="nx">style</span><span class="o">=</span><span class="p">{</span> <span class="nx">styles</span><span class="p">.</span><span class="nx">personScore</span> <span class="p">}</span><span class="o">&gt;</span>
            <span class="o">&lt;</span><span class="nx">Text</span> <span class="nx">style</span><span class="o">=</span><span class="p">{</span> <span class="nx">styles</span><span class="p">.</span><span class="nx">personScoreHeader</span> <span class="p">}</span><span class="o">&gt;</span>
              <span class="nx">WON</span>
            <span class="o">&lt;</span><span class="err">/Text&gt;</span>
            <span class="o">&lt;</span><span class="nx">Text</span> <span class="nx">style</span><span class="o">=</span><span class="p">{</span> <span class="p">[</span><span class="nx">styles</span><span class="p">.</span><span class="nx">personScoreValue</span><span class="p">,</span> <span class="nx">styles</span><span class="p">.</span><span class="nx">won</span><span class="p">]</span> <span class="p">}</span><span class="o">&gt;</span>
              <span class="p">{</span> <span class="nx">person</span><span class="p">.</span><span class="nx">won</span> <span class="p">}</span>
            <span class="o">&lt;</span><span class="err">/Text&gt;</span>
          <span class="o">&lt;</span><span class="err">/View&gt;</span>
          <span class="o">&lt;</span><span class="nx">View</span> <span class="nx">style</span><span class="o">=</span><span class="p">{</span> <span class="nx">styles</span><span class="p">.</span><span class="nx">personScore</span> <span class="p">}</span><span class="o">&gt;</span>
            <span class="o">&lt;</span><span class="nx">Text</span> <span class="nx">style</span><span class="o">=</span><span class="p">{</span> <span class="nx">styles</span><span class="p">.</span><span class="nx">personScoreHeader</span> <span class="p">}</span><span class="o">&gt;</span>
              <span class="nx">LOST</span>
            <span class="o">&lt;</span><span class="err">/Text&gt;</span>
            <span class="o">&lt;</span><span class="nx">Text</span> <span class="nx">style</span><span class="o">=</span><span class="p">{</span> <span class="p">[</span><span class="nx">styles</span><span class="p">.</span><span class="nx">personScoreValue</span><span class="p">,</span> <span class="nx">styles</span><span class="p">.</span><span class="nx">lost</span><span class="p">]</span> <span class="p">}</span><span class="o">&gt;</span>
              <span class="p">{</span> <span class="nx">person</span><span class="p">.</span><span class="nx">lost</span> <span class="p">}</span>
            <span class="o">&lt;</span><span class="err">/Text&gt;</span>
          <span class="o">&lt;</span><span class="err">/View&gt;</span>
          <span class="o">&lt;</span><span class="nx">View</span> <span class="nx">style</span><span class="o">=</span><span class="p">{</span> <span class="nx">styles</span><span class="p">.</span><span class="nx">personScore</span> <span class="p">}</span><span class="o">&gt;</span>
            <span class="o">&lt;</span><span class="nx">Text</span> <span class="nx">style</span><span class="o">=</span><span class="p">{</span> <span class="nx">styles</span><span class="p">.</span><span class="nx">personScoreHeader</span> <span class="p">}</span><span class="o">&gt;</span>
              <span class="nx">SCORE</span>
            <span class="o">&lt;</span><span class="err">/Text&gt;</span>
            <span class="o">&lt;</span><span class="nx">Text</span> <span class="nx">style</span><span class="o">=</span><span class="p">{</span> <span class="nx">styles</span><span class="p">.</span><span class="nx">personScoreValue</span> <span class="p">}</span><span class="o">&gt;</span>
              <span class="p">{</span> <span class="nx">person</span><span class="p">.</span><span class="nx">score</span> <span class="p">}</span>
            <span class="o">&lt;</span><span class="err">/Text&gt;</span>
          <span class="o">&lt;</span><span class="err">/View&gt;</span>
        <span class="o">&lt;</span><span class="err">/View&gt;</span>
      <span class="o">&lt;</span><span class="err">/View&gt;</span>
    <span class="p">)</span>
  <span class="p">}</span>
<span class="p">});</span>

<span class="c1">// omitted code</span>

<span class="kd">var</span> <span class="nx">styles</span> <span class="o">=</span> <span class="nx">StyleSheet</span><span class="p">.</span><span class="nx">create</span><span class="p">({</span>
  <span class="p">...,</span>
  <span class="nx">person</span><span class="o">:</span> <span class="p">{</span>
    <span class="nx">flex</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="nx">margin</span><span class="o">:</span> <span class="mi">10</span><span class="p">,</span>
    <span class="nx">borderRadius</span><span class="o">:</span> <span class="mi">3</span><span class="p">,</span>
    <span class="nx">overflow</span><span class="o">:</span> <span class="s1">&#39;hidden&#39;</span>
  <span class="p">},</span>
  <span class="nx">personInfo</span><span class="o">:</span> <span class="p">{</span>
    <span class="nx">borderLeftColor</span><span class="o">:</span> <span class="s1">&#39;rgba( 0, 0, 0, 0.1 )&#39;</span><span class="p">,</span>
    <span class="nx">borderLeftWidth</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="nx">borderRightColor</span><span class="o">:</span> <span class="s1">&#39;rgba( 0, 0, 0, 0.1 )&#39;</span><span class="p">,</span>
    <span class="nx">borderRightWidth</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="nx">borderBottomColor</span><span class="o">:</span> <span class="s1">&#39;rgba( 0, 0, 0, 0.1 )&#39;</span><span class="p">,</span>
    <span class="nx">borderBottomWidth</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="nx">padding</span><span class="o">:</span> <span class="mi">10</span><span class="p">,</span>
    <span class="nx">alignItems</span><span class="o">:</span> <span class="s1">&#39;center&#39;</span><span class="p">,</span>
    <span class="nx">flexDirection</span><span class="o">:</span> <span class="s1">&#39;row&#39;</span>
  <span class="p">},</span>
  <span class="nx">personImage</span><span class="o">:</span> <span class="p">{</span>
    <span class="nx">flex</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="nx">height</span><span class="o">:</span> <span class="mi">200</span>
  <span class="p">},</span>
  <span class="nx">personName</span><span class="o">:</span> <span class="p">{</span>
    <span class="nx">fontSize</span><span class="o">:</span> <span class="mi">18</span><span class="p">,</span>
    <span class="nx">flex</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="nx">paddingLeft</span><span class="o">:</span> <span class="mi">5</span>
  <span class="p">},</span>
  <span class="nx">personScore</span><span class="o">:</span> <span class="p">{</span>
    <span class="nx">flex</span><span class="o">:</span> <span class="mf">0.25</span><span class="p">,</span>
    <span class="nx">alignItems</span><span class="o">:</span> <span class="s1">&#39;center&#39;</span>
  <span class="p">},</span>
  <span class="nx">personScoreHeader</span><span class="o">:</span> <span class="p">{</span>
    <span class="nx">color</span><span class="o">:</span> <span class="s1">&#39;rgba( 0, 0, 0, 0.3 )&#39;</span><span class="p">,</span>
    <span class="nx">fontSize</span><span class="o">:</span> <span class="mi">10</span><span class="p">,</span>
    <span class="nx">fontWeight</span><span class="o">:</span> <span class="s1">&#39;bold&#39;</span>
  <span class="p">},</span>
  <span class="nx">personScoreValue</span><span class="o">:</span> <span class="p">{</span>
    <span class="nx">color</span><span class="o">:</span> <span class="s1">&#39;rgba( 0, 0, 0, 0.6 )&#39;</span><span class="p">,</span>
    <span class="nx">fontSize</span><span class="o">:</span> <span class="mi">16</span>
  <span class="p">},</span>
  <span class="nx">won</span><span class="o">:</span> <span class="p">{</span>
    <span class="nx">color</span><span class="o">:</span> <span class="s1">&#39;#93C26D&#39;</span>
  <span class="p">},</span>
  <span class="nx">lost</span><span class="o">:</span> <span class="p">{</span>
    <span class="nx">color</span><span class="o">:</span> <span class="s1">&#39;#DD4B39&#39;</span>
  <span class="p">}</span>
<span class="p">});</span>

<span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="nx">facemashTab</span><span class="p">;</span>
</pre></div>
</td></tr></table>

</div>

<div style="text-align: center">
    <a href="/img/going-native-with-react/facemash-users.png" target="_blank"><img src="/img/going-native-with-react/facemash-users.png" /></a>
</div>

<p>You can check out the code up to here on the <code>step-two</code> branch.</p>

<p>Now we’ve got the users displaying, we can add our tab events that allow the user to pick who is hottest.</p>

<h4 id="tap-tap">Tap tap</h4>

<p>React Native offers us the <code>TouchableHighlight</code> component. This allows our <code>View</code> components to respond properly to touches. When it is touched, the opacity of the wrapped view is decreased. This makes our components “feel” touchable.</p>

<p>We’re going to wrap the person information section with this. In the future, we might want to make it so the user can tap the photo to see more pictures of that person.</p>

<div class="file-name">
  <span class="file-name__folder">
    <i class="fa fa-folder-o"></i>
    tabs
  </span>
  <span class="file-name__file">
    <i class="fa fa-file-code-o"></i>
    FaceMash.js
  </span>
</div>
<div class="code-block">

<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><code class="language-js" data-lang="js"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46</code></pre></div></td><td class="code"><div class="highlight"><pre><span class="c1">// omitted code</span>

<span class="kd">var</span> <span class="nx">Person</span> <span class="o">=</span> <span class="nx">React</span><span class="p">.</span><span class="nx">createClass</span><span class="p">({</span>
  <span class="nx">render</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">person</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">person</span><span class="p">;</span>

    <span class="k">return</span> <span class="p">(</span>
      <span class="o">&lt;</span><span class="nx">View</span> <span class="nx">style</span><span class="o">=</span><span class="p">{</span> <span class="nx">styles</span><span class="p">.</span><span class="nx">person</span> <span class="p">}</span><span class="o">&gt;</span>
        <span class="o">&lt;</span><span class="nx">Image</span> <span class="nx">style</span><span class="o">=</span><span class="p">{</span> <span class="nx">styles</span><span class="p">.</span><span class="nx">personImage</span> <span class="p">}</span> <span class="nx">source</span><span class="o">=</span><span class="p">{</span> <span class="p">{</span> <span class="nx">uri</span><span class="o">:</span> <span class="nx">person</span><span class="p">.</span><span class="nx">picture</span> <span class="p">}</span> <span class="p">}</span> <span class="o">/&gt;</span>
        <span class="o">&lt;</span><span class="nx">TouchableHighlight</span><span class="o">&gt;</span>
          <span class="o">&lt;</span><span class="nx">View</span> <span class="nx">style</span><span class="o">=</span><span class="p">{</span> <span class="nx">styles</span><span class="p">.</span><span class="nx">personInfo</span> <span class="p">}</span><span class="o">&gt;</span>
            <span class="o">&lt;</span><span class="nx">Text</span> <span class="nx">style</span><span class="o">=</span><span class="p">{</span> <span class="nx">styles</span><span class="p">.</span><span class="nx">personName</span> <span class="p">}</span><span class="o">&gt;</span>
              <span class="p">{</span> <span class="nx">person</span><span class="p">.</span><span class="nx">firstName</span> <span class="p">}</span> <span class="p">{</span> <span class="nx">person</span><span class="p">.</span><span class="nx">lastName</span> <span class="p">}</span>
            <span class="o">&lt;</span><span class="err">/Text&gt;</span>
            <span class="o">&lt;</span><span class="nx">View</span> <span class="nx">style</span><span class="o">=</span><span class="p">{</span> <span class="nx">styles</span><span class="p">.</span><span class="nx">personScore</span> <span class="p">}</span><span class="o">&gt;</span>
              <span class="o">&lt;</span><span class="nx">Text</span> <span class="nx">style</span><span class="o">=</span><span class="p">{</span> <span class="nx">styles</span><span class="p">.</span><span class="nx">personScoreHeader</span> <span class="p">}</span><span class="o">&gt;</span>
                <span class="nx">WON</span>
              <span class="o">&lt;</span><span class="err">/Text&gt;</span>
              <span class="o">&lt;</span><span class="nx">Text</span> <span class="nx">style</span><span class="o">=</span><span class="p">{</span> <span class="p">[</span><span class="nx">styles</span><span class="p">.</span><span class="nx">personScoreValue</span><span class="p">,</span> <span class="nx">styles</span><span class="p">.</span><span class="nx">won</span><span class="p">]</span> <span class="p">}</span><span class="o">&gt;</span>
                <span class="p">{</span> <span class="nx">person</span><span class="p">.</span><span class="nx">won</span> <span class="p">}</span>
              <span class="o">&lt;</span><span class="err">/Text&gt;</span>
            <span class="o">&lt;</span><span class="err">/View&gt;</span>
            <span class="o">&lt;</span><span class="nx">View</span> <span class="nx">style</span><span class="o">=</span><span class="p">{</span> <span class="nx">styles</span><span class="p">.</span><span class="nx">personScore</span> <span class="p">}</span><span class="o">&gt;</span>
              <span class="o">&lt;</span><span class="nx">Text</span> <span class="nx">style</span><span class="o">=</span><span class="p">{</span> <span class="nx">styles</span><span class="p">.</span><span class="nx">personScoreHeader</span> <span class="p">}</span><span class="o">&gt;</span>
                <span class="nx">LOST</span>
              <span class="o">&lt;</span><span class="err">/Text&gt;</span>
              <span class="o">&lt;</span><span class="nx">Text</span> <span class="nx">style</span><span class="o">=</span><span class="p">{</span> <span class="p">[</span><span class="nx">styles</span><span class="p">.</span><span class="nx">personScoreValue</span><span class="p">,</span> <span class="nx">styles</span><span class="p">.</span><span class="nx">lost</span><span class="p">]</span> <span class="p">}</span><span class="o">&gt;</span>
                <span class="p">{</span> <span class="nx">person</span><span class="p">.</span><span class="nx">lost</span> <span class="p">}</span>
              <span class="o">&lt;</span><span class="err">/Text&gt;</span>
            <span class="o">&lt;</span><span class="err">/View&gt;</span>
            <span class="o">&lt;</span><span class="nx">View</span> <span class="nx">style</span><span class="o">=</span><span class="p">{</span> <span class="nx">styles</span><span class="p">.</span><span class="nx">personScore</span> <span class="p">}</span><span class="o">&gt;</span>
              <span class="o">&lt;</span><span class="nx">Text</span> <span class="nx">style</span><span class="o">=</span><span class="p">{</span> <span class="nx">styles</span><span class="p">.</span><span class="nx">personScoreHeader</span> <span class="p">}</span><span class="o">&gt;</span>
                <span class="nx">SCORE</span>
              <span class="o">&lt;</span><span class="err">/Text&gt;</span>
              <span class="o">&lt;</span><span class="nx">Text</span> <span class="nx">style</span><span class="o">=</span><span class="p">{</span> <span class="nx">styles</span><span class="p">.</span><span class="nx">personScoreValue</span> <span class="p">}</span><span class="o">&gt;</span>
                <span class="p">{</span> <span class="nx">person</span><span class="p">.</span><span class="nx">score</span> <span class="p">}</span>
              <span class="o">&lt;</span><span class="err">/Text&gt;</span>
            <span class="o">&lt;</span><span class="err">/View&gt;</span>
          <span class="o">&lt;</span><span class="err">/View&gt;</span>
        <span class="o">&lt;</span><span class="err">/TouchableHighlight&gt;</span>
      <span class="o">&lt;</span><span class="err">/View&gt;</span>
    <span class="p">)</span>
  <span class="p">}</span>
<span class="p">});</span>

<span class="c1">// omitted code</span>
</pre></div>
</td></tr></table>

</div>

<p>If your reload our changes and tap on the user information, you’ll notice it works - but it looks horrible. This is because we haven’t set a background colour on the view, meaning the whole component is darkened.</p>

<div class="file-name">
  <span class="file-name__folder">
    <i class="fa fa-folder-o"></i>
    tabs
  </span>
  <span class="file-name__file">
    <i class="fa fa-file-code-o"></i>
    FaceMash.js
  </span>
</div>
<div class="code-block">

<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><code class="language-js" data-lang="js"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26</code></pre></div></td><td class="code"><div class="highlight"><pre><span class="c1">// omitted code</span>

<span class="kd">var</span> <span class="nx">styles</span> <span class="o">=</span> <span class="nx">StyleSheet</span><span class="p">.</span><span class="nx">create</span><span class="p">({</span>
  <span class="p">...,</span>
  <span class="nx">person</span><span class="o">:</span> <span class="p">{</span>
    <span class="nx">flex</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="nx">margin</span><span class="o">:</span> <span class="mi">10</span><span class="p">,</span>
    <span class="nx">borderRadius</span><span class="o">:</span> <span class="mi">3</span><span class="p">,</span>
    <span class="nx">overflow</span><span class="o">:</span> <span class="s1">&#39;hidden&#39;</span>
  <span class="p">},</span>
  <span class="nx">personInfo</span><span class="o">:</span> <span class="p">{</span>
    <span class="nx">backgroundColor</span><span class="o">:</span> <span class="s1">&#39;#fff&#39;</span><span class="p">,</span>
    <span class="nx">borderLeftColor</span><span class="o">:</span> <span class="s1">&#39;rgba( 0, 0, 0, 0.1 )&#39;</span><span class="p">,</span>
    <span class="nx">borderLeftWidth</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="nx">borderRightColor</span><span class="o">:</span> <span class="s1">&#39;rgba( 0, 0, 0, 0.1 )&#39;</span><span class="p">,</span>
    <span class="nx">borderRightWidth</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="nx">borderBottomColor</span><span class="o">:</span> <span class="s1">&#39;rgba( 0, 0, 0, 0.1 )&#39;</span><span class="p">,</span>
    <span class="nx">borderBottomWidth</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="nx">padding</span><span class="o">:</span> <span class="mi">10</span><span class="p">,</span>
    <span class="nx">alignItems</span><span class="o">:</span> <span class="s1">&#39;center&#39;</span><span class="p">,</span>
    <span class="nx">flexDirection</span><span class="o">:</span> <span class="s1">&#39;row&#39;</span>
  <span class="p">},</span>
  <span class="p">...</span>
<span class="p">});</span>

<span class="c1">// omitted code</span>
</pre></div>
</td></tr></table>

</div>

<p>If you tap the info box now, it’ll work correctly!</p>

<p><code>TouchableHighlight</code> offers us the same events that <code>TouchableWithoutFeedback</code> has. <code>TouchableWithoutFeedback</code> shouldn’t be used, as everything that can be tapped should provide some sort of visual feedback.</p>

<p>This means we can use <code>onPress</code> - which is called when the user has released the tap, but as long as it hasn’t been interrupted (e.g. moving their finger off of the tappable area).</p>

<p>We need to pass a property down to our <code>Person</code> component for when it is tapped on.</p>

<div class="file-name">
  <span class="file-name__folder">
    <i class="fa fa-folder-o"></i>
    tabs
  </span>
  <span class="file-name__file">
    <i class="fa fa-file-code-o"></i>
    FaceMash.js
  </span>
</div>
<div class="code-block">

<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><code class="language-js" data-lang="js"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70</code></pre></div></td><td class="code"><div class="highlight"><pre><span class="s1">&#39;use strict&#39;</span><span class="p">;</span>

<span class="kd">var</span> <span class="nx">React</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;react-native&#39;</span><span class="p">);</span>
<span class="kd">var</span> <span class="p">{</span>
  <span class="nx">StyleSheet</span><span class="p">,</span>
  <span class="nx">Text</span><span class="p">,</span>
  <span class="nx">View</span><span class="p">,</span>
  <span class="nx">Image</span><span class="p">,</span>
  <span class="nx">ActivityIndicatorIOS</span><span class="p">,</span>
  <span class="nx">TouchableHighlight</span>
  <span class="p">}</span> <span class="o">=</span> <span class="nx">React</span><span class="p">;</span>

<span class="kd">var</span> <span class="nx">Person</span> <span class="o">=</span> <span class="nx">React</span><span class="p">.</span><span class="nx">createClass</span><span class="p">({</span>
  <span class="nx">render</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">person</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">person</span><span class="p">;</span>

    <span class="k">return</span> <span class="p">(</span>
      <span class="o">&lt;</span><span class="nx">View</span> <span class="nx">style</span><span class="o">=</span><span class="p">{</span> <span class="nx">styles</span><span class="p">.</span><span class="nx">person</span> <span class="p">}</span><span class="o">&gt;</span>
        <span class="o">&lt;</span><span class="nx">Image</span> <span class="nx">style</span><span class="o">=</span><span class="p">{</span> <span class="nx">styles</span><span class="p">.</span><span class="nx">personImage</span> <span class="p">}</span> <span class="nx">source</span><span class="o">=</span><span class="p">{</span> <span class="p">{</span> <span class="nx">uri</span><span class="o">:</span> <span class="nx">person</span><span class="p">.</span><span class="nx">picture</span> <span class="p">}</span> <span class="p">}</span> <span class="o">/&gt;</span>
        <span class="o">&lt;</span><span class="nx">TouchableHighlight</span> <span class="nx">onPress</span><span class="o">=</span><span class="p">{</span> <span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">onPress</span> <span class="p">}</span><span class="o">&gt;</span>
          <span class="p">...</span>
        <span class="o">&lt;</span><span class="err">/TouchableHighlight&gt;</span>
      <span class="o">&lt;</span><span class="err">/View&gt;</span>
    <span class="p">)</span>
  <span class="p">}</span>
<span class="p">});</span>

<span class="kd">var</span> <span class="nx">facemashTab</span> <span class="o">=</span> <span class="nx">React</span><span class="p">.</span><span class="nx">createClass</span><span class="p">({</span>
  <span class="p">...,</span>
  <span class="nx">onPersonPress</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">setState</span><span class="p">({</span>
      <span class="nx">currentIndex</span><span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">currentIndex</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="p">});</span>
  <span class="p">},</span>
  <span class="p">...,</span>
  <span class="nx">render</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">contents</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">list</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">contents</span> <span class="o">=</span> <span class="p">(</span>
        <span class="o">&lt;</span><span class="nx">View</span> <span class="nx">style</span><span class="o">=</span><span class="p">{</span> <span class="nx">styles</span><span class="p">.</span><span class="nx">loading</span> <span class="p">}</span><span class="o">&gt;</span>
          <span class="o">&lt;</span><span class="nx">Text</span> <span class="nx">style</span><span class="o">=</span><span class="p">{</span> <span class="nx">styles</span><span class="p">.</span><span class="nx">loadingText</span> <span class="p">}</span><span class="o">&gt;</span><span class="nx">Loading</span><span class="o">&lt;</span><span class="err">/Text&gt;</span>
          <span class="o">&lt;</span><span class="nx">ActivityIndicatorIOS</span> <span class="o">/&gt;</span>
        <span class="o">&lt;</span><span class="err">/View&gt;</span>
      <span class="p">)</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
      <span class="kd">var</span> <span class="p">{</span> <span class="nx">list</span><span class="p">,</span> <span class="nx">currentIndex</span> <span class="p">}</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">;</span>

      <span class="kd">var</span> <span class="nx">record</span> <span class="o">=</span> <span class="nx">list</span><span class="p">[</span><span class="nx">currentIndex</span><span class="p">];</span>

      <span class="kd">var</span> <span class="nx">people</span> <span class="o">=</span> <span class="nx">record</span><span class="p">.</span><span class="nx">users</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nx">person</span> <span class="o">=&gt;</span> <span class="o">&lt;</span><span class="nx">Person</span> <span class="nx">person</span><span class="o">=</span><span class="p">{</span> <span class="nx">person</span> <span class="p">}</span> <span class="nx">onPress</span><span class="o">=</span><span class="p">{</span> <span class="k">this</span><span class="p">.</span><span class="nx">onPersonPress</span> <span class="p">}</span> <span class="o">/&gt;</span><span class="p">);</span>

      <span class="nx">contents</span> <span class="o">=</span> <span class="p">(</span>
        <span class="o">&lt;</span><span class="nx">View</span> <span class="nx">style</span><span class="o">=</span><span class="p">{</span> <span class="nx">styles</span><span class="p">.</span><span class="nx">content</span> <span class="p">}</span><span class="o">&gt;</span>
          <span class="p">{</span> <span class="nx">people</span> <span class="p">}</span>
        <span class="o">&lt;</span><span class="err">/View&gt;</span>
      <span class="p">)</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="p">(</span>
      <span class="o">&lt;</span><span class="nx">View</span> <span class="nx">style</span><span class="o">=</span><span class="p">{</span> <span class="nx">styles</span><span class="p">.</span><span class="nx">container</span> <span class="p">}</span><span class="o">&gt;</span>
        <span class="o">&lt;</span><span class="nx">View</span> <span class="nx">style</span><span class="o">=</span><span class="p">{</span> <span class="nx">styles</span><span class="p">.</span><span class="nx">header</span> <span class="p">}</span><span class="o">&gt;</span>
          <span class="o">&lt;</span><span class="nx">Text</span> <span class="nx">style</span><span class="o">=</span><span class="p">{</span> <span class="nx">styles</span><span class="p">.</span><span class="nx">headerText</span> <span class="p">}</span><span class="o">&gt;</span><span class="nx">FaceMash</span><span class="o">&lt;</span><span class="err">/Text&gt;</span>
        <span class="o">&lt;</span><span class="err">/View&gt;</span>
        <span class="p">{</span> <span class="nx">contents</span> <span class="p">}</span>
      <span class="o">&lt;</span><span class="err">/View&gt;</span>
    <span class="p">);</span>
  <span class="p">}</span>
<span class="p">});</span>

<span class="c1">// omitted code</span>
</pre></div>
</td></tr></table>

</div>

<p>As you can see, there is now a <code>onPersonPress</code> property in our main tab component. We then pass this down to our <code>Person</code> components, and they then call it when the <code>TouchableHighlight</code> area has been tapped. We can then increment our index, and the view will rerender with the new set of people.</p>

<div style="text-align: center">
    <a href="/img/going-native-with-react/facemash-tapped.png" target="_blank"><img src="/img/going-native-with-react/facemash-tapped.png" /></a>
</div>

<p>This is the final changes to the facemash tab. If you wish to go further with it, here are some ideas</p>

<ul>
  <li>Hit a REST endpoint when a user has been picked</li>
  <li>Check if the end of the list has been reached, and display a message</li>
  <li>Allow the user to click on the photos and see more</li>
</ul>

<p>You can check out the final code for our facemash tab on the <code>step-three</code> branch.</p>

<h2 id="messages">Messages</h2>

<p>We can now move onto the messages tab. This will function a bit like iMessage - a scrollable list of users, and clicking on one will navigate us to the chat view for that user.</p>

<p>Luckily, React Native gives us the <code>ListView</code> component. This allows us to have a simple, scrollable list (using <code>ScrollView</code>) as well as efficiently displaying the list (only re-renders changed rows and limits row rendering to one per event loop).</p>

<p>To use a <code>ListView</code>, we need to have a data source. A data source allows us to have a custom function to check whether or not a row has changed (think of it similar to <code>shouldComponentUpdate</code>) and we can then put our JSON data into it. The data source lives in our state object.</p>

<p>Create a new file in the <code>tabs/</code> folder called <code>Messages.js</code>.</p>

<div class="file-name">
  <span class="file-name__folder">
    <i class="fa fa-folder-o"></i>
    tabs
  </span>
  <span class="file-name__file">
    <i class="fa fa-file-code-o"></i>
    Messages.js
  </span>
</div>
<div class="code-block">

<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><code class="language-js" data-lang="js"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28</code></pre></div></td><td class="code"><div class="highlight"><pre><span class="s1">&#39;use strict&#39;</span><span class="p">;</span>

<span class="kd">var</span> <span class="nx">React</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;react-native&#39;</span><span class="p">);</span>
<span class="kd">var</span> <span class="p">{</span>
  <span class="nx">StyleSheet</span><span class="p">,</span>
  <span class="nx">Text</span><span class="p">,</span>
  <span class="nx">View</span><span class="p">,</span>
  <span class="nx">Image</span>
  <span class="p">}</span> <span class="o">=</span> <span class="nx">React</span><span class="p">;</span>

<span class="kd">var</span> <span class="nx">messagesTab</span> <span class="o">=</span> <span class="nx">React</span><span class="p">.</span><span class="nx">createClass</span><span class="p">({</span>
  <span class="nx">render</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="p">(</span>
      <span class="o">&lt;</span><span class="nx">View</span> <span class="nx">style</span><span class="o">=</span><span class="p">{</span> <span class="nx">styles</span><span class="p">.</span><span class="nx">container</span> <span class="p">}</span><span class="o">&gt;</span>
        <span class="o">&lt;</span><span class="nx">Text</span><span class="o">&gt;</span><span class="nx">Messages</span><span class="o">!&lt;</span><span class="err">/Text&gt;</span>
      <span class="o">&lt;</span><span class="err">/View&gt;</span>
    <span class="p">);</span>
  <span class="p">}</span>
<span class="p">});</span>

<span class="kd">var</span> <span class="nx">styles</span> <span class="o">=</span> <span class="nx">StyleSheet</span><span class="p">.</span><span class="nx">create</span><span class="p">({</span>
  <span class="nx">container</span><span class="o">:</span> <span class="p">{</span>
    <span class="nx">flex</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="nx">backgroundColor</span><span class="o">:</span> <span class="s1">&#39;#fff&#39;</span>
  <span class="p">}</span>
<span class="p">});</span>

<span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="nx">messagesTab</span><span class="p">;</span>
</pre></div>
</td></tr></table>

</div>

<p>You’ll also need to edit <code>index.ios.js</code> to point to the newly created component -</p>

<div class="file-name">
  <span class="file-name__file">
    <i class="fa fa-file-code-o"></i>
    index.ios.js
  </span>
</div>
<div class="code-block">

<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><code class="language-js" data-lang="js"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34</code></pre></div></td><td class="code"><div class="highlight"><pre><span class="c1">// omitted code</span>

<span class="kd">var</span> <span class="nx">MessagesTab</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;./tabs/Messages&#39;</span><span class="p">);</span>

<span class="kd">var</span> <span class="nx">facemash</span> <span class="o">=</span> <span class="nx">React</span><span class="p">.</span><span class="nx">createClass</span><span class="p">({</span>
  <span class="nx">getInitialState</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="p">{</span>
      <span class="nx">selectedTab</span><span class="o">:</span> <span class="s1">&#39;faceMash&#39;</span>
    <span class="p">}</span>
  <span class="p">},</span>
  <span class="nx">changeTab</span><span class="p">(</span><span class="nx">tabName</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">StatusBarIOS</span><span class="p">.</span><span class="nx">setStyle</span><span class="p">(</span><span class="nx">tabName</span> <span class="o">===</span> <span class="s1">&#39;faceMash&#39;</span> <span class="o">?</span> <span class="mi">1</span> <span class="o">:</span> <span class="mi">0</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">setState</span><span class="p">({</span>
      <span class="nx">selectedTab</span><span class="o">:</span> <span class="nx">tabName</span>
    <span class="p">});</span>
  <span class="p">},</span>
  <span class="nx">render</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="p">(</span>
      <span class="o">&lt;</span><span class="nx">TabBarIOS</span><span class="o">&gt;</span>
        <span class="p">...</span>
        <span class="o">&lt;</span><span class="nx">TabBarIOS</span><span class="p">.</span><span class="nx">Item</span>
          <span class="nx">title</span><span class="o">=</span><span class="s2">&quot;Messages&quot;</span>
          <span class="nx">icon</span><span class="o">=</span><span class="p">{</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;image!messages&#39;</span><span class="p">)</span> <span class="p">}</span>
          <span class="nx">onPress</span><span class="o">=</span><span class="p">{</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="k">this</span><span class="p">.</span><span class="nx">changeTab</span><span class="p">(</span><span class="s1">&#39;messages&#39;</span><span class="p">)</span> <span class="p">}</span>
          <span class="nx">selected</span><span class="o">=</span><span class="p">{</span> <span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">selectedTab</span> <span class="o">===</span> <span class="s1">&#39;messages&#39;</span> <span class="p">}</span><span class="o">&gt;</span>
          <span class="o">&lt;</span><span class="nx">MessagesTab</span> <span class="o">/&gt;</span>
        <span class="o">&lt;</span><span class="err">/TabBarIOS.Item&gt;</span>
        <span class="p">...</span>
      <span class="o">&lt;</span><span class="err">/TabBarIOS&gt;</span>
    <span class="p">);</span>
  <span class="p">}</span>
<span class="p">});</span>

<span class="c1">// omitted code</span>
</pre></div>
</td></tr></table>

</div>

<p>As I mentioned above, we need a data source for our list view. This is accessible via <code>ListView.DataSource</code>. We’ll initialise one in our <code>getInitialState</code>.</p>

<div class="file-name">
  <span class="file-name__folder">
    <i class="fa fa-folder-o"></i>
    tabs
  </span>
  <span class="file-name__file">
    <i class="fa fa-file-code-o"></i>
    Messages.js
  </span>
</div>
<div class="code-block">

<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><code class="language-js" data-lang="js"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36</code></pre></div></td><td class="code"><div class="highlight"><pre><span class="s1">&#39;use strict&#39;</span><span class="p">;</span>

<span class="kd">var</span> <span class="nx">React</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;react-native&#39;</span><span class="p">);</span>
<span class="kd">var</span> <span class="p">{</span>
  <span class="nx">StyleSheet</span><span class="p">,</span>
  <span class="nx">Text</span><span class="p">,</span>
  <span class="nx">View</span><span class="p">,</span>
  <span class="nx">Image</span><span class="p">,</span>
  <span class="nx">ListView</span>
  <span class="p">}</span> <span class="o">=</span> <span class="nx">React</span><span class="p">;</span>

<span class="kd">var</span> <span class="nx">messagesTab</span> <span class="o">=</span> <span class="nx">React</span><span class="p">.</span><span class="nx">createClass</span><span class="p">({</span>
  <span class="nx">getInitialState</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="p">{</span>
      <span class="nx">dataSource</span><span class="o">:</span> <span class="k">new</span> <span class="nx">ListView</span><span class="p">.</span><span class="nx">DataSource</span><span class="p">({</span>
        <span class="nx">rowHasChanged</span><span class="o">:</span> <span class="p">(</span><span class="nx">r1</span><span class="p">,</span> <span class="nx">r2</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">r1</span> <span class="o">!==</span> <span class="nx">r2</span>
      <span class="p">})</span>
    <span class="p">};</span>
  <span class="p">},</span>
  <span class="nx">render</span><span class="o">:</span> <span class="kd">function</span><span class="p">(){</span>
    <span class="k">return</span> <span class="p">(</span>
      <span class="o">&lt;</span><span class="nx">View</span> <span class="nx">style</span><span class="o">=</span><span class="p">{</span> <span class="nx">styles</span><span class="p">.</span><span class="nx">container</span> <span class="p">}</span><span class="o">&gt;</span>
        <span class="o">&lt;</span><span class="nx">Text</span><span class="o">&gt;</span><span class="nx">Messages</span><span class="o">!&lt;</span><span class="err">/Text&gt;</span>
      <span class="o">&lt;</span><span class="err">/View&gt;</span>
    <span class="p">);</span>
  <span class="p">}</span>
<span class="p">});</span>

<span class="kd">var</span> <span class="nx">styles</span> <span class="o">=</span> <span class="nx">StyleSheet</span><span class="p">.</span><span class="nx">create</span><span class="p">({</span>
  <span class="nx">container</span><span class="o">:</span> <span class="p">{</span>
    <span class="nx">flex</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="nx">backgroundColor</span><span class="o">:</span> <span class="s1">&#39;#fff&#39;</span>
  <span class="p">}</span>
<span class="p">});</span>

<span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="nx">messagesTab</span><span class="p">;</span>
</pre></div>
</td></tr></table>

</div>

<p>Now we’ve got our data source, we need to fetch some data from the server to know who we’ve been messaging. I’ve included in an endpoint configuration for stubby in the <code>step-three</code> branch.</p>

<div class="file-name">
  <span class="file-name__folder">
    <i class="fa fa-folder-o"></i>
    tabs
  </span>
  <span class="file-name__file">
    <i class="fa fa-file-code-o"></i>
    Messages.js
  </span>
</div>
<div class="code-block">

<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><code class="language-js" data-lang="js"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30</code></pre></div></td><td class="code"><div class="highlight"><pre><span class="c1">// omitted code</span>

<span class="kd">var</span> <span class="nx">messagesTab</span> <span class="o">=</span> <span class="nx">React</span><span class="p">.</span><span class="nx">createClass</span><span class="p">({</span>
  <span class="nx">componentWillMount</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">fetch</span><span class="p">(</span><span class="s1">&#39;http://localhost:8882/rest/messages&#39;</span><span class="p">)</span>
      <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="nx">res</span> <span class="o">=&gt;</span> <span class="nx">res</span><span class="p">.</span><span class="nx">json</span><span class="p">())</span>
      <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="nx">res</span> <span class="o">=&gt;</span> <span class="k">this</span><span class="p">.</span><span class="nx">updateDataSource</span><span class="p">(</span><span class="nx">res</span><span class="p">));</span>
  <span class="p">},</span>
  <span class="nx">getInitialState</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="p">{</span>
      <span class="nx">dataSource</span><span class="o">:</span> <span class="k">new</span> <span class="nx">ListView</span><span class="p">.</span><span class="nx">DataSource</span><span class="p">({</span>
        <span class="nx">rowHasChanged</span><span class="o">:</span> <span class="p">(</span><span class="nx">r1</span><span class="p">,</span> <span class="nx">r2</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">r1</span> <span class="o">!==</span> <span class="nx">r2</span>
      <span class="p">})</span>
    <span class="p">};</span>
  <span class="p">},</span>
  <span class="nx">updateDataSource</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">data</span><span class="p">){</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">setState</span><span class="p">({</span>
      <span class="nx">dataSource</span><span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">dataSource</span><span class="p">.</span><span class="nx">cloneWithRows</span><span class="p">(</span><span class="nx">data</span><span class="p">)</span>
    <span class="p">})</span>
  <span class="p">},</span>
  <span class="nx">render</span><span class="o">:</span> <span class="kd">function</span><span class="p">(){</span>
    <span class="k">return</span> <span class="p">(</span>
      <span class="o">&lt;</span><span class="nx">View</span> <span class="nx">style</span><span class="o">=</span><span class="p">{</span> <span class="nx">styles</span><span class="p">.</span><span class="nx">container</span> <span class="p">}</span><span class="o">&gt;</span>
        <span class="o">&lt;</span><span class="nx">Text</span><span class="o">&gt;</span><span class="nx">Messages</span><span class="o">!&lt;</span><span class="err">/Text&gt;</span>
      <span class="o">&lt;</span><span class="err">/View&gt;</span>
    <span class="p">);</span>
  <span class="p">}</span>
<span class="p">});</span>

<span class="c1">// omitted code</span>
</pre></div>
</td></tr></table>

</div>

<p>This will fetch our data and then update our data source with it. As this is all handled in the state, whenever our data source gets updated so will our view!</p>

<p>We can now move on to our <code>ListView</code> component. At a minimum, the component needs two properties - <code>dataSource</code> (which we already have) and <code>renderRow</code>. <code>renderRow</code> is a function that needs to return a React element. It’s called once for every row in the data source, and is passed the appropriate data for that row as an argument.</p>

<div class="file-name">
  <span class="file-name__folder">
    <i class="fa fa-folder-o"></i>
    tabs
  </span>
  <span class="file-name__file">
    <i class="fa fa-file-code-o"></i>
    Messages.js
  </span>
</div>
<div class="code-block">

<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><code class="language-js" data-lang="js"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21</code></pre></div></td><td class="code"><div class="highlight"><pre><span class="c1">// omitted code</span>

<span class="kd">var</span> <span class="nx">messagesTab</span> <span class="o">=</span> <span class="nx">React</span><span class="p">.</span><span class="nx">createClass</span><span class="p">({</span>
  <span class="p">...,</span>
  <span class="nx">renderRow</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(){</span>
    <span class="k">return</span> <span class="p">(</span>
      <span class="o">&lt;</span><span class="nx">View</span><span class="o">&gt;</span>
        <span class="o">&lt;</span><span class="nx">Text</span><span class="o">&gt;</span><span class="nx">Row</span> <span class="nx">goes</span> <span class="nx">here</span><span class="o">!&lt;</span><span class="err">/Text&gt;</span>
      <span class="o">&lt;</span><span class="err">/View&gt;</span>
    <span class="p">);</span>
  <span class="p">},</span>
  <span class="nx">render</span><span class="o">:</span> <span class="kd">function</span><span class="p">(){</span>
    <span class="k">return</span> <span class="p">(</span>
      <span class="o">&lt;</span><span class="nx">View</span> <span class="nx">style</span><span class="o">=</span><span class="p">{</span> <span class="nx">styles</span><span class="p">.</span><span class="nx">container</span> <span class="p">}</span><span class="o">&gt;</span>
        <span class="o">&lt;</span><span class="nx">ListView</span> <span class="nx">dataSource</span><span class="o">=</span><span class="p">{</span> <span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">dataSource</span> <span class="p">}</span> <span class="nx">renderRow</span><span class="o">=</span><span class="p">{</span> <span class="k">this</span><span class="p">.</span><span class="nx">renderRow</span> <span class="p">}</span> <span class="o">/&gt;</span>
      <span class="o">&lt;</span><span class="err">/View&gt;</span>
    <span class="p">);</span>
  <span class="p">}</span>
<span class="p">});</span>

<span class="c1">// omitted code</span>
</pre></div>
</td></tr></table>

</div>

<div style="text-align: center">
    <a href="/img/going-native-with-react/messages-start.png" target="_blank"><img src="/img/going-native-with-react/messages-start.png" /></a>
</div>

<p>We can now get to displaying the correct data for each row. The object for each item is passed through as the first parameter to our <code>renderRow</code> function.</p>

<div class="file-name">
  <span class="file-name__folder">
    <i class="fa fa-folder-o"></i>
    tabs
  </span>
  <span class="file-name__file">
    <i class="fa fa-file-code-o"></i>
    Messages.js
  </span>
</div>
<div class="code-block">

<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><code class="language-js" data-lang="js"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21</code></pre></div></td><td class="code"><div class="highlight"><pre><span class="c1">// omitted code</span>

<span class="kd">var</span> <span class="nx">messagesTab</span> <span class="o">=</span> <span class="nx">React</span><span class="p">.</span><span class="nx">createClass</span><span class="p">({</span>
  <span class="p">...,</span>
  <span class="nx">renderRow</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">person</span><span class="p">){</span>
    <span class="k">return</span> <span class="p">(</span>
      <span class="o">&lt;</span><span class="nx">View</span><span class="o">&gt;</span>
        <span class="o">&lt;</span><span class="nx">Text</span><span class="o">&gt;</span><span class="p">{</span> <span class="nx">person</span><span class="p">.</span><span class="nx">user</span><span class="p">.</span><span class="nx">firstName</span> <span class="p">}</span> <span class="p">{</span> <span class="nx">person</span><span class="p">.</span><span class="nx">user</span><span class="p">.</span><span class="nx">lastName</span> <span class="p">}</span><span class="o">&lt;</span><span class="err">/Text&gt;</span>
      <span class="o">&lt;</span><span class="err">/View&gt;</span>
    <span class="p">);</span>
  <span class="p">},</span>
  <span class="nx">render</span><span class="o">:</span> <span class="kd">function</span><span class="p">(){</span>
    <span class="k">return</span> <span class="p">(</span>
      <span class="o">&lt;</span><span class="nx">View</span> <span class="nx">style</span><span class="o">=</span><span class="p">{</span> <span class="nx">styles</span><span class="p">.</span><span class="nx">container</span> <span class="p">}</span><span class="o">&gt;</span>
        <span class="o">&lt;</span><span class="nx">ListView</span> <span class="nx">dataSource</span><span class="o">=</span><span class="p">{</span> <span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">dataSource</span> <span class="p">}</span> <span class="nx">renderRow</span><span class="o">=</span><span class="p">{</span> <span class="k">this</span><span class="p">.</span><span class="nx">renderRow</span> <span class="p">}</span> <span class="o">/&gt;</span>
      <span class="o">&lt;</span><span class="err">/View&gt;</span>
    <span class="p">);</span>
  <span class="p">}</span>
<span class="p">});</span>

<span class="c1">// omitted code</span>
</pre></div>
</td></tr></table>

</div>

<div style="text-align: center">
    <a href="/img/going-native-with-react/messages-name.png" target="_blank"><img src="/img/going-native-with-react/messages-name.png" /></a>
</div>

<p>We can now go ahead and add the other information in there, such as the picture and the last received message.</p>

<div class="file-name">
  <span class="file-name__folder">
    <i class="fa fa-folder-o"></i>
    tabs
  </span>
  <span class="file-name__file">
    <i class="fa fa-file-code-o"></i>
    Messages.js
  </span>
</div>
<div class="code-block">

<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><code class="language-js" data-lang="js">  1
  2
  3
  4
  5
  6
  7
  8
  9
 10
 11
 12
 13
 14
 15
 16
 17
 18
 19
 20
 21
 22
 23
 24
 25
 26
 27
 28
 29
 30
 31
 32
 33
 34
 35
 36
 37
 38
 39
 40
 41
 42
 43
 44
 45
 46
 47
 48
 49
 50
 51
 52
 53
 54
 55
 56
 57
 58
 59
 60
 61
 62
 63
 64
 65
 66
 67
 68
 69
 70
 71
 72
 73
 74
 75
 76
 77
 78
 79
 80
 81
 82
 83
 84
 85
 86
 87
 88
 89
 90
 91
 92
 93
 94
 95
 96
 97
 98
 99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116</code></pre></div></td><td class="code"><div class="highlight"><pre><span class="s1">&#39;use strict&#39;</span><span class="p">;</span>

<span class="kd">var</span> <span class="nx">React</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;react-native&#39;</span><span class="p">);</span>
<span class="kd">var</span> <span class="p">{</span>
  <span class="nx">StyleSheet</span><span class="p">,</span>
  <span class="nx">Text</span><span class="p">,</span>
  <span class="nx">View</span><span class="p">,</span>
  <span class="nx">Image</span><span class="p">,</span>
  <span class="nx">ListView</span><span class="p">,</span>
  <span class="nx">PixelRatio</span>
  <span class="p">}</span> <span class="o">=</span> <span class="nx">React</span><span class="p">;</span>

<span class="kd">function</span> <span class="nx">prettyTime</span><span class="p">(</span><span class="nx">timestamp</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">createdDate</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">(</span><span class="nx">timestamp</span><span class="p">);</span>
  <span class="kd">var</span> <span class="nx">distance</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">round</span><span class="p">(</span> <span class="p">(</span> <span class="o">+</span><span class="k">new</span> <span class="nb">Date</span><span class="p">()</span> <span class="o">-</span> <span class="nx">timestamp</span> <span class="p">)</span> <span class="o">/</span> <span class="mi">60000</span> <span class="p">);</span>

  <span class="kd">var</span> <span class="nx">hours</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;0&#39;</span> <span class="o">+</span> <span class="nx">createdDate</span><span class="p">.</span><span class="nx">getHours</span><span class="p">()).</span><span class="nx">slice</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">);</span>
  <span class="kd">var</span> <span class="nx">minutes</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;0&#39;</span> <span class="o">+</span> <span class="nx">createdDate</span><span class="p">.</span><span class="nx">getMinutes</span><span class="p">()).</span><span class="nx">slice</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">);</span>
  <span class="kd">var</span> <span class="nx">month</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;0&#39;</span> <span class="o">+</span> <span class="p">(</span><span class="nx">createdDate</span><span class="p">.</span><span class="nx">getMonth</span><span class="p">()</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)).</span><span class="nx">slice</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">);</span>
  <span class="kd">var</span> <span class="nx">date</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;0&#39;</span> <span class="o">+</span> <span class="nx">createdDate</span><span class="p">.</span><span class="nx">getDate</span><span class="p">()).</span><span class="nx">slice</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">);</span>
  <span class="kd">var</span> <span class="nx">year</span> <span class="o">=</span> <span class="nx">createdDate</span><span class="p">.</span><span class="nx">getFullYear</span><span class="p">();</span>

  <span class="kd">var</span> <span class="nx">string</span><span class="p">;</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">distance</span> <span class="o">&lt;</span> <span class="mi">1440</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">string</span> <span class="o">=</span> <span class="p">[</span><span class="nx">hours</span><span class="p">,</span> <span class="nx">minutes</span><span class="p">].</span><span class="nx">join</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">);</span>
  <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">distance</span> <span class="o">&lt;</span> <span class="mi">2879</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">string</span> <span class="o">=</span> <span class="s1">&#39;Yesterday&#39;</span><span class="p">;</span>
  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="nx">string</span> <span class="o">=</span> <span class="p">[</span><span class="nx">date</span><span class="p">,</span> <span class="nx">month</span><span class="p">,</span> <span class="nx">year</span><span class="p">].</span><span class="nx">join</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">);</span>
  <span class="p">}</span>

  <span class="k">return</span> <span class="nx">string</span><span class="p">;</span>
<span class="p">}</span>

<span class="kd">var</span> <span class="nx">messagesTab</span> <span class="o">=</span> <span class="nx">React</span><span class="p">.</span><span class="nx">createClass</span><span class="p">({</span>
  <span class="p">...,</span>
  <span class="nx">renderRow</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">person</span><span class="p">){</span>
    <span class="kd">var</span> <span class="nx">time</span> <span class="o">=</span> <span class="nx">prettyTime</span><span class="p">(</span><span class="nx">person</span><span class="p">.</span><span class="nx">lastMessage</span><span class="p">.</span><span class="nx">timestamp</span><span class="p">);</span>
    <span class="k">return</span> <span class="p">(</span>
      <span class="o">&lt;</span><span class="nx">View</span><span class="o">&gt;</span>
        <span class="o">&lt;</span><span class="nx">View</span> <span class="nx">style</span><span class="o">=</span><span class="p">{</span> <span class="nx">styles</span><span class="p">.</span><span class="nx">row</span> <span class="p">}</span><span class="o">&gt;</span>
          <span class="o">&lt;</span><span class="nx">Image</span>
            <span class="nx">source</span><span class="o">=</span><span class="p">{</span> <span class="p">{</span> <span class="nx">uri</span><span class="o">:</span> <span class="nx">person</span><span class="p">.</span><span class="nx">user</span><span class="p">.</span><span class="nx">picture</span> <span class="p">}</span> <span class="p">}</span>
            <span class="nx">style</span><span class="o">=</span><span class="p">{</span> <span class="nx">styles</span><span class="p">.</span><span class="nx">cellImage</span> <span class="p">}</span>
            <span class="o">/&gt;</span>
          <span class="o">&lt;</span><span class="nx">View</span> <span class="nx">style</span><span class="o">=</span><span class="p">{</span> <span class="nx">styles</span><span class="p">.</span><span class="nx">textContainer</span> <span class="p">}</span><span class="o">&gt;</span>
            <span class="o">&lt;</span><span class="nx">Text</span> <span class="nx">style</span><span class="o">=</span><span class="p">{</span> <span class="nx">styles</span><span class="p">.</span><span class="nx">name</span> <span class="p">}</span> <span class="nx">numberOfLines</span><span class="o">=</span><span class="p">{</span> <span class="mi">1</span> <span class="p">}</span><span class="o">&gt;</span>
              <span class="p">{</span> <span class="nx">person</span><span class="p">.</span><span class="nx">user</span><span class="p">.</span><span class="nx">firstName</span> <span class="p">}</span> <span class="p">{</span> <span class="nx">person</span><span class="p">.</span><span class="nx">user</span><span class="p">.</span><span class="nx">lastName</span> <span class="p">}</span>
            <span class="o">&lt;</span><span class="err">/Text&gt;</span>
            <span class="o">&lt;</span><span class="nx">Text</span> <span class="nx">style</span><span class="o">=</span><span class="p">{</span> <span class="nx">styles</span><span class="p">.</span><span class="nx">time</span> <span class="p">}</span> <span class="nx">numberOfLines</span><span class="o">=</span><span class="p">{</span> <span class="mi">1</span> <span class="p">}</span><span class="o">&gt;</span>
              <span class="p">{</span> <span class="nx">time</span> <span class="p">}</span>
            <span class="o">&lt;</span><span class="err">/Text&gt;</span>
            <span class="o">&lt;</span><span class="nx">Text</span> <span class="nx">style</span><span class="o">=</span><span class="p">{</span> <span class="nx">styles</span><span class="p">.</span><span class="nx">lastMessage</span> <span class="p">}</span> <span class="nx">numberOfLines</span><span class="o">=</span><span class="p">{</span> <span class="mi">1</span> <span class="p">}</span><span class="o">&gt;</span>
              <span class="p">{</span> <span class="nx">person</span><span class="p">.</span><span class="nx">lastMessage</span><span class="p">.</span><span class="nx">contents</span> <span class="p">}</span>
            <span class="o">&lt;</span><span class="err">/Text&gt;</span>
          <span class="o">&lt;</span><span class="err">/View&gt;</span>
        <span class="o">&lt;</span><span class="err">/View&gt;</span>
        <span class="o">&lt;</span><span class="nx">View</span> <span class="nx">style</span><span class="o">=</span><span class="p">{</span> <span class="nx">styles</span><span class="p">.</span><span class="nx">cellBorder</span> <span class="p">}</span> <span class="o">/&gt;</span>
      <span class="o">&lt;</span><span class="err">/View&gt;</span>
    <span class="p">);</span>
  <span class="p">},</span>
  <span class="nx">render</span><span class="o">:</span> <span class="kd">function</span><span class="p">(){</span>
    <span class="k">return</span> <span class="p">(</span>
      <span class="o">&lt;</span><span class="nx">View</span> <span class="nx">style</span><span class="o">=</span><span class="p">{</span> <span class="nx">styles</span><span class="p">.</span><span class="nx">container</span> <span class="p">}</span><span class="o">&gt;</span>
        <span class="o">&lt;</span><span class="nx">ListView</span> <span class="nx">dataSource</span><span class="o">=</span><span class="p">{</span> <span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">dataSource</span> <span class="p">}</span> <span class="nx">renderRow</span><span class="o">=</span><span class="p">{</span> <span class="k">this</span><span class="p">.</span><span class="nx">renderRow</span> <span class="p">}</span> <span class="o">/&gt;</span>
      <span class="o">&lt;</span><span class="err">/View&gt;</span>
    <span class="p">);</span>
  <span class="p">}</span>
<span class="p">});</span>

<span class="kd">var</span> <span class="nx">styles</span> <span class="o">=</span> <span class="nx">StyleSheet</span><span class="p">.</span><span class="nx">create</span><span class="p">({</span>
  <span class="nx">container</span><span class="o">:</span> <span class="p">{</span>
    <span class="nx">flex</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="nx">backgroundColor</span><span class="o">:</span> <span class="s1">&#39;#fff&#39;</span>
  <span class="p">},</span>
  <span class="nx">row</span><span class="o">:</span> <span class="p">{</span>
    <span class="nx">flex</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="nx">alignItems</span><span class="o">:</span> <span class="s1">&#39;center&#39;</span><span class="p">,</span>
    <span class="nx">backgroundColor</span><span class="o">:</span> <span class="s1">&#39;white&#39;</span><span class="p">,</span>
    <span class="nx">flexDirection</span><span class="o">:</span> <span class="s1">&#39;row&#39;</span><span class="p">,</span>
    <span class="nx">padding</span><span class="o">:</span> <span class="mi">10</span>
  <span class="p">},</span>
  <span class="nx">textContainer</span><span class="o">:</span> <span class="p">{</span>
    <span class="nx">flex</span><span class="o">:</span> <span class="mi">1</span>
  <span class="p">},</span>
  <span class="nx">cellImage</span><span class="o">:</span> <span class="p">{</span>
    <span class="nx">height</span><span class="o">:</span> <span class="mi">60</span><span class="p">,</span>
    <span class="nx">borderRadius</span><span class="o">:</span> <span class="mi">30</span><span class="p">,</span>
    <span class="nx">marginRight</span><span class="o">:</span> <span class="mi">10</span><span class="p">,</span>
    <span class="nx">width</span><span class="o">:</span> <span class="mi">60</span>
  <span class="p">},</span>
  <span class="nx">time</span><span class="o">:</span> <span class="p">{</span>
    <span class="nx">position</span><span class="o">:</span> <span class="s1">&#39;absolute&#39;</span><span class="p">,</span>
    <span class="nx">top</span><span class="o">:</span> <span class="mi">0</span><span class="p">,</span>
    <span class="nx">right</span><span class="o">:</span> <span class="mi">0</span><span class="p">,</span>
    <span class="nx">fontSize</span><span class="o">:</span> <span class="mi">12</span><span class="p">,</span>
    <span class="nx">color</span><span class="o">:</span> <span class="s1">&#39;#cccccc&#39;</span>
  <span class="p">},</span>
  <span class="nx">name</span><span class="o">:</span> <span class="p">{</span>
    <span class="nx">flex</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="nx">fontSize</span><span class="o">:</span> <span class="mi">16</span><span class="p">,</span>
    <span class="nx">fontWeight</span><span class="o">:</span> <span class="s1">&#39;bold&#39;</span><span class="p">,</span>
    <span class="nx">marginBottom</span><span class="o">:</span> <span class="mi">2</span>
  <span class="p">},</span>
  <span class="nx">lastMessage</span><span class="o">:</span> <span class="p">{</span>
    <span class="nx">color</span><span class="o">:</span> <span class="s1">&#39;#999999&#39;</span><span class="p">,</span>
    <span class="nx">fontSize</span><span class="o">:</span> <span class="mi">12</span>
  <span class="p">},</span>
  <span class="nx">cellBorder</span><span class="o">:</span> <span class="p">{</span>
    <span class="nx">backgroundColor</span><span class="o">:</span> <span class="s1">&#39;rgba(0, 0, 0, 0.1)&#39;</span><span class="p">,</span>
    <span class="nx">height</span><span class="o">:</span> <span class="mi">1</span> <span class="o">/</span> <span class="nx">PixelRatio</span><span class="p">.</span><span class="nx">get</span><span class="p">(),</span>
    <span class="nx">marginLeft</span><span class="o">:</span> <span class="mi">4</span>
  <span class="p">}</span>
<span class="p">});</span>

<span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="nx">messagesTab</span><span class="p">;</span>
</pre></div>
</td></tr></table>

</div>

<div style="text-align: center">
    <a href="/img/going-native-with-react/messages-styled.png" target="_blank"><img src="/img/going-native-with-react/messages-styled.png" /></a>
</div>

<p>Looking good!</p>

<p>You’ll notice in our stylesheet we’re using something called <code>PixelRatio</code>. This is so we can get the thinnest line that can be possibly displayed on the device used. Normally, we would use 1px for the thinnest border, but there is no concept of px in React Native.</p>

<p>We can now add the code to deal with tapping on a user. We’re going to make use of the <code>NavigatorIOS</code> component - you’ll recognise it in apps such as iMessage and Notes. It allows us to have back-swipe functionality between views, as well as a navigation bar at the top.</p>

<p>We’re actually going to make a new React component to house the navigator. This is because the component needs an initial React component to render.</p>

<p>We’ll change our <code>messagesTab</code> component to be called <code>messageList</code>, and create another component called <code>messagesTab</code></p>

<div class="file-name">
  <span class="file-name__folder">
    <i class="fa fa-folder-o"></i>
    tabs
  </span>
  <span class="file-name__file">
    <i class="fa fa-file-code-o"></i>
    Messages.js
  </span>
</div>
<div class="code-block">

<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><code class="language-js" data-lang="js"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43</code></pre></div></td><td class="code"><div class="highlight"><pre><span class="s1">&#39;use strict&#39;</span><span class="p">;</span>

<span class="kd">var</span> <span class="nx">React</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;react-native&#39;</span><span class="p">);</span>
<span class="kd">var</span> <span class="p">{</span>
  <span class="nx">StyleSheet</span><span class="p">,</span>
  <span class="nx">Text</span><span class="p">,</span>
  <span class="nx">View</span><span class="p">,</span>
  <span class="nx">Image</span><span class="p">,</span>
  <span class="nx">ListView</span><span class="p">,</span>
  <span class="nx">PixelRatio</span><span class="p">,</span>
  <span class="nx">NavigatorIOS</span>
  <span class="p">}</span> <span class="o">=</span> <span class="nx">React</span><span class="p">;</span>

<span class="c1">// omitted code</span>

<span class="kd">var</span> <span class="nx">messageList</span> <span class="o">=</span> <span class="nx">React</span><span class="p">.</span><span class="nx">createClass</span><span class="p">({</span>
  <span class="p">...,</span>
  <span class="nx">render</span><span class="o">:</span> <span class="kd">function</span><span class="p">(){</span>
    <span class="k">return</span> <span class="p">(</span>
      <span class="o">&lt;</span><span class="nx">View</span> <span class="nx">style</span><span class="o">=</span><span class="p">{</span> <span class="o">&gt;</span>
        <span class="o">&lt;</span><span class="nx">ListView</span> <span class="nx">dataSource</span><span class="o">=</span><span class="p">{</span> <span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">dataSource</span> <span class="p">}</span> <span class="nx">renderRow</span><span class="o">=</span><span class="p">{</span> <span class="k">this</span><span class="p">.</span><span class="nx">renderRow</span> <span class="p">}</span> <span class="o">/&gt;</span>
      <span class="o">&lt;</span><span class="err">/View&gt;</span>
    <span class="p">);</span>
  <span class="p">}</span>
<span class="p">});</span>

<span class="kd">var</span> <span class="nx">messagesTab</span> <span class="o">=</span> <span class="nx">React</span><span class="p">.</span><span class="nx">createClass</span><span class="p">({</span>
  <span class="nx">render</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="p">(</span>
      <span class="o">&lt;</span><span class="nx">NavigatorIOS</span>
        <span class="nx">style</span><span class="o">=</span><span class="p">{</span> <span class="nx">styles</span><span class="p">.</span><span class="nx">container</span> <span class="p">}</span>
        <span class="nx">initialRoute</span><span class="o">=</span><span class="p">{</span>
          <span class="p">{</span>
            <span class="nx">title</span><span class="o">:</span> <span class="s1">&#39;Messages&#39;</span><span class="p">,</span>
            <span class="nx">component</span><span class="o">:</span> <span class="nx">messageList</span>
          <span class="p">}</span>
        <span class="p">}</span>
        <span class="o">/&gt;</span>
    <span class="p">);</span>
  <span class="p">}</span>
<span class="p">});</span>

<span class="c1">// omitted code</span>
</pre></div>
</td></tr></table>

</div>

<div style="text-align: center">
    <a href="/img/going-native-with-react/messages-navigator.png" target="_blank"><img src="/img/going-native-with-react/messages-navigator.png" /></a>
</div>

<p>Looking much more professional already. Like we did in the facemash tab, we can now add <code>TouchableHighlight</code> to our rows.</p>

<div class="file-name">
  <span class="file-name__folder">
    <i class="fa fa-folder-o"></i>
    tabs
  </span>
  <span class="file-name__file">
    <i class="fa fa-file-code-o"></i>
    Messages.js
  </span>
</div>
<div class="code-block">

<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><code class="language-js" data-lang="js"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71</code></pre></div></td><td class="code"><div class="highlight"><pre><span class="s1">&#39;use strict&#39;</span><span class="p">;</span>

<span class="kd">var</span> <span class="nx">React</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;react-native&#39;</span><span class="p">);</span>
<span class="kd">var</span> <span class="p">{</span>
  <span class="nx">StyleSheet</span><span class="p">,</span>
  <span class="nx">Text</span><span class="p">,</span>
  <span class="nx">View</span><span class="p">,</span>
  <span class="nx">Image</span><span class="p">,</span>
  <span class="nx">ListView</span><span class="p">,</span>
  <span class="nx">PixelRatio</span><span class="p">,</span>
  <span class="nx">NavigatorIOS</span><span class="p">,</span>
  <span class="nx">TouchableHighlight</span>
  <span class="p">}</span> <span class="o">=</span> <span class="nx">React</span><span class="p">;</span>

<span class="c1">// omitted code</span>

<span class="kd">var</span> <span class="nx">messageList</span> <span class="o">=</span> <span class="nx">React</span><span class="p">.</span><span class="nx">createClass</span><span class="p">({</span>
  <span class="nx">componentWillMount</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">fetch</span><span class="p">(</span><span class="s1">&#39;http://localhost:8882/rest/messages&#39;</span><span class="p">)</span>
      <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="nx">res</span> <span class="o">=&gt;</span> <span class="nx">res</span><span class="p">.</span><span class="nx">json</span><span class="p">())</span>
      <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="nx">res</span> <span class="o">=&gt;</span> <span class="k">this</span><span class="p">.</span><span class="nx">updateDataSource</span><span class="p">(</span><span class="nx">res</span><span class="p">));</span>
  <span class="p">},</span>
  <span class="nx">getInitialState</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="p">{</span>
      <span class="nx">dataSource</span><span class="o">:</span> <span class="k">new</span> <span class="nx">ListView</span><span class="p">.</span><span class="nx">DataSource</span><span class="p">({</span>
        <span class="nx">rowHasChanged</span><span class="o">:</span> <span class="p">(</span><span class="nx">r1</span><span class="p">,</span> <span class="nx">r2</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">r1</span> <span class="o">!==</span> <span class="nx">r2</span>
      <span class="p">})</span>
    <span class="p">};</span>
  <span class="p">},</span>
  <span class="nx">updateDataSource</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">data</span><span class="p">){</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">setState</span><span class="p">({</span>
      <span class="nx">dataSource</span><span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">dataSource</span><span class="p">.</span><span class="nx">cloneWithRows</span><span class="p">(</span><span class="nx">data</span><span class="p">)</span>
    <span class="p">})</span>
  <span class="p">},</span>
  <span class="nx">renderRow</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">person</span><span class="p">){</span>
    <span class="kd">var</span> <span class="nx">time</span> <span class="o">=</span> <span class="nx">prettyTime</span><span class="p">(</span><span class="nx">person</span><span class="p">.</span><span class="nx">lastMessage</span><span class="p">.</span><span class="nx">timestamp</span><span class="p">);</span>
    <span class="k">return</span> <span class="p">(</span>
      <span class="o">&lt;</span><span class="nx">View</span><span class="o">&gt;</span>
        <span class="o">&lt;</span><span class="nx">TouchableHighlight</span><span class="o">&gt;</span>
          <span class="o">&lt;</span><span class="nx">View</span> <span class="nx">style</span><span class="o">=</span><span class="p">{</span> <span class="nx">styles</span><span class="p">.</span><span class="nx">row</span> <span class="p">}</span><span class="o">&gt;</span>
            <span class="o">&lt;</span><span class="nx">Image</span>
              <span class="nx">source</span><span class="o">=</span><span class="p">{</span> <span class="p">{</span> <span class="nx">uri</span><span class="o">:</span> <span class="nx">person</span><span class="p">.</span><span class="nx">user</span><span class="p">.</span><span class="nx">picture</span> <span class="p">}</span> <span class="p">}</span>
              <span class="nx">style</span><span class="o">=</span><span class="p">{</span> <span class="nx">styles</span><span class="p">.</span><span class="nx">cellImage</span> <span class="p">}</span>
              <span class="o">/&gt;</span>
            <span class="o">&lt;</span><span class="nx">View</span> <span class="nx">style</span><span class="o">=</span><span class="p">{</span> <span class="nx">styles</span><span class="p">.</span><span class="nx">textContainer</span> <span class="p">}</span><span class="o">&gt;</span>
              <span class="o">&lt;</span><span class="nx">Text</span> <span class="nx">style</span><span class="o">=</span><span class="p">{</span> <span class="nx">styles</span><span class="p">.</span><span class="nx">name</span> <span class="p">}</span> <span class="nx">numberOfLines</span><span class="o">=</span><span class="p">{</span> <span class="mi">1</span> <span class="p">}</span><span class="o">&gt;</span>
                <span class="p">{</span> <span class="nx">person</span><span class="p">.</span><span class="nx">user</span><span class="p">.</span><span class="nx">firstName</span> <span class="p">}</span> <span class="p">{</span> <span class="nx">person</span><span class="p">.</span><span class="nx">user</span><span class="p">.</span><span class="nx">lastName</span> <span class="p">}</span>
              <span class="o">&lt;</span><span class="err">/Text&gt;</span>
              <span class="o">&lt;</span><span class="nx">Text</span> <span class="nx">style</span><span class="o">=</span><span class="p">{</span> <span class="nx">styles</span><span class="p">.</span><span class="nx">time</span> <span class="p">}</span> <span class="nx">numberOfLines</span><span class="o">=</span><span class="p">{</span> <span class="mi">1</span> <span class="p">}</span><span class="o">&gt;</span>
                <span class="p">{</span> <span class="nx">time</span> <span class="p">}</span>
              <span class="o">&lt;</span><span class="err">/Text&gt;</span>
              <span class="o">&lt;</span><span class="nx">Text</span> <span class="nx">style</span><span class="o">=</span><span class="p">{</span> <span class="nx">styles</span><span class="p">.</span><span class="nx">lastMessage</span> <span class="p">}</span> <span class="nx">numberOfLines</span><span class="o">=</span><span class="p">{</span> <span class="mi">1</span> <span class="p">}</span><span class="o">&gt;</span>
                <span class="p">{</span> <span class="nx">person</span><span class="p">.</span><span class="nx">lastMessage</span><span class="p">.</span><span class="nx">contents</span> <span class="p">}</span>
              <span class="o">&lt;</span><span class="err">/Text&gt;</span>
            <span class="o">&lt;</span><span class="err">/View&gt;</span>
          <span class="o">&lt;</span><span class="err">/View&gt;</span>
          <span class="o">&lt;</span><span class="nx">View</span> <span class="nx">style</span><span class="o">=</span><span class="p">{</span> <span class="nx">styles</span><span class="p">.</span><span class="nx">cellBorder</span> <span class="p">}</span> <span class="o">/&gt;</span>
        <span class="o">&lt;</span><span class="err">/TouchableHighlight&gt;</span>
      <span class="o">&lt;</span><span class="err">/View&gt;</span>
    <span class="p">);</span>
  <span class="p">},</span>
  <span class="nx">render</span><span class="o">:</span> <span class="kd">function</span><span class="p">(){</span>
    <span class="k">return</span> <span class="p">(</span>
      <span class="o">&lt;</span><span class="nx">View</span> <span class="nx">style</span><span class="o">=</span><span class="p">{</span> <span class="nx">styles</span><span class="p">.</span><span class="nx">container</span> <span class="p">}</span><span class="o">&gt;</span>
        <span class="o">&lt;</span><span class="nx">ListView</span> <span class="nx">dataSource</span><span class="o">=</span><span class="p">{</span> <span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">dataSource</span> <span class="p">}</span> <span class="nx">renderRow</span><span class="o">=</span><span class="p">{</span> <span class="k">this</span><span class="p">.</span><span class="nx">renderRow</span> <span class="p">}</span> <span class="o">/&gt;</span>
      <span class="o">&lt;</span><span class="err">/View&gt;</span>
    <span class="p">);</span>
  <span class="p">}</span>
<span class="p">});</span>

<span class="c1">// omitted code</span>
</pre></div>
</td></tr></table>

</div>

<p>Reload the changes and.. you’ll get an error. This is because we are passing two child components through to <code>TouchableHighlight</code>, and it only plays nicely with one. Not to worry, we can just wrap the two components in another <code>View</code> component.</p>

<div class="file-name">
  <span class="file-name__folder">
    <i class="fa fa-folder-o"></i>
    tabs
  </span>
  <span class="file-name__file">
    <i class="fa fa-file-code-o"></i>
    Messages.js
  </span>
</div>
<div class="code-block">

<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><code class="language-js" data-lang="js"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37</code></pre></div></td><td class="code"><div class="highlight"><pre><span class="c1">// omitted code</span>

<span class="kd">var</span> <span class="nx">messageList</span> <span class="o">=</span> <span class="nx">React</span><span class="p">.</span><span class="nx">createClass</span><span class="p">({</span>
  <span class="p">...,</span>
  <span class="nx">renderRow</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">person</span><span class="p">){</span>
    <span class="kd">var</span> <span class="nx">time</span> <span class="o">=</span> <span class="nx">prettyTime</span><span class="p">(</span><span class="nx">person</span><span class="p">.</span><span class="nx">lastMessage</span><span class="p">.</span><span class="nx">timestamp</span><span class="p">);</span>
    <span class="k">return</span> <span class="p">(</span>
      <span class="o">&lt;</span><span class="nx">View</span><span class="o">&gt;</span>
        <span class="o">&lt;</span><span class="nx">TouchableHighlight</span><span class="o">&gt;</span>
          <span class="o">&lt;</span><span class="nx">View</span><span class="o">&gt;</span>
            <span class="o">&lt;</span><span class="nx">View</span> <span class="nx">style</span><span class="o">=</span><span class="p">{</span> <span class="nx">styles</span><span class="p">.</span><span class="nx">row</span> <span class="p">}</span><span class="o">&gt;</span>
              <span class="o">&lt;</span><span class="nx">Image</span>
                <span class="nx">source</span><span class="o">=</span><span class="p">{</span> <span class="p">{</span> <span class="nx">uri</span><span class="o">:</span> <span class="nx">person</span><span class="p">.</span><span class="nx">user</span><span class="p">.</span><span class="nx">picture</span> <span class="p">}</span> <span class="p">}</span>
                <span class="nx">style</span><span class="o">=</span><span class="p">{</span> <span class="nx">styles</span><span class="p">.</span><span class="nx">cellImage</span> <span class="p">}</span>
                <span class="o">/&gt;</span>
              <span class="o">&lt;</span><span class="nx">View</span> <span class="nx">style</span><span class="o">=</span><span class="p">{</span> <span class="nx">styles</span><span class="p">.</span><span class="nx">textContainer</span> <span class="p">}</span><span class="o">&gt;</span>
                <span class="o">&lt;</span><span class="nx">Text</span> <span class="nx">style</span><span class="o">=</span><span class="p">{</span> <span class="nx">styles</span><span class="p">.</span><span class="nx">name</span> <span class="p">}</span> <span class="nx">numberOfLines</span><span class="o">=</span><span class="p">{</span> <span class="mi">1</span> <span class="p">}</span><span class="o">&gt;</span>
                  <span class="p">{</span> <span class="nx">person</span><span class="p">.</span><span class="nx">user</span><span class="p">.</span><span class="nx">firstName</span> <span class="p">}</span> <span class="p">{</span> <span class="nx">person</span><span class="p">.</span><span class="nx">user</span><span class="p">.</span><span class="nx">lastName</span> <span class="p">}</span>
                <span class="o">&lt;</span><span class="err">/Text&gt;</span>
                <span class="o">&lt;</span><span class="nx">Text</span> <span class="nx">style</span><span class="o">=</span><span class="p">{</span> <span class="nx">styles</span><span class="p">.</span><span class="nx">time</span> <span class="p">}</span> <span class="nx">numberOfLines</span><span class="o">=</span><span class="p">{</span> <span class="mi">1</span> <span class="p">}</span><span class="o">&gt;</span>
                  <span class="p">{</span> <span class="nx">time</span> <span class="p">}</span>
                <span class="o">&lt;</span><span class="err">/Text&gt;</span>
                <span class="o">&lt;</span><span class="nx">Text</span> <span class="nx">style</span><span class="o">=</span><span class="p">{</span> <span class="nx">styles</span><span class="p">.</span><span class="nx">lastMessage</span> <span class="p">}</span> <span class="nx">numberOfLines</span><span class="o">=</span><span class="p">{</span> <span class="mi">1</span> <span class="p">}</span><span class="o">&gt;</span>
                  <span class="p">{</span> <span class="nx">person</span><span class="p">.</span><span class="nx">lastMessage</span><span class="p">.</span><span class="nx">contents</span> <span class="p">}</span>
                <span class="o">&lt;</span><span class="err">/Text&gt;</span>
              <span class="o">&lt;</span><span class="err">/View&gt;</span>
            <span class="o">&lt;</span><span class="err">/View&gt;</span>
            <span class="o">&lt;</span><span class="nx">View</span> <span class="nx">style</span><span class="o">=</span><span class="p">{</span> <span class="nx">styles</span><span class="p">.</span><span class="nx">cellBorder</span> <span class="p">}</span> <span class="o">/&gt;</span>
          <span class="o">&lt;</span><span class="err">/View&gt;</span>
        <span class="o">&lt;</span><span class="err">/TouchableHighlight&gt;</span>
      <span class="o">&lt;</span><span class="err">/View&gt;</span>
    <span class="p">);</span>
  <span class="p">},</span>
  <span class="p">...</span>
<span class="p">});</span>

<span class="c1">// omitted code</span>
</pre></div>
</td></tr></table>

</div>

<p>Now, when we tap on the row, we get the expected behaviour. Wait a minute - our bottom border is now looking a bit weird! This is because we’re using an <code>rgba</code> value. The background of the whole view is being changed, which means our border is then changed to be darker. Not to worry, we can give it a hex code instead.</p>

<div class="file-name">
  <span class="file-name__folder">
    <i class="fa fa-folder-o"></i>
    tabs
  </span>
  <span class="file-name__file">
    <i class="fa fa-file-code-o"></i>
    Messages.js
  </span>
</div>
<div class="code-block">

<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><code class="language-js" data-lang="js">1
2
3
4
5
6
7
8</code></pre></div></td><td class="code"><div class="highlight"><pre><span class="kd">var</span> <span class="nx">styles</span> <span class="o">=</span> <span class="nx">StyleSheet</span><span class="p">.</span><span class="nx">create</span><span class="p">({</span>
  <span class="p">...,</span>
  <span class="nx">cellBorder</span><span class="o">:</span> <span class="p">{</span>
    <span class="nx">backgroundColor</span><span class="o">:</span> <span class="s1">&#39;#F2F2F2&#39;</span><span class="p">,</span>
    <span class="nx">height</span><span class="o">:</span> <span class="mi">1</span> <span class="o">/</span> <span class="nx">PixelRatio</span><span class="p">.</span><span class="nx">get</span><span class="p">(),</span>
    <span class="nx">marginLeft</span><span class="o">:</span> <span class="mi">4</span>
  <span class="p">}</span>
<span class="p">});</span>
</pre></div>
</td></tr></table>

</div>

<p>You can see all the code up to this point on the <code>step-four</code> branch.</p>

<h2 id="pushing-and-popping">Pushing and popping</h2>

<p>Now we’ve got our main list styled, we can now handle the navigation change when the user is tapped.</p>

<p><code>NavigatorIOS</code> allows us to “push” components into it when we want to change the current route. To do this, we need some way to access the <code>NavigatorIOS</code> instance in our child component, <code>messageList</code>. Luckily for us, this gets passed down as a prop named <code>navigator</code>.</p>

<p>Let’s add an <code>onPress</code> event to our <code>TouchableHighlight</code> component.</p>

<div class="file-name">
  <span class="file-name__folder">
    <i class="fa fa-folder-o"></i>
    tabs
  </span>
  <span class="file-name__file">
    <i class="fa fa-file-code-o"></i>
    Messages.js
  </span>
</div>
<div class="code-block">

<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><code class="language-js" data-lang="js"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21</code></pre></div></td><td class="code"><div class="highlight"><pre><span class="c1">// omitted code</span>

<span class="kd">var</span> <span class="nx">messageList</span> <span class="o">=</span> <span class="nx">React</span><span class="p">.</span><span class="nx">createClass</span><span class="p">({</span>
  <span class="p">...,</span>
  <span class="nx">openChat</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">user</span><span class="p">){</span>

  <span class="p">},</span>
  <span class="nx">renderRow</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">person</span><span class="p">){</span>
    <span class="kd">var</span> <span class="nx">time</span> <span class="o">=</span> <span class="nx">prettyTime</span><span class="p">(</span><span class="nx">person</span><span class="p">.</span><span class="nx">lastMessage</span><span class="p">.</span><span class="nx">timestamp</span><span class="p">);</span>
    <span class="k">return</span> <span class="p">(</span>
      <span class="o">&lt;</span><span class="nx">View</span><span class="o">&gt;</span>
        <span class="o">&lt;</span><span class="nx">TouchableHighlight</span> <span class="nx">onPress</span><span class="o">=</span><span class="p">{</span> <span class="k">this</span><span class="p">.</span><span class="nx">openChat</span><span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">person</span><span class="p">.</span><span class="nx">user</span><span class="p">)</span> <span class="p">}</span><span class="o">&gt;</span>
          <span class="p">...</span>
        <span class="o">&lt;</span><span class="err">/TouchableHighlight&gt;</span>
      <span class="o">&lt;</span><span class="err">/View&gt;</span>
    <span class="p">);</span>
  <span class="p">},</span>
  <span class="p">...</span>
<span class="p">});</span>

<span class="c1">// omitted code</span>
</pre></div>
</td></tr></table>

</div>

<p>We now need a React component to pass through to our navigator. Create a new file called <code>MessageView.js</code> in our <code>tabs/</code> folder.</p>

<div class="file-name">
  <span class="file-name__folder">
    <i class="fa fa-folder-o"></i>
    tabs
  </span>
  <span class="file-name__file">
    <i class="fa fa-file-code-o"></i>
    MessageView.js
  </span>
</div>
<div class="code-block">

<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><code class="language-js" data-lang="js"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27</code></pre></div></td><td class="code"><div class="highlight"><pre><span class="s1">&#39;use strict&#39;</span><span class="p">;</span>

<span class="kd">var</span> <span class="nx">React</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;react-native&#39;</span><span class="p">);</span>
<span class="kd">var</span> <span class="p">{</span>
  <span class="nx">StyleSheet</span><span class="p">,</span>
  <span class="nx">Text</span><span class="p">,</span>
  <span class="nx">View</span>
  <span class="p">}</span> <span class="o">=</span> <span class="nx">React</span><span class="p">;</span>

<span class="kd">var</span> <span class="nx">messageView</span> <span class="o">=</span> <span class="nx">React</span><span class="p">.</span><span class="nx">createClass</span><span class="p">({</span>
  <span class="nx">render</span><span class="o">:</span> <span class="kd">function</span><span class="p">(){</span>
    <span class="k">return</span> <span class="p">(</span>
      <span class="o">&lt;</span><span class="nx">View</span> <span class="nx">style</span><span class="o">=</span><span class="p">{</span> <span class="nx">styles</span><span class="p">.</span><span class="nx">container</span> <span class="p">}</span><span class="o">&gt;</span>
        <span class="o">&lt;</span><span class="nx">Text</span><span class="o">&gt;</span><span class="nx">Message</span> <span class="nx">view</span><span class="o">!&lt;</span><span class="err">/Text&gt;</span>
      <span class="o">&lt;</span><span class="err">/View&gt;</span>
    <span class="p">);</span>
  <span class="p">}</span>
<span class="p">});</span>

<span class="kd">var</span> <span class="nx">styles</span> <span class="o">=</span> <span class="nx">StyleSheet</span><span class="p">.</span><span class="nx">create</span><span class="p">({</span>
  <span class="nx">container</span><span class="o">:</span> <span class="p">{</span>
    <span class="nx">flex</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="nx">backgroundColor</span><span class="o">:</span> <span class="s1">&#39;#fff&#39;</span>
  <span class="p">},</span>
<span class="p">});</span>

<span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="nx">messageView</span><span class="p">;</span>
</pre></div>
</td></tr></table>

</div>

<p>We can then include this in our <code>Messages.js</code> file, and push it through to the navigator.</p>

<div class="file-name">
  <span class="file-name__folder">
    <i class="fa fa-folder-o"></i>
    tabs
  </span>
  <span class="file-name__file">
    <i class="fa fa-file-code-o"></i>
    Messages.js
  </span>
</div>
<div class="code-block">

<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><code class="language-js" data-lang="js"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44</code></pre></div></td><td class="code"><div class="highlight"><pre><span class="c1">// omitted code</span>

<span class="kd">var</span> <span class="nx">messageList</span> <span class="o">=</span> <span class="nx">React</span><span class="p">.</span><span class="nx">createClass</span><span class="p">({</span>
  <span class="p">...,</span>
  <span class="nx">openChat</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">user</span><span class="p">){</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">navigator</span><span class="p">.</span><span class="nx">push</span><span class="p">({</span>
      <span class="nx">title</span><span class="o">:</span> <span class="err">`</span><span class="nx">$</span><span class="p">{</span><span class="nx">user</span><span class="p">.</span><span class="nx">firstName</span><span class="p">}</span> <span class="nx">$</span><span class="p">{</span><span class="nx">user</span><span class="p">.</span><span class="nx">lastName</span><span class="p">}</span><span class="err">`</span><span class="p">,</span>
      <span class="nx">component</span><span class="o">:</span> <span class="nx">MessageView</span><span class="p">,</span>
      <span class="nx">passProps</span><span class="o">:</span> <span class="p">{</span> <span class="nx">user</span> <span class="p">}</span>
    <span class="p">});</span>
  <span class="p">},</span>
  <span class="nx">renderRow</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">person</span><span class="p">){</span>
    <span class="kd">var</span> <span class="nx">time</span> <span class="o">=</span> <span class="nx">prettyTime</span><span class="p">(</span><span class="nx">person</span><span class="p">.</span><span class="nx">lastMessage</span><span class="p">.</span><span class="nx">timestamp</span><span class="p">);</span>
    <span class="k">return</span> <span class="p">(</span>
      <span class="o">&lt;</span><span class="nx">View</span><span class="o">&gt;</span>
        <span class="o">&lt;</span><span class="nx">TouchableHighlight</span> <span class="nx">onPress</span><span class="o">=</span><span class="p">{</span> <span class="k">this</span><span class="p">.</span><span class="nx">openChat</span><span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">person</span><span class="p">.</span><span class="nx">user</span><span class="p">)</span> <span class="p">}</span><span class="o">&gt;</span>
          <span class="o">&lt;</span><span class="nx">View</span><span class="o">&gt;</span>
            <span class="o">&lt;</span><span class="nx">View</span> <span class="nx">style</span><span class="o">=</span><span class="p">{</span> <span class="nx">styles</span><span class="p">.</span><span class="nx">row</span> <span class="p">}</span><span class="o">&gt;</span>
              <span class="o">&lt;</span><span class="nx">Image</span>
                <span class="nx">source</span><span class="o">=</span><span class="p">{</span> <span class="p">{</span> <span class="nx">uri</span><span class="o">:</span> <span class="nx">person</span><span class="p">.</span><span class="nx">user</span><span class="p">.</span><span class="nx">picture</span> <span class="p">}</span> <span class="p">}</span>
                <span class="nx">style</span><span class="o">=</span><span class="p">{</span> <span class="nx">styles</span><span class="p">.</span><span class="nx">cellImage</span> <span class="p">}</span>
                <span class="o">/&gt;</span>
              <span class="o">&lt;</span><span class="nx">View</span> <span class="nx">style</span><span class="o">=</span><span class="p">{</span> <span class="nx">styles</span><span class="p">.</span><span class="nx">textContainer</span> <span class="p">}</span><span class="o">&gt;</span>
                <span class="o">&lt;</span><span class="nx">Text</span> <span class="nx">style</span><span class="o">=</span><span class="p">{</span> <span class="nx">styles</span><span class="p">.</span><span class="nx">name</span> <span class="p">}</span> <span class="nx">numberOfLines</span><span class="o">=</span><span class="p">{</span> <span class="mi">1</span> <span class="p">}</span><span class="o">&gt;</span>
                  <span class="p">{</span> <span class="nx">person</span><span class="p">.</span><span class="nx">user</span><span class="p">.</span><span class="nx">firstName</span> <span class="p">}</span> <span class="p">{</span> <span class="nx">person</span><span class="p">.</span><span class="nx">user</span><span class="p">.</span><span class="nx">lastName</span> <span class="p">}</span>
                <span class="o">&lt;</span><span class="err">/Text&gt;</span>
                <span class="o">&lt;</span><span class="nx">Text</span> <span class="nx">style</span><span class="o">=</span><span class="p">{</span> <span class="nx">styles</span><span class="p">.</span><span class="nx">time</span> <span class="p">}</span> <span class="nx">numberOfLines</span><span class="o">=</span><span class="p">{</span> <span class="mi">1</span> <span class="p">}</span><span class="o">&gt;</span>
                  <span class="p">{</span> <span class="nx">time</span> <span class="p">}</span>
                <span class="o">&lt;</span><span class="err">/Text&gt;</span>
                <span class="o">&lt;</span><span class="nx">Text</span> <span class="nx">style</span><span class="o">=</span><span class="p">{</span> <span class="nx">styles</span><span class="p">.</span><span class="nx">lastMessage</span> <span class="p">}</span> <span class="nx">numberOfLines</span><span class="o">=</span><span class="p">{</span> <span class="mi">1</span> <span class="p">}</span><span class="o">&gt;</span>
                  <span class="p">{</span> <span class="nx">person</span><span class="p">.</span><span class="nx">lastMessage</span><span class="p">.</span><span class="nx">contents</span> <span class="p">}</span>
                <span class="o">&lt;</span><span class="err">/Text&gt;</span>
              <span class="o">&lt;</span><span class="err">/View&gt;</span>
            <span class="o">&lt;</span><span class="err">/View&gt;</span>
            <span class="o">&lt;</span><span class="nx">View</span> <span class="nx">style</span><span class="o">=</span><span class="p">{</span> <span class="nx">styles</span><span class="p">.</span><span class="nx">cellBorder</span> <span class="p">}</span> <span class="o">/&gt;</span>
          <span class="o">&lt;</span><span class="err">/View&gt;</span>
        <span class="o">&lt;</span><span class="err">/TouchableHighlight&gt;</span>
      <span class="o">&lt;</span><span class="err">/View&gt;</span>
    <span class="p">);</span>
  <span class="p">},</span>
  <span class="p">...</span>
<span class="p">});</span>

<span class="c1">// omitted code</span>
</pre></div>
</td></tr></table>

</div>

<p>You can see here we’re pushing the next route into our navigator. From here we can set the next route’s title (the user’s first and last name), what component to render (our newly created MessageView) and what properties to pass through. This allows us to access anything we need in the <code>MessageView</code> component (we’re going to pass through the user object).</p>

<div style="text-align: center">
    <a href="/img/going-native-with-react/messages-user-laurie.png" target="_blank"><img src="/img/going-native-with-react/messages-user-laurie.png" /></a>
    <a href="/img/going-native-with-react/messages-user-candice.png" target="_blank"><img src="/img/going-native-with-react/messages-user-candice.png" /></a>
</div>

<p>This will work for everyone in our chat list, no matter how big or small.</p>

<p>However, the text is being cut off by our new title bar. To solve this, we can just put some padding on our first <code>View</code> component.</p>

<p>Now we’ve got a <code>user</code> property being passed through, we can also display that!</p>

<div class="file-name">
  <span class="file-name__folder">
    <i class="fa fa-folder-o"></i>
    tabs
  </span>
  <span class="file-name__file">
    <i class="fa fa-file-code-o"></i>
    MessageView.js
  </span>
</div>
<div class="code-block">

<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><code class="language-js" data-lang="js"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29</code></pre></div></td><td class="code"><div class="highlight"><pre><span class="s1">&#39;use strict&#39;</span><span class="p">;</span>

<span class="kd">var</span> <span class="nx">React</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;react-native&#39;</span><span class="p">);</span>
<span class="kd">var</span> <span class="p">{</span>
  <span class="nx">StyleSheet</span><span class="p">,</span>
  <span class="nx">Text</span><span class="p">,</span>
  <span class="nx">View</span>
  <span class="p">}</span> <span class="o">=</span> <span class="nx">React</span><span class="p">;</span>

<span class="kd">var</span> <span class="nx">messageView</span> <span class="o">=</span> <span class="nx">React</span><span class="p">.</span><span class="nx">createClass</span><span class="p">({</span>
  <span class="nx">render</span><span class="o">:</span> <span class="kd">function</span><span class="p">(){</span>
    <span class="kd">var</span> <span class="nx">user</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">user</span><span class="p">;</span>
    <span class="k">return</span> <span class="p">(</span>
      <span class="o">&lt;</span><span class="nx">View</span> <span class="nx">style</span><span class="o">=</span><span class="p">{</span> <span class="nx">styles</span><span class="p">.</span><span class="nx">container</span> <span class="p">}</span><span class="o">&gt;</span>
        <span class="o">&lt;</span><span class="nx">Text</span><span class="o">&gt;</span><span class="nx">Chat</span> <span class="kd">with</span> <span class="p">{</span> <span class="nx">user</span><span class="p">.</span><span class="nx">firstName</span> <span class="p">}</span> <span class="p">{</span> <span class="nx">user</span><span class="p">.</span><span class="nx">lastName</span> <span class="p">}</span><span class="o">&lt;</span><span class="err">/Text&gt;</span>
      <span class="o">&lt;</span><span class="err">/View&gt;</span>
    <span class="p">);</span>
  <span class="p">}</span>
<span class="p">});</span>

<span class="kd">var</span> <span class="nx">styles</span> <span class="o">=</span> <span class="nx">StyleSheet</span><span class="p">.</span><span class="nx">create</span><span class="p">({</span>
  <span class="nx">container</span><span class="o">:</span> <span class="p">{</span>
    <span class="nx">flex</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="nx">backgroundColor</span><span class="o">:</span> <span class="s1">&#39;#fff&#39;</span><span class="p">,</span>
    <span class="nx">paddingTop</span><span class="o">:</span> <span class="mi">64</span>
  <span class="p">},</span>
<span class="p">});</span>

<span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="nx">messageView</span><span class="p">;</span>
</pre></div>
</td></tr></table>

</div>

<div style="text-align: center">
    <a href="/img/going-native-with-react/messages-text.png" target="_blank"><img src="/img/going-native-with-react/messages-text.png" /></a>
</div>

<p>You can checkout the code up to here on the <code>step-five</code> branch.</p>

<p>If you wish to take this tab further, here are a few ideas</p>

<ul>
  <li>Get the chat information for that user when <code>MessageView</code> mounts</li>
  <li>Try and implement pull down to refresh - hint: use the <code>renderHeader</code> property on <code>ListView</code></li>
  <li>Add a “Settings” button to the right of the user’s first/last name</li>
</ul>

<h2 id="conclusion">Conclusion</h2>

<p>Feel free to try and add some functionality to the settings tab. Try and make use of other components, such as <code>DatePickerIOS</code> and <code>TextInput</code> for some common settings (DOB, name, etc).</p>

<p>Hopefully this has hit on quite a few different components that you will be commonly using in your React Native application. If you have any queries, feel free to contact me on twitter <a href="http://twitter.com/rynclark" target="_blank">@rynclark</a>.</p>

	</div>

  <span class="p">{</span>
  <span class="err">//</span>
  <span class="nt">&quot;flux&quot;</span>
  <span class="s2">&quot;2.0.1&quot;</span>
  <span class="nt">&quot;react&quot;</span>

	<div class="disqus">
		<div id="disqus_thread"></div>
	</div>
</article>

<script>
  var disqus_url = "http://ryanclark.me//going-native-with-react";
  var disqus_title = "Going native with React, an introduction";
  var disqus_shortname = 'rynclark';
  (function() {
    var dsq = document.createElement('script');
    dsq.async = dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    document.getElementsByTagName('head')[0].appendChild(dsq);
  })();
</script>

<script>
  var c = document.querySelector('canvas');
  var ctx = c.getContext("2d");

  // SVG is resolution independent. Canvas is not. We need to make our canvas
  // High Resolution.

  // lets get the resolution of our device.
  var pixelRatio = window.devicePixelRatio || 1;

  // lets scale the canvas and change its CSS width/height to make it high res.
  c.style.width = c.width +'px';
  c.style.height = c.height +'px';
  c.width *= pixelRatio;
  c.height *= pixelRatio;

  // Now that its high res we need to compensate so our images can be drawn as
  //normal, by scaling everything up by the pixelRatio.
  ctx.setTransform(pixelRatio,0,0,pixelRatio,0,0);
  ctx.translate(-4, 0);

  var cw = c.width;
  var ch = c.height;

  function createClip(ctx) {
    ctx.save();
    ctx.miterLimit=4;
    ctx.scale(1.0973936899862824,1.0973936899862824);
    ctx.translate(0.17219917012447183,0);
    ctx.scale(1.0926694329183957,1.0926694329183957);
    ctx.restore();

    ctx.save();
    ctx.beginPath();
    ctx.moveTo(33.2,31.5);
    ctx.bezierCurveTo(33.2,36.3,31.400000000000002,39.5,27.900000000000002,41);
    ctx.lineTo(32.900000000000006,59.9);
    ctx.bezierCurveTo(33.10000000000001,60.8,32.7,61.199999999999996,31.900000000000006,61.199999999999996);
    ctx.lineTo(24.400000000000006,61.199999999999996);
    ctx.bezierCurveTo(23.700000000000006,61.199999999999996,23.300000000000004,60.8,23.200000000000006,60.199999999999996);
    ctx.lineTo(18.400000000000006,41.89999999999999);
    ctx.lineTo(13.400000000000006,41.89999999999999);
    ctx.lineTo(13.400000000000006,60);
    ctx.bezierCurveTo(13.400000000000006,60.7,13.000000000000005,61.2,12.200000000000006,61.2);
    ctx.lineTo(4.8,61.2);
    ctx.bezierCurveTo(4.1,61.2,3.5999999999999996,60.800000000000004,3.5999999999999996,60);
    ctx.lineTo(3.5999999999999996,4.7);
    ctx.bezierCurveTo(3.6,4,4,3.6,4.8,3.6);
    ctx.lineTo(22.900000000000002,3.6);
    ctx.bezierCurveTo(29.700000000000003,3.6,33.300000000000004,7.2,33.300000000000004,14);
    ctx.lineTo(33.300000000000004,31.5);
    ctx.closePath();
    ctx.moveTo(20.5,32.4);
    ctx.bezierCurveTo(22.4,32.4,23.4,31.4,23.4,29.5);
    ctx.lineTo(23.4,16);
    ctx.bezierCurveTo(23.4,14.1,22.4,13.1,20.5,13.1);
    ctx.lineTo(13.4,13.1);
    ctx.lineTo(13.4,32.4);
    ctx.lineTo(20.5,32.4);
    ctx.moveTo(69.3,21.7);
    ctx.bezierCurveTo(69.3,22.4,68.89999999999999,22.9,68.1,22.9);
    ctx.lineTo(60.89999999999999,22.9);
    ctx.bezierCurveTo(60.099999999999994,22.9,59.69999999999999,22.5,59.69999999999999,21.7);
    ctx.lineTo(59.69999999999999,16);
    ctx.bezierCurveTo(59.69999999999999,14.1,58.69999999999999,13.1,56.79999999999999,13.1);
    ctx.lineTo(53.09999999999999,13.1);
    ctx.bezierCurveTo(51.19999999999999,13.1,50.19999999999999,14.1,50.19999999999999,16);
    ctx.lineTo(50.19999999999999,48.8);
    ctx.bezierCurveTo(50.19999999999999,50.699999999999996,51.19999999999999,51.699999999999996,53.09999999999999,51.699999999999996);
    ctx.lineTo(56.79999999999999,51.699999999999996);
    ctx.bezierCurveTo(58.69999999999999,51.699999999999996,59.69999999999999,50.8,59.69999999999999,48.8);
    ctx.lineTo(59.69999999999999,43);
    ctx.bezierCurveTo(59.69999999999999,42.3,60.09999999999999,41.8,60.89999999999999,41.8);
    ctx.lineTo(68.1,41.8);
    ctx.bezierCurveTo(68.8,41.8,69.3,42.199999999999996,69.3,43);
    ctx.lineTo(69.3,50.8);
    ctx.bezierCurveTo(69.3,57.599999999999994,65.6,61.199999999999996,58.9,61.199999999999996);
    ctx.lineTo(50.8,61.199999999999996);
    ctx.bezierCurveTo(44,61.199999999999996,40.4,57.599999999999994,40.4,50.8);
    ctx.lineTo(40.4,14);
    ctx.bezierCurveTo(40.4,7.2,44.1,3.5999999999999996,50.8,3.5999999999999996);
    ctx.lineTo(58.9,3.5999999999999996);
    ctx.bezierCurveTo(65.6,3.5999999999999996,69.3,7.199999999999999,69.3,14);
    ctx.lineTo(69.3,21.7);
    ctx.closePath();
    ctx.clip();
  }

  var points = [];
  var tick = 0;
  var opt = {
    count: 5,
    range: {
      x: 0,
      y: 7
    },
    duration: {
      min: 20,
      max: 100
    },
    thickness: 0,
    strokeColor: '#444',
    level: 1,
    curved: true
  };

  var post = document.querySelector('.contents');
  var bar = document.querySelector('.header__progress__bar');

  var documentSize = document.body.scrollHeight;
  var postHeight = post.getBoundingClientRect().top + post.getBoundingClientRect().height;

  var bodyRect = document.body.getBoundingClientRect(),
    elemRect = post.getBoundingClientRect(),
    offsets   = elemRect.top - bodyRect.top;

  var offset = c.height + 5;

  ctx.lineWidth = 0;
  var timeout;
  function changeWidth() {
    var scrollPercentage = 1 - ((window.scrollY) / (elemRect.height + offsets - window.innerHeight));
    offset = (72 * scrollPercentage) + 5;
    ctx.lineWidth = 16 * Math.max(0, (1 - scrollPercentage) - 0.3);

    opt.range.y = 10;
    clearTimeout(timeout);
    timeout = setTimeout(function () {
      opt.range.y = 2;
    }, 1000);
  }

  window.addEventListener('scroll', changeWidth);
  window.addEventListener('resize', changeWidth);

  function rand(min, max){
    return Math.floor( (Math.random() * (max - min + 1) ) + min);
  }

  function ease(t, b, c, d) {
    if ((t/=d/2) < 1) return c/2*t*t + b;
    return -c/2 * ((--t)*(t-2) - 1) + b;
  }

  ctx.lineJoin = 'round';

  var Point = function(config){
    this.anchorX = config.x;
    this.anchorY = config.y;
    this.x = config.x;
    this.y = config.y;
    this.setTarget();
  };

  Point.prototype.setTarget = function(){
    this.initialX = this.x;
    this.initialY = this.y;
    this.targetX = this.anchorX + rand(0, opt.range.x * 2) - opt.range.x;
    this.targetY = this.anchorY + rand(0, opt.range.y * 2) - opt.range.y;
    this.tick = 0;
    this.duration = rand(opt.duration.min, opt.duration.max);
  }

  Point.prototype.update = function(){
    var dx = this.targetX - this.x;
    var dy = this.targetY - this.y;
    var dist = Math.sqrt(dx * dx + dy * dy);

    if(Math.abs(dist) <= 0){
      this.setTarget();
    } else {
      var t = this.tick;
      var b = this.initialY;
      var c = this.targetY - this.initialY;
      var d = this.duration;
      this.y = ease(t, b, c, d);

      b = this.initialX;
      c = this.targetX - this.initialX;
      d = this.duration;
      this.x = ease(t, b, c, d);

      this.tick++;
    }
  };

  Point.prototype.render = function(){
    ctx.beginPath();
    ctx.arc(this.x, this.y, 3, 0, Math.PI * 2, false);
    ctx.fillStyle = '#000';
    ctx.fill();
  };

  var updatePoints = function(){
    var i = points.length;
    while(i--){
      points[i].update();
    }
  };

  var renderPoints = function(){
    var i = points.length;
    while(i--){
      points[i].render();
    }
  };

  var lotsOfPoints = [];

  function quadraticBezierCurvePoint(t, c) {
    // compute relative coordinates of a point on the curve using t and c
    // t is a number between 0 and 1
    // c is an array of 3 points:
    //     the initial point of the curve (always (0,0))
    //     the "handle" point of the curve
    //     the final point of the curve
    var t1, t1_2a, t1_2b, t1_2c;
    t1 = 1 - t;
    t1_2a = t1 * t1;
    t1_2b = (2 * t) * t1;
    t1_2c = t * t;
    return {
      x: (c[0].x * t1_2a) + (t1_2b * c[1].x) + (t1_2c * c[2].x),
      y: (c[0].y * t1_2a) + (t1_2b * c[1].y) + (t1_2c * c[2].y)
    };
  }
  function b2p0(t, p) {
    var k = 1 - t;
    return k * k * p;
  }

  function b2p1(t, p) {
    return 2 * (1 - t) * t * p;
  }

  function b2p2(t, p) {
    return t * t * p;
  }

  function b2(t, p0, p1, p2) {
    return b2p0( t, p0 ) + b2p1( t, p1 ) + b2p2( t, p2 );
  }

  function tangentQuadraticBezier(p0, p1, p2, t) {
    return 2 * ( 1 - t ) * ( p1 - p0 ) + 2 * t * ( p2 - p1 );
  }
var log = false;
  var renderShape = function(){
    lotsOfPoints = [];
    ctx.beginPath();
    var pointCount = points.length;
    ctx.moveTo(points[0].x, points[0].y + offset);
    var i;
    for (i = 0; i < pointCount - 1; i++) {
      var c = (points[i].x + points[i + 1].x) / 2;
      var d = (points[i].y + points[i + 1].y) / 2;
      ctx.quadraticCurveTo(points[i].x, points[i].y + offset, c, d + offset);
    }
    ctx.lineTo(-opt.range.x - opt.thickness, ch + opt.thickness + offset);
    ctx.lineTo(cw + opt.range.x + opt.thickness, ch + opt.thickness + offset);
    ctx.closePath();
    ctx.fillStyle = pattern2;
    ctx.fill();
    ctx.strokeStyle = pattern;
    ctx.stroke();

    ctx.save();

    for (var i = 0; i < bubbles.length; i++) {
      bubbles[i].ycoord -= bubbles[i].move;
      if (bubbles[i].ycoord < (offset + 16)) {
        bubbles[i].xcoord = getRandomNum(0, cw);
        bubbles[i].ycoord = ch + maxRadius;
        bubbles[i].radius = getRandomNum(minRadius, maxRadius);
        bubbles[i].move = getRandomNum(minMove, maxMove);
      }

      ctx.beginPath();
      ctx.arc(bubbles[i].xcoord, bubbles[i].ycoord, bubbles[i].radius, 0, Math.PI*2, false);
      ctx.fillStyle = "rgba(0, 0, 0, 0.1)";
      ctx.fill();
      ctx.closePath();
    }
  };


  /**
   *  Get Random Integer
   */
  function getRandomInt (min, max) {
    return Math.floor(Math.random() * (max - min + 1)) + min;
  }

  /**
   *  Get Random Number
   */
  function getRandomNum(min, max) {
    return (Math.random() * (max - min + 1)) + min;
  }

  var bubbles = new Array();
  var bubblesNum = 75;

  var minRadius = 1;
  var maxRadius = 3;
  var minMove = 0.1;
  var maxMove = 0.2;

  for (var i = 0; i < bubblesNum; i++) {
    bubbles[i] = {
      xcoord: getRandomNum(0, cw),
      ycoord: getRandomNum(0, ch),
      radius: getRandomNum(minRadius, maxRadius),
      move: getRandomNum(minMove, maxMove)
    }
  }

  var clear = function(){
    ctx.clearRect(0, 0, cw, ch);
  };

  var i = opt.count + 2;
  var spacing = (cw + (opt.range.x * 2)) / (opt.count-1);
  while(i--){
    points.push(new Point({
      x: (spacing * (i - 1)) - opt.range.x,
      y: ch - (ch * opt.level)
    }));
  }


  window.requestAnimFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(a){window.setTimeout(a,1E3/60)}}();

  var loop = function(){
    window.requestAnimFrame(loop, c);
    tick++;
    clear();
    createClip(ctx);
    ctx.fillStyle = "#262626";
    ctx.fillRect(0, 0, cw, ch);

    updatePoints();
    renderShape();
  };
  var tempCanvas = document.createElement("canvas"),
    tCtx = tempCanvas.getContext("2d");

  var tempCanvas2 = document.createElement("canvas"),
    tCtx2 = tempCanvas2.getContext("2d");

  var pattern, pattern2;

  var img1 = new Image();
  //drawing of the test image - img1
  img1.onload = function () {
    tempCanvas.width = cw;
    tempCanvas.height = 16;
    tCtx.drawImage(img1, 0, 0, cw, 16, 0, 0, cw, 16);
    pattern = ctx.createPattern(tempCanvas, 'repeat');

    tempCanvas2.width = cw;
    tempCanvas2.height = ch;
    tCtx2.drawImage(img1, 0, 0, img1.width, img1.height, 0, -100, cw, ch + 100);
    pattern2 = ctx.createPattern(tempCanvas2, 'repeat');
    loop();
  };

  img1.src = 'http://static6.bigstockphoto.com/thumbs/1/5/9/small2/95113916.jpg';
</script>


    <div class="main-background">
      <div class="main-background__left">
        <div class="main-background__overlay"></div>
      </div>
      <div class="main-background__right">
        <div class="main-background__overlay"></div>
      </div>
    </div>
  </div>
</section>


<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-49723822-1', 'auto');
  ga('send', 'pageview');
</script>

<script type="text/javascript" src="/js/main.335918d038e996e66abe.js"></script></body>
</html>
